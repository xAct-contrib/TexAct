(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    549610,      14486]
NotebookOptionsPosition[    494913,      13563]
NotebookOutlinePosition[    495782,      13591]
CellTagsIndexPosition[    495644,      13585]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["TexAct", "Title",
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"e0881279-da07-4a4a-91d8-4d2999f73966"],

Cell[TextData[{
 "Tex code to format ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 " expressions"
}], "Subtitle",
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"0b8d0559-8138-4d1b-8b4c-9cdfdda986b9"],

Cell[TextData[{
 StyleBox["Thomas B\[ADoubleDot]ckdahl, Jos\[EAcute] M. Mart\[IAcute]n-Garc\
\[IAcute]a and Barry Wardell\n",
  FontSize->18],
 "(c) 2008-2018, under GPL\n\nthomas.backdahl@gmail.com, jose@xact.es, \
barry.wardell@gmail.com\nhttp://www.xact.es/\n\
http://groups.google.com/group/xact"
}], "Subsubtitle",
 CellChangeTimes->{{3.588319343807869*^9, 3.58831935009468*^9}, {
   3.646381931871279*^9, 3.6463819319412794`*^9}, {3.6472565506564846`*^9, 
   3.6472565567488327`*^9}, 3.679983896654022*^9, 3.697733188495449*^9, 
   3.727336133246937*^9},
 ExpressionUUID -> "46f9f6ce-e596-4c28-8549-1d90f80a366a"],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " has a function TeXForm but does not behave well with the indexed \
expressions of ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 ". We construct our own Tex function, which starts from the internal form, \
and not the box-form of the expression. The objective is building a ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"T", 
    AdjustmentBox["E",
     BoxBaselineShift->0.5,
     BoxMargins->{{-0.075, -0.085}, {0, 0}}], "X"}]]],ExpressionUUID->
  "9371fc27-9f0d-491b-95ce-82f8773f66a9"],
 " string from our expression.\n\nJose: This package has been excised from ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 " in April 2012, to make it easier to maintain, and to acknowledge the \
essential contributions by Thomas and Barry."
}], "Text",
 CellChangeTimes->{
  3.6804992957846956`*^9},ExpressionUUID->"2e87b620-7419-4a9d-aab1-\
ee836d2456bb"],

Cell[CellGroupData[{

Cell["1. Info and copyright", "Section",
 FontColor->RGBColor[0, 0, 1],
 ExpressionUUID -> "e9eccd9b-f825-49d6-a634-9f0abf3e9ee2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IntegerPart", "/@", 
  RowBox[{"Date", "[", "]"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"cd96d29b-6f86-4aab-a8d0-9e2c278d5c17"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2018", ",", "3", ",", "29", ",", "10", ",", "32", ",", "8"}], 
  "}"}]], "Output",
 CellLabel->"Out[1]=",ExpressionUUID->"27e4bef9-7f38-4f0d-a0f0-922269ce4126"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xAct`TexAct`$Version", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<0.4.1\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2018", ",", "03", ",", "29"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xAct`TexAct`$xTensorVersionExpected", "=", "\[NoBreak]", 
   RowBox[{"{", 
    RowBox[{"\"\<1.1.0\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2013", ",", "9", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellLabel->"In[2]:=",ExpressionUUID->"e3e58c99-fae0-43de-9df5-19758902ebd8"],

Cell[CellGroupData[{

Cell["1.0. TODO LIST", "Subsection",ExpressionUUID->"41c144d8-fd2c-4aa9-85e6-12503a2beb33"],

Cell["Fix SeriesData.", "Text",
 CellChangeTimes->{{3.6057872245735283`*^9, 
  3.605787252143567*^9}},ExpressionUUID->"24fb36e6-bfca-4b1b-ae7f-\
8c46fd106ecd"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.1. GPL", "Subsection",ExpressionUUID->"38f7abb1-b4fd-4d1d-a999-f56042da9d2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"TexAct", ",", " ", 
    RowBox[{
    "Tex", " ", "code", " ", "to", " ", "format", " ", "xAct", " ", 
     "expressions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Copyright", " ", 
      RowBox[{"(", "C", ")"}], " ", "2008"}], "-", 
     RowBox[{"2016", " ", "Thomas", " ", "B\[ADoubleDot]ckdahl"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Jose", " ", 
      RowBox[{"M", ".", " ", "Martin"}]}], "-", 
     RowBox[{"Garcia", " ", "and", " ", "Barry", " ", "Wardell"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "program", " ", "is", " ", "free", " ", "software"}], ";", 
     " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\[IndentingNewLine]", " ", 
      "it", " ", "under", " ", "the", " ", "terms", " ", "of", " ", "the", 
      " ", "GNU", " ", "General", " ", "Public", " ", "License", " ", "as", 
      " ", "published", "\[IndentingNewLine]", " ", "by", " ", "the", " ", 
      "Free", " ", "Software", " ", "Foundation"}], ";", " ", 
     RowBox[{
     "either", " ", "version", " ", "2", " ", "of", " ", "the", " ", 
      "License"}]}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{"or", " ", 
     RowBox[{"(", 
      RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
     "later", " ", 
     RowBox[{
     "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "This"}], 
     " ", "program", " ", "is", " ", "distributed", " ", "in", " ", "the", 
     " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
     "useful"}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
     RowBox[{
     "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ",
       "of", "\[IndentingNewLine]", " ", "MERCHANTABILITY", " ", "or", " ", 
      "FITNESS", " ", "FOR", " ", "A", " ", "PARTICULAR", " ", 
      RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", 
      "\[IndentingNewLine]", " ", "General", " ", "Public", " ", "License", 
      " ", "for", " ", "more", " ", 
      RowBox[{
      "details", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "You"}], 
      " ", "should", " ", "have", " ", "received", " ", "a", " ", "copy", " ",
       "of", " ", "the", " ", "GNU", " ", "General", " ", "Public", " ", 
      "License", "\[IndentingNewLine]", " ", "along", " ", "with", " ", 
      "this", " ", "program"}], ";", " ", 
     RowBox[{"if", " ", "not"}]}], ",", " ", 
    RowBox[{
    "write", " ", "to", " ", "the", " ", "Free", " ", "Software", 
     "\[IndentingNewLine]", " ", "Foundation"}], ",", " ", 
    RowBox[{"Inc", "."}], ",", " ", 
    RowBox[{
     RowBox[{"59", " ", "Temple", " ", "Place"}], "-", 
     RowBox[{"Suite", " ", "330"}]}], ",", " ", "Boston", ",", " ", 
    RowBox[{
     RowBox[{"MA", " ", "02111"}], "-", "1307"}], ",", "\[IndentingNewLine]", 
    "  ", 
    RowBox[{"USA", "."}]}], " ", "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5449471950564704`*^9, 3.582278943553317*^9, {3.6463819555013123`*^9, 
   3.646381955581312*^9}, {3.6799839087530546`*^9, 3.6799839096429834`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"8130e9a2-ffb1-4f73-8459-58f61d561f54"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.2. Info package", "Subsection",ExpressionUUID->"4393db84-b034-4142-974c-e10ab6afb6bb"],

Cell["\<\
(* :Title: TexAct *)

(* :Author: Thomas B\[ADoubleDot]ckdahl, Jose M. Martin-Garcia and Barry \
Wardell *)

(* :Summary: Tex code to format xAct expressions *)

(* :Brief Discussion:
*)
  
(* :Context: xAct`Texsor` *)

(* :Package Version: 0.3.9 *)

(* :Copyright: Thomas B\[ADoubleDot]ckdahl, Jose M. Martin-Garcia and Barry \
Wardell (2008-2016) *)

(* :History: see TexAct.History file *)

(* :Keywords: *)

(* :Source: Texsor.nb *)

(* :Warning: *)

(* :Mathematica Version: 5.1 and later *)

(* :Limitations: *)\
\>", "Input",
 PageWidth->PaperWidth,
 CellMargins->{{60, -272}, {Inherited, Inherited}},
 InitializationCell->True,
 CellChangeTimes->{{3.6799839204321203`*^9, 3.6799839303513265`*^9}, 
   3.697739204371209*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"cd3ddec4-24fe-473c-9d4e-c462fa26328f"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.3. BeginPackage", "Subsection",ExpressionUUID->"eb7c220d-7898-4a5b-a23a-e83788e84208"],

Cell["Last package read in a session:", "Text",ExpressionUUID->"460d065f-dbc0-4d06-9fec-bee0384939f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Unevaluated", "[", "xAct`xCore`Private`$LastPackage", "]"}], "===",
      "xAct`xCore`Private`$LastPackage"}], ",", 
    RowBox[{
    "xAct`xCore`Private`$LastPackage", "=", "\"\<xAct`TexAct`\>\""}]}], "]"}],
   ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[30]:=",ExpressionUUID->"9954ddef-8280-4a96-92a0-6a9836c765e4"],

Cell[CellGroupData[{

Cell[BoxData["xAct`xCore`Private`$LastPackage"], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"6ae8e6b3-afc0-4767-a9bf-85a2b0294a5a"],

Cell[BoxData["\<\"xAct`TexAct`\"\>"], "Output",
 CellLabel->"Out[31]=",ExpressionUUID->"4d846526-b883-43cd-99f9-3cc275b98460"]
}, Open  ]],

Cell[TextData[{
 "Explicit (not hidden) import of ",
 StyleBox["xCore",
  FontSlant->"Italic"],
 ",  ",
 StyleBox["xPerm",
  FontSlant->"Italic"],
 " and ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 ":"
}], "Text",ExpressionUUID->"b5b9d2aa-0d4a-4d23-9b11-84a7a9fd9b2d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<xAct`TexAct`\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<xAct`xCore`\>\"", ",", "\"\<xAct`xPerm`\>\"", ",", 
     "\"\<xAct`xTensor`\>\""}], "}"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[32]:=",ExpressionUUID->"9c2ee48c-f31b-4511-abf9-709c9b2e57ac"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"4164c930-add3-4575-8af5-8ba0c59a65dd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xPerm`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.2.3\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2015", ",", "8", ",", "23"}], "}"}]}],
  SequenceForm["Package xAct`xPerm`  version ", "1.2.3", ", ", {2015, 8, 23}],
  
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"65e41f75-a54d-426e-b007-bf1fde48c748"],

Cell[BoxData["\<\"CopyRight (C) 2003-2018, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"01584cd7-7e97-4bfa-b12d-408bbc812c9d"],

Cell[BoxData["\<\"Connecting to external MinGW executable...\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"48f69ae6-0936-45aa-a382-bc97c392827a"],

Cell[BoxData["\<\"Connection established.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"6851c8d3-f658-4775-9621-15f8298e2919"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"ce133340-f13e-4598-a33e-cf572bb7b9a7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xTensor`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.1.3\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2018", ",", "2", ",", "28"}], "}"}]}],
  SequenceForm[
  "Package xAct`xTensor`  version ", "1.1.3", ", ", {2018, 2, 28}],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"afdf858e-b563-4998-adc5-54b52b064761"],

Cell[BoxData["\<\"CopyRight (C) 2002-2018, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"60df2230-54bb-4615-a452-bd1d75c87d86"]
}, Open  ]],

Cell[BoxData["\<\"xAct`TexAct`\"\>"], "Output",
 CellLabel->"Out[32]=",ExpressionUUID->"2cdd022e-6449-4164-90f9-e65cf005ac92"]
}, Open  ]],

Cell[TextData[{
 "Check version of ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 ". We simply compare dates:"
}], "Text",ExpressionUUID->"270a4b92-8294-4842-a48a-d795a42e496e"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"Not", "@", 
    RowBox[{"OrderedQ", "@", 
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"{", 
        RowBox[{
        "xAct`TexAct`$xTensorVersionExpected", ",", "xAct`xTensor`$Version"}],
         "}"}]}], "]"}]}]}], ",", 
   RowBox[{"Throw", "@", 
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"General", "::", "versions"}], ",", "\"\<xTensor\>\"", ",", 
      "xAct`xTensor`$Version", ",", "xAct`TexAct`$xTensorVersionExpected"}], 
     "]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[33]:=",ExpressionUUID->"8b7a7e8f-21e0-44f4-b33e-d87debd1156a"],

Cell["Message:", "Text",ExpressionUUID->"2cdcf8f9-dad3-484e-9c18-ce3b9c87bc00"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Package xAct`TexAct`  version \>\"", ",", 
    RowBox[{"xAct`TexAct`$Version", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"xAct`TexAct`$Version", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  "\"\<CopyRight (C) 2008-2018, Thomas B\[ADoubleDot]ckdahl, Jose M. \
Martin-Garcia and Barry Wardell, under the General Public License.\>\"", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.679983942480356*^9, 3.6977391900481887`*^9, 
  3.7273420753340883`*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"3794754e-8740-4d2d-a65f-2c74d151e490"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"0723065e-662e-4df8-b2bd-62eb410e663e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`TexAct`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.4.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2018", ",", "3", ",", "29"}], "}"}]}],
  SequenceForm["Package xAct`TexAct`  version ", "0.4.1", ", ", {2018, 3, 29}],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"1838a942-24d6-4a7d-801d-7ba54147a28d"],

Cell[BoxData["\<\"CopyRight (C) 2008-2018, Thomas B\[ADoubleDot]ckdahl, Jose \
M. Martin-Garcia and Barry Wardell, under the General Public License.\"\>"], \
"Print",
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"6ad85494-12a2-457b-9882-fd3d8a42a492"]
}, Open  ]]
}, Open  ]],

Cell["\<\
We specify the context xAct`TexAct` to avoid overriding the Disclaimer of \
other packages. However we need to turn off the message General:shdw \
temporarily:\
\>", "Text",ExpressionUUID->"eda21b64-e275-42fc-b2c4-786afb37e5ef"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`TexAct`Disclaimer", "[", "]"}], ":=", 
  RowBox[{
  "Print", "[", 
   "\"\<These are points 11 and 12 of the General Public \
License:\\n\\nBECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO \
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT \
WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES \
PROVIDE THE PROGRAM `AS IS\.b4 WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED \
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF \
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO \
THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM \
PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR \
CORRECTION.\\n\\nIN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO \
IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY \
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR \
DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES \
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT \
LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED \
BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER \
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE \
POSSIBILITY OF SUCH DAMAGES.\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[37]:=",ExpressionUUID->"e93e99a1-fcc8-43ec-a409-89f406e422b6"],

Cell["\<\
If TexAct is the last package begin read, print the GPL message:\
\>", "Text",ExpressionUUID->"a3830b80-712b-4639-ad55-94630fcffd26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"xAct`xCore`Private`$LastPackage", "===", "\"\<xAct`TexAct`\>\""}],
    ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unset", "[", "xAct`xCore`Private`$LastPackage", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", 
     "\"\<These packages come with ABSOLUTELY NO WARRANTY; for details type \
Disclaimer[]. This is free software, and you are welcome to redistribute it \
under certain conditions. See the General Public License for details.\>\"", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[40]:=",ExpressionUUID->"9268fe77-46cf-4d3d-b674-b2732878bb63"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[40]:=",ExpressionUUID->"08aaac9c-7ec6-4138-9ac2-fb5d7c92124f"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[40]:=",ExpressionUUID->"ab2bbced-e2a5-421b-88df-3cdb17a7bb56"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[40]:=",ExpressionUUID->"75ee802f-5ad6-475a-b58b-8ad2a355acdd"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["1.4. Usage messages", "Subsection",ExpressionUUID->"1b0304e1-a9be-4b57-a339-23b1fe955c4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "::", "usage"}], "=", 
   "\"\<Tex[expr] returns a string with the TeX formatting of the tensorial \
expression expr.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrint", "::", "usage"}], "=", 
   "\"\<TexPrint[expr] returns a string for screen printing of the TeX \
formatting of the tensorial expression expr. TexPrint[expr, n] starts using \
parenthesization of level n, instead of the Automatic level.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "::", "usage"}], "=", 
   "\"\<TexBreak[string] breaks the string (the output of TexPrint) into \
different lines of TeX code, always before a sum, approximately every 200 \
characters (or terms, using the option TexBreakBy) of the string. \
TexBreak[string, n] allows specifying the frequency of characters or terms. \
TexBreak[string, n, list] allows specifying different lengths for different \
lines. Other relevant options are TexBreakAt and TexBreakString.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakBy", "::", "usage"}], "=", 
   "\"\<TexBreakBy is an option for TexBreak specifying whether the string of \
TeX code must be broken by counting characters (value \\\"Character\\\") or \
by counting terms (value \\\"Term\\\").\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakAt", "::", "usage"}], "=", 
   "\"\<TexBreakAt is an option for TexBreak specifying where to break the \
string of TeX code.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakString", "::", "usage"}], "=", 
   "\"\<TexBreakString is an option for TexBreak specifying the string to be \
introduced at the breaking points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexPrintInitialBracesQ", "::", "usage"}], "=", 
   "\"\<$TexPrintInitialBracesQ is a Boolean global variable, with default \
False. If set to True a tensor is formatted as T{}^{ab}{}_{cd}. If set to \
False the same tensor is formatted as T^{ab}{}_{cd}.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexScalarParentheses", "::", "usage"}], "=", 
   "\"\<$TexScalarParentheses is a Boolean global variable, with default \
True. If set to True the Scalar expressions are formatted with wrapping \
parentheses.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFraction", "::", "usage"}], "=", 
   "\"\<$TexFraction is a global variable specifying the Tex command to be \
used to format fractions, with default \\\"\\\\frac\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexSmallFraction", "::", "usage"}], "=", 
   "\"\<$TexSmallFraction is a global variable specifying the Tex command to \
be use to format rational numbers, with default \\\"\\\\tfrac\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexSmallFractionExponent", "::", "usage"}], "=", 
   "\"\<$TexSmallFractionExponent is a global variable specifying the Tex \
command to be use to format rational numbers, with default False.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFractionAsFraction", "::", "usage"}], "=", 
   "\"\<Option for TexPrint. If True, fractions are printed as fractions, \
otherwize they are printed as a product with negative exponents.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexParenthesisInitLevel", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexFixExtraRules", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexMatrix", "::", "usage"}], " ", "=", 
   "\"\<TexMatrix[M] produces TeX code for the matrix M, where all elements \
are typset by the function Tex. TexMatrix[M, F] uses the function F instead \
of Tex on the elements.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndexForm", "::", "usage"}], " ", "=", 
   "\"\<Special formatting for indices.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexTmpDirectory", "::", "usage"}], " ", "=", 
   "\"\<Directory for placement of the TexActWidthTest.tex file for \
determining of widths for linebreaking.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexDirectory", "::", "usage"}], "=", 
   "\"\<Directory for placement of the output .tex file.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexInitLatexCode", "::", "usage"}], "=", 
   "\"\<A function that produces the initial lines of the TexActWidthTest.tex \
file for determining of widths for linebreaking. Observe that \
\\\\begin{document} should not be included. This is constructed from the \
string $TexInitLatexClassCode, and the lists $TexInitLatexPackages, \
$TexInitLatexExtraCode.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexClassCode", "::", "usage"}], "=", 
   "\"\<The document class code for the LaTeX output.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexPackages", "::", "usage"}], "=", 
   "\"\<A list of packages for the LaTeX output. This should be a list of \
strings, where each string has teh form {package}. This is then transformed \
to \\\\usepackage{package}\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexExtraCode", "::", "usage"}], "=", 
   "\"\<Extra lines for definition of special LaTeX commands. This should be \
a list of strings.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrintAlignedEquations", "::", "usage"}], " ", "=", 
   "\"\<TexPrintAlignedEquations takes a list of equations and typesets them \
in an align environment with line breaking so the total length does not \
exceed $TexPrintPageWidth.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexPrintPageWidth", "::", "usage"}], " ", "=", " ", 
   "\"\<Parameter to adjust the line breaking for TexPrintAlignedEquations. \
This is measured in printer points. Observe that you can use the textwidth \
variable which is read from the latex environment.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latextextwidth", "::", "usage"}], "=", 
   "\"\<A symbol representing the textwidth variable in the current latex \
environment.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "::", "usage"}], " ", "=", 
   "\"\<FormatTexBasis works the same way as FormatBasis, but for the Tex \
output.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquationMarks", "::", "usage"}], " ", "=", 
   "\"\<An option for TexBreak to include \\\\begin{equation} \
\\\\end{equation} or similar constructions. Default is False, but a standard \
value would be \\\"equation\\\". Warning, do not use this on TexPrint if the \
result is passed to TexBreak.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddEquationMarks", "::", "usage"}], "=", 
   "\"\<Adds \\\\begin{equation} \\\\end{equation} or similar constructions \
to a tex string. The default is Automatic which makes an educated \
guess.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexView", "::", "usage"}], "=", 
   "\"\<TexView is used to compile and view tex output. The first argument \
can be a tex string, a list of equations, a single equation or expression. A \
second optional argument can be given to set the file name without extension. \
The compiler is set by $LatexExecutable. The file extension of the file to \
view is set by $TexViewExt.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPort", "::", "usage"}], "=", 
   "\"\<Does the same thing as TexView, but it does not open the file. A file \
name must be given as a second argument.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$LatexExecutable", "::", "usage"}], " ", "=", 
   "\"\<Command for compiling LaTeX. The default is pdflatex. Add the path to \
the file if the default value does not work.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexViewExt", "::", "usage"}], " ", "=", " ", 
   "\"\<The file extension for output file to view. The defailt is .pdf. If \
you want to open the .tex file in your default editor use .tex instead. \
Observe however that TexView overwrites files without asking so editing this \
file might not be a good idea.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrintAlignedExpressions", "::", "usage"}], "=", 
   "\"\<Takes a list of expressions, and typesets them in an aligned \
environment.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EnableTexColor", "::", "usage"}], "=", 
   "\"\<EnableTexColor[] enables the use of colors in the tex output.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DisableTexColor", "::", "usage"}], "=", 
   "\"\<DisableTexColor[] disables the use of colors in the tex \
output.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParenthesisOldStyle", "::", "usage"}], "=", 
   "\"\<ParenthesisOldStyle can be given as a second argument to TexPrint to \
recover the old style of counting parenthesis levels.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexOverline", "::", "usage"}], "=", 
   "\"\<TexOverline[str] returns \\\\overline{str}.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexUnderline", "::", "usage"}], "=", 
   "\"\<TexUnderline[str] returns \\\\underline{str}\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBar", "::", "usage"}], "=", 
   "\"\<TexBar[str] returns \\\\bar{str}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexTilde", "::", "usage"}], "=", 
   "\"\<TexTilde[str] returns \\\\tilde{str}\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexHat", "::", "usage"}], "=", 
   "\"\<TexHat[str] returns \\\\hat{str}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexColor", "::", "usage"}], "=", 
   "\"\<TexColor[str, RGBColor[r, g, b]] adds Tex code to color the string \
str. Please use EnableTexColor first.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderedPlus", "::", "usage"}], "=", 
   "\"\<OrderedPlus can be used instead of Plus when printing if a different \
term ordering than the Standard Mathematica term ordering is required. \
Observe that OrderedPlus is intended for printing, not for \
calculations.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToOrderedPlus", "::", "usage"}], "=", 
   "\"\<ToOrderedPlus is a rule that transformes Plus expressions to an \
OrderedPlus with the terms sorted with the function \
$ToOrderedPlusSortFunc\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToOrderedPlusSortFunc", "::", "usage"}], "=", 
   "\"\<ToOrderedPlusSortFunc is a sorting function for ToOrderedPlus.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "$TexMatrixParen", "=", 
   "\"\<$TexMatrixParen sets the parenthesis type for matrices.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexLabelName", "::", "usage"}], " ", "=", 
   "\"\<TexLabelName[\\\"eqname\\\"] gives the tex label of the equation \
stored in the variable eqname.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreakInParenthesis", "::", "usage"}], "=", 
   "\"\<TexBreakInParenthesis is an option fot TexBreak. When set to False, \
no linebreaking is allowed within a parenthesis.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexNoSumInNumerator", "::", "usage"}], " ", "=", " ", 
   "\"\<If $TexNoSumInNumerator is set to True, Tex will move all sums in \
numerators out of fractions.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexInitLatexInternalClassCode", "::", "usage"}], "=", 
   "\"\<The document class code for by TexView if \
$TexViewInternal==True.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TexViewInternal", "::", "usage"}], "=", 
   "\"\<If $TexViewInternal==True, TexView will open the typset file in \
Mathematica instead of an external viewer. Observe that \
$TexInitLatexInternalClassCode will be used instead of $TexInitLatexClassCode \
in this case.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "::", "usage"}], " ", "=", 
   "\"\<OpenParenthesis[level, char] determines how an opening parenthesis at \
level with default character char will be displayed. If one for instance \
wants brackets instead of round parenthesis at level 1, set \
OpenParenthesis[1,\\\"(\\\"]:=\\\"\\\\bigl [\\\"\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseParenthesis", "::", "usage"}], " ", "=", 
   "\"\<CloseParenthesis[level, char] determines how a closing parenthesis at \
level with default character char will be displayed. If one for instance \
wants brackets instead of round parenthesis at level 1, set \
CloseParenthesis[1,\\\")\\\"]:=\\\"\\\\bigl ]\\\"\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0H0s1HEABvDret1NEs2ohht33U45qbCG9u2UiaFc5rWaESlRLfxxXppu
KlxbIZqyHRWXsy4Xi5ZwYmQ7t2PlkJqpfj/b9TJcy1zfxx/PPv89z/bwU3NO
pXM5HI4fDdyQ5PdQoGDISvTSI0i4KSroICpXwyVrlVRINST/CYcH9rHFgzUM
yUyX3oQ9BZvsSjUMyRuO3w5T6ztbn71gyOy4vgc2O7/XtVCFVmkvdJubdPpA
VfrO7IFys8IY/ZIhaRofExxrZEdiqId2nBiFIbV8IwwS5prgN9eq/uJu2tuR
/Q8aFoZtUOmdxSmhmrao1J3UsahwLRyYXX0Fj5QVGODuIr7kNfXSzyp/aHd4
uRS6LQdWQgdu5H1oEG2ug+ruxgTxG4awWm0O/BjFuw0PThTWw+s8FxWUrWto
go9dj7XAranBrbD2VtEA/HLt3jD0aODs2k/dZjrnDongqxguKl28YXVFaC/0
F6n1sL0ubwh+95uegC4l9Tboe8G0plr225jdxxB7S7l5TZ3rEjzvwLfC+erQ
FShK7LO/TC04+dwd1ojKPOA7N6sX3KsQCmBzgPRHgJkhXXIfCyx2emr0nKK/
jAbNQq9859i5ebqbnZMEzy7KeZZfDElI7reD+rm/d1gxS/RZE2qoC0uJyfBh
ydFxTizMVA3EQW7MTAaUpDtquBdZcjfuzDSM57dtXE8N1nziwdPKB3KYa4ss
hDsTyjssV1jSdLylH6ZFRuSFtLFE7BhYCFsnPW/AKeOCAibyPre7D7KkYjXw
LYyTCJOeUAdt+Vdhl9Zfwh9iyUhlSRgsGpdFwApZkwz+B9M4pXY=
  "],
 CellLabel->"In[41]:=",ExpressionUUID->"f680fbcd-75c0-48e6-905e-0393974f1e4c"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.5. Begin private section", "Subsection",ExpressionUUID->"bc355029-52ca-4a2d-9c7a-3472eb7c75bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[94]:=",ExpressionUUID->"dcf3a5f4-7473-4a52-a72d-21a3b8feeea7"],

Cell[BoxData["\<\"xAct`TexAct`Private`\"\>"], "Output",
 CellLabel->"Out[94]=",ExpressionUUID->"60306de0-4cec-4743-a343-0bb85fbcab45"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Parentheses", "Section",
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"d1b9726f-1155-4170-b8a2-2848a514dd15"],

Cell[CellGroupData[{

Cell["2.1. Open and close parentheses", "Subsection",ExpressionUUID->"8109d6e6-8186-421a-8b5c-0b98eb41363f"],

Cell["We define a hierarchy of parenthesis.", "Text",ExpressionUUID->"ac1a6da4-daab-4756-9df3-106b447760b8"],

Cell[TextData[{
 "There is a global variable ",
 StyleBox["level", "Input"],
 " that stores the parenthesization level at each particular time. There is \
also the global variable ",
 StyleBox["minlevel", "Input"],
 ". The idea is that each call to TexMaximumLevel has a Block with these two \
variables. This is not very elegant."
}], "Text",ExpressionUUID->"4073dc58-daa0-45bd-a344-8f8635d187fe"],

Cell[TextData[{
 "TB: A possible alternative would be to typeset once, and add a special \
\[OpenCurlyDoubleQuote]open\[CloseCurlyDoubleQuote] symbol and a \
\[OpenCurlyDoubleQuote]close\[CloseCurlyDoubleQuote] symbol. Another string \
",
 StyleBox["parenthesisstring",
  FontSlant->"Italic"],
 " can contain just the \[OpenCurlyDoubleQuote]open\[CloseCurlyDoubleQuote] \
and \[OpenCurlyDoubleQuote]close\[CloseCurlyDoubleQuote] symbols. This string \
can be built either from the Tex string. At the final pass the \
\[OpenCurlyDoubleQuote]open\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]close\[CloseCurlyDoubleQuote] symbols in the Tex \
string can be replaced by the correct Tex code with a level that can be \
computed by tracing backwards or forwards in ",
 StyleBox["parenthesisstring",
  FontSlant->"Italic"],
 " until the matching \[OpenCurlyDoubleQuote]open\[CloseCurlyDoubleQuote] or \
\[OpenCurlyDoubleQuote]close\[CloseCurlyDoubleQuote]  symbol is found."
}], "Text",
 CellChangeTimes->{{3.604591698637143*^9, 3.6045917861972656`*^9}, {
   3.604591882707401*^9, 3.60459191062744*^9}, {3.604591941357483*^9, 
   3.604592023687598*^9}, {3.604592102447708*^9, 3.6045922870160856`*^9}, {
   3.6045923314261475`*^9, 3.604592475236349*^9}, 3.60507753165971*^9, 
   3.6050775778197746`*^9, {3.605078218671672*^9, 3.6050782695817432`*^9}, {
   3.6050794399433813`*^9, 3.6050794948134584`*^9}, {3.6050795409335227`*^9, 
   3.6050795940535975`*^9}, {3.6050816576994877`*^9, 
   3.6050816597894907`*^9}, {3.6050817176395717`*^9, 
   3.605081736399598*^9}},ExpressionUUID->"aae7169c-fe09-49f9-98f9-\
40b86c14ce9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexParenthesisNewstyle", "=", "False"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050159561854787`*^9, 3.6050159801955123`*^9}, {
  3.605016720586549*^9, 3.6050167212365503`*^9}, {3.605077330349428*^9, 
  3.6050773306494284`*^9}, {3.605081740789604*^9, 3.6050817412096043`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"ca8bd73f-cc8f-4d97-980d-0d4dfd2327db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexOpenParChar", "=", 
   RowBox[{"FromCharacterCode", "[", "23", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexDelimParChar", "=", 
   RowBox[{"FromCharacterCode", "[", "16", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexCloseParChar", "=", 
   RowBox[{"FromCharacterCode", "[", "25", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605014267202114*^9, 3.60501427837213*^9}, {
   3.605014426872338*^9, 3.605014443612361*^9}, {3.7288016969670167`*^9, 
   3.72880170768563*^9}, 3.7288017663979883`*^9, {3.7288018535709743`*^9, 
   3.7288018539489956`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"10654146-f54c-4397-8e79-be1f416e6530"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TexOpen", "[", "string_String", "]"}], ":=", 
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{
     RowBox[{"Decrement", "[", "level", "]"}], ",", "string"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexClose", "[", "string_String", "]"}], ":=", 
   RowBox[{"CloseParenthesis", "[", 
    RowBox[{
     RowBox[{"PreIncrement", "[", "level", "]"}], ",", "string"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.72880064434081*^9, 3.728800655772464*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"f91669ac-0b40-4345-98dc-481b5e94164a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Trick", " ", "to", " ", "count", " ", "maximum", " ", "depth"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"OpenParenthesis", "[", 
      RowBox[{
       RowBox[{"level_Integer", "?", "Negative"}], ",", "string_String"}], 
      "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{"$TexParenthesisNewstyle", ",", 
       RowBox[{"$TexOpenParChar", "<>", "string", "<>", "$TexDelimParChar"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"minlevel", "=", 
          RowBox[{"Min", "[", 
           RowBox[{"minlevel", ",", "level"}], "]"}]}], ";", "string"}], 
        ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseParenthesis", "[", 
      RowBox[{
       RowBox[{"level_Integer", "?", "Negative"}], ",", "string_String"}], 
      "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{"$TexParenthesisNewstyle", ",", 
       RowBox[{"$TexCloseParChar", "<>", "string", "<>", "$TexDelimParChar"}],
        ",", "\[IndentingNewLine]", "string"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050160602756243`*^9, 3.6050160851856594`*^9}, {
  3.6050161165457034`*^9, 3.605016168235776*^9}, {3.6050813979191236`*^9, 
  3.6050814211991563`*^9}, {3.728800597823149*^9, 3.7288006100458484`*^9}, {
  3.728800661337782*^9, 3.728800731309784*^9}, {3.7288017745574546`*^9, 
  3.7288017778536434`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"9349a50a-4a21-4485-b8b5-fe77066874cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"0", ",", "str_"}], "]"}], ":=", "str"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", 
     RowBox[{"0", ",", "str_"}], "]"}], ":=", "str"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"1", ",", "str_"}], "]"}], ":=", 
   RowBox[{"\"\<\\\\bigl\>\"", "<>", "str"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", 
     RowBox[{"1", ",", "str_"}], "]"}], ":=", 
    RowBox[{"\"\<\\\\bigr\>\"", "<>", "str"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"2", ",", " ", "str_"}], "]"}], ":=", 
   RowBox[{"\"\<\\\\Bigl\>\"", "<>", "str"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", 
     RowBox[{"2", ",", "str_"}], "]"}], ":=", 
    RowBox[{"\"\<\\\\Bigr\>\"", "<>", "str"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"3", ",", "str_"}], "]"}], ":=", 
   RowBox[{"\"\<\\\\biggl\>\"", "<>", "str"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", 
     RowBox[{"3", ",", "str_"}], "]"}], ":=", 
    RowBox[{"\"\<\\\\biggr\>\"", "<>", "str"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"4", ",", "str_"}], "]"}], ":=", 
   RowBox[{"\"\<\\\\Biggl\>\"", "<>", "str"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CloseParenthesis", "[", 
     RowBox[{"4", ",", "str_"}], "]"}], ":=", 
    RowBox[{"\"\<\\\\Biggr\>\"", "<>", "str"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{
     RowBox[{"level_Integer", "?", "Positive"}], ",", "str_"}], "]"}], ":=", 
   RowBox[{"\"\<\\\\left\>\"", "<>", "str"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseParenthesis", "[", 
    RowBox[{
     RowBox[{"level_Integer", "?", "Positive"}], ",", "str_"}], "]"}], ":=", 
   RowBox[{"\"\<\\\\right\>\"", "<>", "str"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605014998553138*^9, 3.605015004793147*^9}, {
  3.7288007654497366`*^9, 3.7288008661134944`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"0f9115a4-615a-475f-8fb1-a2232303bcb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Main", ".", " ", "Private"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"TexMaximumLevel", "[", "expr_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"level", "=", "0"}], ",", 
        RowBox[{"minlevel", "=", "0"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Tex", "[", "expr", "]"}], ";", 
       RowBox[{"-", "minlevel"}]}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[115]:=",ExpressionUUID->"dbf513dd-d1c0-423e-bf16-4fe42b26e16a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Safety", " ", "definitions", " ", "for", " ", "direct", " ", "examples", 
    " ", "with", " ", "Tex"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"level", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minlevel", "=", "0"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[116]:=",ExpressionUUID->"83c5c553-48b6-4c7e-9f7a-c4efe900a3e1"]
}, Closed]],

Cell[CellGroupData[{

Cell["2.2. Main function", "Subsection",ExpressionUUID->"cc430464-7283-4200-b40c-a9f452aeb9ac"],

Cell["\<\
The key idea here is that there are two calls to the function Tex. We first \
run through the whole expression with TexMaximumLevel, which uses Tex, to \
discover the number of parentheses needed. In this first run the resulting \
expression string  has wrong parentheses (actually no parentheses). Then we \
call Tex again, this time producing the correct parentheses. If we provide \
the second argument of TexParenthesis then we avoid the first run.\
\>", "Text",ExpressionUUID->"03a37158-9e9a-449a-97a7-c7d078428b2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$VerboseParenthesizationLevel", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexParenthesis", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"initlevel_:", "Automatic"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"initlevel", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"level", "=", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"$TexParenthesisNewstyle", "=", "True"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlaceParenthesis", "@", 
        RowBox[{"Tex", "[", "expr", "]"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"level", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"initlevel", "===", "ParenthesisOldStyle"}], ",", 
           RowBox[{"TexMaximumLevel", "[", "expr", "]"}], ",", "initlevel"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"$VerboseParenthesationLevel", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Maximum parenthesization level: \>\"", ",", "level"}],
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tex", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050161963058147`*^9, 3.6050162910859475`*^9}, {
  3.6050167868066416`*^9, 3.60501680711667*^9}, {3.6050168686667566`*^9, 
  3.605016910096814*^9}, {3.6050191844251165`*^9, 3.605019185115117*^9}, {
  3.6050777831100616`*^9, 3.605077790650072*^9}, {3.6050819010698285`*^9, 
  3.6050819305098696`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"e1ae01c9-57d9-4ec0-8e54-869d79f58526"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlaceParenthesis", "[", "texinstr_String", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"parchars", "=", 
        RowBox[{"StringCases", "[", 
         RowBox[{"texinstr", ",", 
          RowBox[{"Alternatives", "[", 
           RowBox[{"$TexOpenParChar", ",", "$TexCloseParChar"}], "]"}]}], 
         "]"}]}], ",", "substrings", ",", " ", "currentparchar", ",", 
       RowBox[{"texstring", "=", "\"\<\>\""}], ",", 
       RowBox[{"i", "=", "1"}], ",", "j", ",", "parlevel", ",", " ", 
       "maxparlevel"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"substrings", "=", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"texinstr", ",", 
         RowBox[{"Alternatives", "[", 
          RowBox[{
          "$TexOpenParChar", ",", "$TexCloseParChar", ",", 
           "$TexDelimParChar"}], "]"}], ",", "All"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"texstring", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"texstring", ",", 
         RowBox[{"First", "@", "substrings"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "substrings"}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"substrings", "=", 
          RowBox[{"Rest", "@", "substrings"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"currentparchar", "=", 
          RowBox[{"First", "@", "substrings"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"substrings", "=", 
          RowBox[{"Rest", "@", "substrings"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"Length", "@", "parchars"}]}], "&&", 
            RowBox[{
             RowBox[{"parchars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "===", "$TexOpenParChar"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"j", "=", 
             RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"parlevel", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxparlevel", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "\[LessEqual]", " ", 
                RowBox[{"Length", "@", "parchars"}]}], "&&", 
               RowBox[{"parlevel", ">", "0"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"parchars", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "===", "$TexOpenParChar"}],
                  ",", 
                 RowBox[{"maxparlevel", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{"maxparlevel", ",", 
                    RowBox[{"++", "parlevel"}]}], "]"}]}], ",", 
                 RowBox[{"parlevel", "--"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"texstring", "=", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"texstring", ",", 
               RowBox[{"OpenParenthesis", "[", 
                RowBox[{
                 RowBox[{"maxparlevel", "-", "1"}], ",", "currentparchar"}], 
                "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"Length", "@", "parchars"}]}], "&&", 
            RowBox[{
             RowBox[{"parchars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "===", "$TexCloseParChar"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"j", "=", 
             RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"parlevel", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxparlevel", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "\[GreaterEqual]", " ", "1"}], "&&", 
               RowBox[{"parlevel", ">", "0"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"parchars", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "===", 
                  "$TexCloseParChar"}], ",", 
                 RowBox[{"maxparlevel", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{"maxparlevel", ",", 
                    RowBox[{"++", "parlevel"}]}], "]"}]}], ",", 
                 RowBox[{"parlevel", "--"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"j", "--"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"texstring", "=", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"texstring", ",", 
               RowBox[{"CloseParenthesis", "[", 
                RowBox[{
                 RowBox[{"maxparlevel", "-", "1"}], ",", "currentparchar"}], 
                "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"texstring", "=", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"texstring", ",", 
            RowBox[{"First", "@", "substrings"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "texstring"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6050183452939415`*^9, 3.605018470384117*^9}, {
  3.605018580314271*^9, 3.605018691144426*^9}, {3.605018724634473*^9, 
  3.605018766794532*^9}, {3.605018796884574*^9, 3.605018842594638*^9}, {
  3.605018877054686*^9, 3.6050188800246906`*^9}, {3.605018934284766*^9, 
  3.6050190582749395`*^9}, {3.605019116255021*^9, 3.605019157695079*^9}, {
  3.6050191939051294`*^9, 3.605019228025178*^9}, {3.605076697588542*^9, 
  3.605076761878632*^9}, {3.6050793305232286`*^9, 3.6050793786932955`*^9}, {
  3.6050817692196436`*^9, 3.605081784199665*^9}, {3.6057865208515434`*^9, 
  3.605786521541544*^9}, {3.728801082375864*^9, 3.728801104662139*^9}, {
  3.7288012866125455`*^9, 3.728801298828244*^9}, {3.728803782074278*^9, 
  3.7288038385285068`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"577b9972-74c7-4e0b-88ff-d46640381077"]
}, Closed]],

Cell[CellGroupData[{

Cell["2.3. Alternative code. Not used", "Subsection",ExpressionUUID->"9c261caa-46c6-46df-898a-808577c96786"],

Cell["\<\
This is some alternative code whose origin or purpose has been forgotten... \
It is not included in the package.\
\>", "Text",ExpressionUUID->"28d1afb5-6250-43d5-b0d9-9226c34ca9ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZParenth", "[", 
     RowBox[{"ZParenth", "[", "expr_", "]"}], "]"}], ":=", 
    RowBox[{"ZParenth", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Atoms", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"x", ":", 
     RowBox[{"(", 
      RowBox[{
      "_Symbol", "|", "_String", "|", "_Integer", "|", "_Rational", "|", 
       "_Real"}], ")"}]}], "]"}], ":=", "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "x_Complex", "]"}], ":=", 
    RowBox[{"ZParenth", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Products", " ", "and", " ", "sums"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"Times", "[", 
     RowBox[{"x_", ",", "y_Plus"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AddParenth", "[", "x", "]"}], 
    RowBox[{"ZParenth", "[", 
     RowBox[{"AddParenth", "[", "y", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"AddParenth", "/@", "expr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "expr_Plus", "]"}], ":=", 
    RowBox[{"AddParenth", "/@", "expr"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Powers", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"x", ":", 
       RowBox[{"(", 
        RowBox[{"_Symbol", "|", 
         RowBox[{
          RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], ")"}]}], ",", 
      "n_"}], "]"}], "]"}], ":=", 
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"AddParenth", "[", "x", "]"}], ",", 
     RowBox[{"AddParenth", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", 
     RowBox[{"Power", "[", 
      RowBox[{"x_", ",", "n_"}], "]"}], "]"}], ":=", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"ZParenth", "[", 
       RowBox[{"AddParenth", "[", "x", "]"}], "]"}], ",", 
      RowBox[{"AddParenth", "[", "n", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Objects", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"t", ":", 
     RowBox[{
      RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], "]"}], ":=", "t"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{"c", ":", 
     RowBox[{
      RowBox[{
       RowBox[{"_Symbol", "?", "CovDQ"}], "[", "__", "]"}], "[", "_", "]"}]}],
     "]"}], ":=", "c"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", "c_CovD", "]"}], ":=", "c"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Scalar", " ", "functions", " ", "and", " ", "inert", " ", "heads"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{
     RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "exprs__", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"AddParenth", "[", "f", "]"}], "[", 
    RowBox[{"AddParenth", "/@", 
     RowBox[{"OParenth", "[", "exprs", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddParenth", "[", 
     RowBox[{
      RowBox[{"ih_Symbol", "?", "InertHeadQ"}], "[", 
      RowBox[{"expr_", ",", "z___"}], "]"}], "]"}], ":=", 
    RowBox[{"ih", "[", 
     RowBox[{
      RowBox[{"OParenth", "[", 
       RowBox[{"AddParenth", "[", "expr", "]"}], "]"}], ",", "z"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Parametric", " ", "derivatives"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddParenth", "[", 
    RowBox[{
     RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ParamD", "[", "ps", "]"}], "[", 
    RowBox[{"OParenth", "[", 
     RowBox[{"AddParenth", "[", "expr", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddParentheses", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Pexpr", "=", 
       RowBox[{"AddParenth", "[", "expr", "]"}]}], ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pos", "=", 
      RowBox[{"Most", "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"Pexpr", ",", "ZParenth", ",", 
         RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6165042940696087`*^9, 3.6165043005896177`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"2de6adbe-1710-477c-995a-b6e5b738f7cd"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Type formatting", "Section",
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"c134f083-93e5-4e8e-bd7c-f0a1dd86faff"],

Cell[CellGroupData[{

Cell["3.0. The Tex function", "Subsection",ExpressionUUID->"a9e39fd1-11a6-4f6b-a5aa-2180390641cd"],

Cell[TextData[{
 "The function Tex does most of the actual construction of the final string. \
It gets directly the ",
 StyleBox["xAct",
  FontSlant->"Italic"],
 " expressions and returns a string. The final result will be simply a \
concatenation of the individual strings, except for the parenthesization \
issues."
}], "Text",ExpressionUUID->"e54eb1b8-5fcb-4e0b-b056-f06fcbb085e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Just", " ", "in", " ", "case"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "]"}], ":=", "\"\<\>\""}], ";"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[136]:=",ExpressionUUID->"2c125385-57f0-4ad1-84f3-850e67d67f67"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.1. Fractions", "Subsection",ExpressionUUID->"be55406d-d073-4f39-a3eb-673c7361d305"],

Cell["\<\
Because some people might want to use the \"\\\\tfrac\" or \"\\\\dfrac\" \
commands of amsmath, we introduce these two variables:\
\>", "Text",ExpressionUUID->"8dd21851-7809-4a50-a2e6-a109002300aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "$TexFraction"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"d8ec4062-9fd4-4b24-b7d4-ede3fcd0a8ee"],

Cell[BoxData["\<\"$TexFraction is a global variable specifying the Tex \
command to be used to format fractions, with default \\\"\\\\frac\\\".\"\>"], \
"Print", "PrintUsage",
 CellTags->
  "Info1373731308330-6022697",ExpressionUUID->"086ed89c-1f49-4d7d-8984-\
e187b43afcb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "$TexSmallFraction"}]], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"c6b8fdb1-a4ab-4f18-a2a7-b0febaa451c4"],

Cell[BoxData["\<\"$TexSmallFraction is a global variable specifying the Tex \
command to be use to format rational numbers, with default \\\"\\\\tfrac\\\".\
\"\>"], "Print", "PrintUsage",
 CellTags->
  "Info1383731308330-6022697",ExpressionUUID->"f027219c-571d-4c0c-84b2-\
b0a11121ac66"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexFraction", "=", "\"\<\\\\frac\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexSmallFraction", "=", "\"\<\\\\tfrac\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexSmallFractionExponent", "=", "False"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5806310924285626`*^9, 3.5806311134729996`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"90fe1d75-9328-4542-a18f-5995304e5979"],

Cell["\<\
Code to avoid printing fractions as products. One can avoid all fractions \
except rationals and square roots by setting TexFractionAsFraction->False.\
\>", "Text",ExpressionUUID->"b14f01b9-9ae6-4bf5-b872-a2324d23ac80"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexFrac1", "[", 
    RowBox[{"numer_", ",", " ", "denom_", ",", "fracsymbol_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"fracsymbol", "===", "False"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "numer", "]"}], ",", "\"\</\>\"", ",", 
       RowBox[{"Tex", "[", "denom", "]"}]}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"fracsymbol", ",", "\"\<{\>\"", ",", 
       RowBox[{"Tex", "[", "numer", "]"}], ",", "\"\<}{\>\"", ",", 
       RowBox[{"Tex", "[", "denom", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.544081263018608*^9, 3.544081269024619*^9}, {
   3.544081300926675*^9, 3.5440813401607437`*^9}, {3.5445960831255026`*^9, 
   3.544596103606674*^9}, {3.5446015397316027`*^9, 3.544601544964902*^9}, 
   3.5446016223343277`*^9, {3.5446016701880646`*^9, 3.5446016772024655`*^9}, 
   3.5806310703233237`*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"bceae0a3-9cd6-4710-9a5e-170877d2c684"],

Cell["\<\
If the numerator has a factor which is a sum, move it out if \
$TexNoSumInNumerator==True. \
\>", "Text",
 CellChangeTimes->{{3.544601259023547*^9, 3.5446012927774777`*^9}, {
  3.5446014040348415`*^9, 3.5446014161525345`*^9}, {3.7282767677644644`*^9, 
  3.7282768656845922`*^9}},
 ExpressionUUID -> "5e07f0c3-6e28-458d-a07a-90708d3c1e27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexNoSumInNumerator", "=", "False"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TexFracExpression", "[", 
    RowBox[{"numer_", ",", " ", "denom_", ",", " ", "fracsymbol_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"$TexNoSumInNumerator", ",", "\n", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"factorlist", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "===", "Times"}], ",", 
               RowBox[{"List", "@@", "#"}], ",", 
               RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "@", "numer"}], 
           ")"}]}], ",", "nosumfactors", ",", "sumfactors"}], "}"}], ",", 
       "\n", "  ", 
       RowBox[{
        RowBox[{"nosumfactors", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"factorlist", ",", 
           RowBox[{
            RowBox[{"Not", "@", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{"Plus", "|", "OrderedPlus"}], "]"}], "@", 
              RowBox[{"Head", "[", "#", "]"}]}]}], "&"}]}], "]"}]}], ";", 
        "\n", "  ", 
        RowBox[{"sumfactors", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"factorlist", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"Plus", "|", "OrderedPlus"}], "]"}], "@", 
             RowBox[{"Head", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";", "\n", 
        "  ", 
        RowBox[{
         RowBox[{"TexFracExpression2", "[", 
          RowBox[{
           RowBox[{"Times", "@@", "nosumfactors"}], ",", " ", "denom", ",", 
           "fracsymbol"}], "]"}], "<>", 
         RowBox[{"TexOperator", "[", "Times", "]"}], "<>", 
         RowBox[{"TexFactor", "[", 
          RowBox[{"Times", "@@", "sumfactors"}], "]"}]}]}]}], "]"}], ",", 
     "\n", 
     RowBox[{"TexFracExpression2", "[", 
      RowBox[{"numer", ",", " ", "denom", ",", "fracsymbol"}], "]"}]}], 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.728276729638881*^9, 3.7282767361690125`*^9}, {
   3.7282770175864334`*^9, 3.728277133457339*^9}, 3.7282773502025957`*^9, {
   3.7282775352002172`*^9, 3.7282775525147038`*^9}, {3.7282776099778185`*^9, 
   3.728277704024286*^9}, 3.728277892091427*^9, {3.7282780240297956`*^9, 
   3.728278101193147*^9}, {3.7282784467367496`*^9, 3.7282784549326982`*^9}, {
   3.728278584055101*^9, 3.728278584702806*^9}, {3.728280740214596*^9, 
   3.728280761116603*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"063e1fcf-68ef-49a1-85fa-16168535af69"],

Cell["If the numerator begins with a minus, we move the sign out. ", "Text",
 CellChangeTimes->{{3.544601259023547*^9, 3.5446012927774777`*^9}, {
  3.5446014040348415`*^9, 3.5446014161525345`*^9}},
 ExpressionUUID -> "bad3f35d-a647-401a-b349-cd82e6b6dc6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexFracExpression2", "[", 
    RowBox[{"numer_", ",", " ", "denom_", ",", "fracsymbol_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"WithMinusQ", "[", "numer", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "Minus", "]"}], ",", 
       RowBox[{"TexFrac1", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", "numer", ")"}]}], ",", "denom", ",", "fracsymbol"}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"TexFrac1", "[", 
      RowBox[{"numer", ",", "denom", ",", "fracsymbol"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.7282767412082295`*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"1c6acd26-42de-49b6-8eaa-3a2465fde7da"],

Cell["Detect the presence of a negative sign:", "Text",ExpressionUUID->"2d56a606-6efe-4121-ae16-4a7d3f52a19a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WithMinusQ", "[", "expr_String", "]"}], ":=", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"StringTake", "[", 
      RowBox[{"expr", ",", "1"}], "]"}], ",", "\"\<-\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WithMinusQ", "[", "expr_", "]"}], ":=", 
   RowBox[{"WithMinusQ", "[", 
    RowBox[{"Tex", "[", "expr", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[146]:=",ExpressionUUID->"816ff93a-13b5-4911-9341-b78e1a052a09"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.2. Numbers", "Subsection",ExpressionUUID->"a2920021-0310-4437-9b6a-142aa3cf10ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Numbers", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Integer", "]"}], ":=", 
     RowBox[{"ToString", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Real", "]"}], ":=", 
     RowBox[{"ToString", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "x_Rational", "]"}], ":=", 
     RowBox[{"TexFracExpression", "[", 
      RowBox[{
       RowBox[{"Numerator", "[", "x", "]"}], ",", 
       RowBox[{"Denominator", "[", "x", "]"}], ",", "$TexSmallFraction"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", "1"}], "]"}], "]"}], "=", "\"\<i\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], "=", "\"\<-i\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"0", ",", "im_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "im", "]"}], ",", 
       RowBox[{"Tex", "[", "I", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Complex", "[", 
       RowBox[{"re_", ",", "im_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "re", "]"}], ",", "\"\<+\>\"", ",", 
       RowBox[{"Tex", "[", 
        RowBox[{"im", " ", "I"}], "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[148]:=",ExpressionUUID->"9308bb6a-8391-47bc-b875-381b6d380fcc"],

Cell["Should we give definitions for other numeric objects here?", "Text",ExpressionUUID->"47758250-fa33-4c77-bb98-ae790243b978"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Numeric", " ", "expressions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "E", "]"}], "=", "\"\<e\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Pi", "]"}], "=", "\"\<\\\\pi\>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[155]:=",ExpressionUUID->"e2ec4615-70ff-4c9e-9a47-0159b263ec88"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.3. Strings and boxes", "Subsection",
 CellChangeTimes->{{3.6463814334005814`*^9, 3.646381438730589*^9}, {
  3.728800448727621*^9, 
  3.7288004501157007`*^9}},ExpressionUUID->"3f0da5d7-71f3-4a00-b1dc-\
f8069beb6b98"],

Cell["\<\
If we want pass a string straight through we can use this construction:\
\>", "Text",
 CellChangeTimes->{{3.5831450794032955`*^9, 3.583145103739338*^9}, {
  3.6165052685831175`*^9, 3.6165053093231745`*^9}},
 ExpressionUUID -> "bb0be36a-1d66-4c2e-ae13-03ff34e8fa8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"TexString", "[", "string_String", "]"}], "]"}], ":=", "string"}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6165053113631773`*^9, 3.6165053395832167`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"19da7b3c-4ea6-4f5a-927e-22c44c11c61a"],

Cell["Special strings not properly handled by TeXForm", "Text",
 CellChangeTimes->{{3.5831450794032955`*^9, 3.583145103739338*^9}},
 ExpressionUUID -> "4872346d-81ae-4839-b3e6-9791daac60e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "\"\<\[Eth]\>\"", "]"}], "=", "\"\<\\\\eth \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "\"\<\\\"\>\"", "]"}], "=", "\"\<\\\"\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "\"\<\\\\\>\"", "]"}], "=", "\"\<\\\\backslash\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "\"\<\[GreaterTilde]\>\"", "]"}], "=", 
   "\"\<\\\\gtrsim\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6463748483253613`*^9, {3.728544186773125*^9, 3.728544204848074*^9}, {
   3.72854709967225*^9, 3.7285471505048323`*^9}, {3.728563024314001*^9, 
   3.7285630513705482`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"7fa99e04-ebcc-4741-8537-4521ace5ff22"],

Cell["Other special strings", "Text",
 CellChangeTimes->{{3.5831450794032955`*^9, 3.583145103739338*^9}, {
  3.646374839245349*^9, 3.6463748445453568`*^9}},
 ExpressionUUID -> "ee027e4e-71fe-4b63-bcf3-3d3b28b11d33"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "\"\<\[EmptyDownTriangle]\>\"", "]"}], ":=", 
   "\"\<\\\\nabla\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[162]:=",ExpressionUUID->"3920d4df-70f3-4a43-aa4b-83a68984fe33"],

Cell["Adding overline, underline, bar, tilde or hat:", "Text",
 CellChangeTimes->{{3.5831450794032955`*^9, 3.583145103739338*^9}, {
  3.646374839245349*^9, 3.6463748445453568`*^9}, {3.6463750125465918`*^9, 
  3.646375052626648*^9}, {3.6463800857176943`*^9, 3.646380102177717*^9}},
 ExpressionUUID -> "e5c39014-20a8-45eb-9339-9cf37c5a65e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TexOverline", "[", "str_", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\overline{\>\"", ",", "str", ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexUnderline", "[", "str_", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\underline{\>\"", ",", "str", ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexBar", "[", "str_", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\bar{\>\"", ",", "str", ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexTilde", "[", "str_", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\tilde{\>\"", ",", "str", ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexHat", "[", "str_", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\hat{\>\"", ",", "str", ",", "\"\<}\>\""}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6463750640566635`*^9, 3.646375103506719*^9}, 
   3.6463800777176833`*^9},
 CellLabel->
  "In[163]:=",ExpressionUUID->"37281370-f6d0-4919-923b-e2074d3ecf73"],

Cell["\<\
New method in version 0.4.1. Strings containing \[OpenCurlyDoubleQuote]\\!\
\[CloseCurlyDoubleQuote] will be converted into boxes.\
\>", "Text",
 CellChangeTimes->{{3.7284791500963626`*^9, 3.728479223331083*^9}},
 ExpressionUUID -> "bc8dcf51-1713-4e2d-a5cc-a92b59193b5c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StringToBox", "[", "str_", "]"}], ":=", 
   RowBox[{"RemoveQuote", "/@", 
    RowBox[{"(", 
     RowBox[{"First", "@", 
      RowBox[{"First", "@", 
       RowBox[{"FrontEndExecute", "[", 
        RowBox[{"FrontEnd`UndocumentedTestFEParserPacket", "[", 
         RowBox[{"str", ",", "False"}], "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RemoveQuote", "[", "str_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"And", "[", 
      RowBox[{
       RowBox[{"StringQ", "[", "str", "]"}], ",", 
       RowBox[{"StringMatchQ", "[", 
        RowBox[{"str", ",", 
         RowBox[{"(", 
          RowBox[{"\"\<\\\"\>\"", "~~", "___", "~~", "\"\<\\\"\>\""}], 
          ")"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"str", ",", "StandardForm"}], "]"}], ",", "str"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.728483466812915*^9, 3.7284834675132627`*^9}, {
  3.72854370661716*^9, 3.728543759581272*^9}, {3.728544389635314*^9, 
  3.728544404933135*^9}, {3.7285446101858006`*^9, 3.728544637084699*^9}, {
  3.728545253108709*^9, 3.7285452771332855`*^9}, {3.728546748544945*^9, 
  3.7285467635094905`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"95f06ef9-1d12-4d95-afca-ccc80b94ecea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"str_String", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<\\!\>\""}], "]"}], "&"}], ")"}]}], "]"}], ":=", 
   RowBox[{"Tex", "@", 
    RowBox[{"StringToBox", "[", "str", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"str_String", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"StringLength", "[", "#", "]"}], ">", "1"}], "&"}], ")"}]}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"(", 
     RowBox[{"Tex", "/@", 
      RowBox[{"Characters", "[", "str", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"str_String", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"StringLength", "[", "#", "]"}], "==", "1"}], "&"}], ")"}]}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StringLength", "@", 
        RowBox[{"ToString", "[", 
         RowBox[{"FullForm", "@", "str"}], "]"}]}], ">", "3"}], ")"}], ",", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"str", ",", "TeXForm"}], "]"}], "<>", "\"\< \>\""}], ",", 
     "str"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "str_String", "]"}], ":=", "str"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7284794099067526`*^9, 3.7284796135053387`*^9}, {
   3.7284796862087307`*^9, 3.728479729544526*^9}, {3.7284798724434395`*^9, 
   3.728479888373989*^9}, {3.728480508220316*^9, 3.7284805167575083`*^9}, 
   3.728480585919126*^9, {3.728543381883875*^9, 3.728543385722888*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"be90a0a1-80f5-4a9b-a2b4-c6f10cf83de9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"RowBox", "[", "l_List", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"(", 
     RowBox[{"Tex", "/@", "l"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"OverscriptBox", "[", 
     RowBox[{"a_", ",", "\"\<^\>\""}], "]"}], "]"}], ":=", 
   RowBox[{"TexHat", "[", 
    RowBox[{"Tex", "@", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"OverscriptBox", "[", 
     RowBox[{"a_", ",", "\"\<~\>\""}], "]"}], "]"}], ":=", 
   RowBox[{"TexTilde", "[", 
    RowBox[{"Tex", "@", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"OverscriptBox", "[", 
     RowBox[{
      RowBox[{"a_String", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", "#", "]"}], "==", "1"}], "&"}], 
        ")"}]}], ",", "\"\<_\>\""}], "]"}], "]"}], ":=", 
   RowBox[{"TexBar", "[", 
    RowBox[{"Tex", "@", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"OverscriptBox", "[", 
     RowBox[{"a_", ",", "\"\<_\>\""}], "]"}], "]"}], ":=", 
   RowBox[{"TexOverline", "[", 
    RowBox[{"Tex", "@", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"OverscriptBox", "[", 
     RowBox[{"a_", ",", "\"\<.\>\""}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\dot{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"OverscriptBox", "[", 
     RowBox[{"a_", ",", "\"\<\[DoubleDot]\>\""}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\ddot{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"UnderscriptBox", "[", 
     RowBox[{"a_", ",", "\"\<_\>\""}], "]"}], "]"}], ":=", 
   RowBox[{"TexUnderline", "[", 
    RowBox[{"Tex", "@", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"SubscriptBox", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "@", "a"}], ",", "\"\<_{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}{}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"OverscriptBox", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\overset{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"UnderscriptBox", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\underset{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"UnderoverscriptBox", "[", 
     RowBox[{"\"\<\[Sum]\>\"", ",", "a_", ",", "b_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\sum_{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}^{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"UnderoverscriptBox", "[", 
     RowBox[{"\"\<\[Product]\>\"", ",", "a_", ",", "b_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\prod_{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}^{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"UnderoverscriptBox", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\underset{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}{\\\\overset{\>\"", ",", 
     RowBox[{"Tex", "@", "c"}], ",", "\"\<}{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "@", "a"}], ",", "\"\<^{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}{}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"SubsuperscriptBox", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "@", "a"}], ",", "\"\<_{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}^{\>\"", ",", 
     RowBox[{"Tex", "@", "c"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"FractionBox", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\frac{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}{\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"SqrtBox", "[", "a_", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\sqrt{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"RadicalBox", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\sqrt[\>\"", ",", 
     RowBox[{"Tex", "@", "b"}], ",", "\"\<]{\>\"", ",", 
     RowBox[{"Tex", "@", "a"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"GridBox", "[", 
     RowBox[{"M_List", ",", "b___"}], "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rows", "=", 
        RowBox[{"Length", "[", "M", "]"}]}], ",", 
       RowBox[{"cols", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"First", "@", "M"}]}]}]}], "}"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\begin{array}{\>\"", ",", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"\"\<c\>\"", ",", 
          RowBox[{"{", "cols", "}"}]}], "]"}]}], ",", "\"\<}\\n\>\"", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{
               RowBox[{"Tex", "/@", "#"}], ",", "\"\< & \>\""}], "]"}], "]"}],
             "&"}], "/@", "M"}], ",", "\"\<\\\\\\\\\\n\>\""}], "]"}], "]"}], 
       ",", "\"\<\\n\\\\end{array}\>\""}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"TagBox", "[", 
     RowBox[{"a_", ",", "b___"}], "]"}], "]"}], ":=", 
   RowBox[{"Tex", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"StyleBox", "[", "a__", "]"}], "]"}], ":=", 
   RowBox[{"TexStyleBox", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexStyleBox", "[", 
    RowBox[{"a_", ",", "___"}], "]"}], ":=", 
   RowBox[{"Tex", "@", "a"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQzSPSfbPp+GvHtAvO90E0B8u2FyB69uu2VyDamL35
I4g27Xz0A0Q3ny0ObAbS8zS1QkD0D5OLESC6peZdDIje97Q2BUQXLV1RBqJ5
pq+uBtHPDY/VguUvdjSC6Iqrea0gutZq+lmwecE3roLoM0bTWZYA6biDkmwg
OkO94tdKIH1pQSzzKhD/W5s1iN4i9sANRAdF/fEF0akTfPxBNI/Z0xgQPac6
JxZE862bngiiuR89zwDRs0Lml4NojZjFlSD6H0NcPYh+dmFFK4hOYvOaBKLb
Xa9NBtF6umePg+h5eyRPg2jZbcwXQXRKJtcVEN3CZvUbRO+JW/wfRB+6bya0
Gkh7Pd4sDKK5uJTkQXSJpTmYXsH/qwlE/90ysRtEv7Bungii/+g8B9MA7PXl
QQ==
  "],
 CellLabel->
  "In[174]:=",ExpressionUUID->"fb1ca26a-671c-4a24-ac84-32c26089defc"],

Cell["Older deactivated code :", "Text",
 CellChangeTimes->{{3.7284792318663263`*^9, 3.7284792370306177`*^9}, {
  3.7284792889937553`*^9, 3.728479299254712*^9}},
 ExpressionUUID -> "cb1934dd-ec1b-4b40-a6fb-6e4468814c9d"],

Cell[TextData[{
 "With strings we call ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s TeXForm, removing the frequent and annoying \\text{*} :"
}], "Text",
 ExpressionUUID -> "712f79ee-8910-4512-9718-00cbdcdeb0a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Strings", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Removetext", "[", "string_String", "]"}], ":=", 
     RowBox[{
      RowBox[{"StringDrop", "[", 
       RowBox[{
        RowBox[{"StringDrop", "[", 
         RowBox[{"string", ",", "6"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "/;", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{"string", ",", "\"\<\\\\text{*}\>\""}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Removetext", "[", "string_String", "]"}], ":=", "string"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "TeXForm", " ", "does", " ", "not", " ", "work", " ", "on", " ", 
     "StyleBoxes", " ", "so", " ", "we", " ", "remove", " ", "them", " ", 
     RowBox[{"first", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RemoveStyleBoxes", "[", "string_String", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"string", ",", 
      RowBox[{
       RowBox[{"StringExpression", "[", 
        RowBox[{
        "\"\<\\!\\(\\*StyleBox[\\\"\>\"", ",", "x___", ",", "\"\<\\\"\>\"", 
         ",", "y___", ",", "\"\<]\\)\>\""}], "]"}], "\[RuleDelayed]", "x"}]}],
      "]"}]}]}]}]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.5831371468597097`*^9, 3.5831371700569506`*^9}, {
  3.5831373257764244`*^9, 3.5831373589264827`*^9}, {3.583138164839498*^9, 
  3.583138167007902*^9}, {3.6463801467777796`*^9, 3.646380167777809*^9}, {
  3.64638032541803*^9, 3.6463803263280315`*^9}, {3.646380370178093*^9, 
  3.6463803709080935`*^9}},
 ExpressionUUID -> "1ce20ad8-c3e2-4225-9eb4-f11b9a7616dd"],

Cell["Older code for strings:", "Text",
 CellChangeTimes->{{3.646380335548044*^9, 3.646380367008088*^9}, {
  3.646380463618223*^9, 3.646380464078224*^9}},
 ExpressionUUID -> "ddbd035a-0318-47a9-a668-1fe83b49a02a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "string_String", "]"}], ":=", 
   RowBox[{"Removetext", "@", 
    RowBox[{"ToString", "@", 
     RowBox[{"TeXForm", "@", 
      RowBox[{"RemoveStyleBoxes", "@", "string"}]}]}]}]}], ";"}]], "Input",
 Evaluatable->False,
 ExpressionUUID -> "1ff53f55-7f9d-415f-9e91-e2892c322671"],

Cell["\<\
Newer code for strings. This can now handle nested hats and overlines etc. We \
do this by splitting and calling TexOrnament on every piece. TexOrnament \
turns special codes into held expressions which are then then interpreted by \
Tex. For other constructions TexOrnament calls TeXForm. See also section 8.1.\
\
\>", "Text",
 CellChangeTimes->{{3.646380335548044*^9, 3.646380367008088*^9}, {
  3.6463804671782284`*^9, 3.6463804974782705`*^9}, {3.6463805319183187`*^9, 
  3.6463805414983325`*^9}, {3.6463806014084167`*^9, 3.6463806163084373`*^9}, {
  3.6463808210487237`*^9, 3.646380879158805*^9}, {3.646380921258864*^9, 
  3.6463810100089884`*^9}, {3.64638155380075*^9, 3.646381560330759*^9}, {
  3.6978200908062277`*^9, 
  3.6978202210744114`*^9}},ExpressionUUID->"e77d8003-fef3-45c3-b432-\
5314961a6afe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "str_String", "]"}], ":=", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"(", 
     RowBox[{"TexOrnament", "/@", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"str", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", ":", 
            RowBox[{"StringExpression", "[", 
             RowBox[{"\"\<\\!\\(\>\"", ",", "x___", ",", "\"\<\\)\>\""}], 
             "]"}]}], "/;", 
           RowBox[{"StringFreeQ", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{"{", "x", "}"}], "]"}], ",", "\"\<\\!\>\""}], "]"}]}], 
          "\[RuleDelayed]", "a"}], ")"}]}], "]"}]}], ")"}]}]}], 
  ";"}]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.6463803836381116`*^9, 3.646380408118146*^9}, 
   3.647256285313308*^9, 3.6977369228805304`*^9, {3.697737103401785*^9, 
   3.697737103911786*^9}},
 ExpressionUUID -> "a80991d2-e070-4404-be14-004873b8d95b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Subscript", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "@", "a"}], ",", "\"\<_{\>\"", ",", 
    RowBox[{"Tex", "@", "b"}], ",", "\"\<}{}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Overscript", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\overset{\>\"", ",", 
    RowBox[{"Tex", "@", "b"}], ",", "\"\<}{\>\"", ",", 
    RowBox[{"Tex", "@", "a"}], ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Underscript", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\underset{\>\"", ",", 
    RowBox[{"Tex", "@", "b"}], ",", "\"\<}{\>\"", ",", 
    RowBox[{"Tex", "@", "a"}], ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Superscript", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "@", "a"}], ",", "\"\<^{\>\"", ",", 
    RowBox[{"Tex", "@", "b"}], ",", "\"\<}{}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"OverBar", "[", "a_", "]"}], "]"}], ":=", 
  RowBox[{"TexOverline", "[", 
   RowBox[{"Tex", "@", "a"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"OverTilde", "[", "a_", "]"}], "]"}], ":=", 
  RowBox[{"TexTilde", "[", 
   RowBox[{"Tex", "@", "a"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"OverHat", "[", "a_", "]"}], "]"}], ":=", 
  RowBox[{"TexHat", "[", 
   RowBox[{"Tex", "@", "a"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"HoldForm", "[", "x_String", "]"}], "]"}], ":=", 
   RowBox[{"Tex", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"HoldForm", "[", 
     RowBox[{
     "x_Subscript", "|", "x_Overscript", "|", "x_Underscript", "|", 
      "x_Superscript", "|", "x_OverBar", "|", "x_OverTilde", "|", 
      "x_OverHat"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"HoldForm", ",", 
      RowBox[{"Hold", "@", "x"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
    RowBox[{"Hold", "\[Rule]", "Tex"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"x", ":", 
     RowBox[{"HoldForm", "[", "___", "]"}]}], "]"}], ":=", 
   RowBox[{"xAct`TexAct`Private`Removetext", "@", 
    RowBox[{"ToString", "@", 
     RowBox[{"TeXForm", "@", "x"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexStyleBox", "[", 
    RowBox[{"a_", ",", "___"}], "]"}], ":=", 
   RowBox[{"Tex", "@", "a"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexOrnamentExpr", "[", "expr___", "]"}], ":=", 
   RowBox[{"StringJoin", "@@", 
    RowBox[{"(", 
     RowBox[{"Tex", "/@", 
      RowBox[{"{", "expr", "}"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TexOrnament", "[", "str_String", "]"}], ":=", 
   RowBox[{
    RowBox[{"TexStyleBox", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"#", ",", "StandardForm", ",", "HoldForm"}], "]"}], "&"}], "/@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{
         RowBox[{"StringDrop", "[", 
          RowBox[{
           RowBox[{"StringDrop", "[", 
            RowBox[{"str", ",", "12"}], "]"}], ",", 
           RowBox[{"-", "2"}]}], "]"}], ",", "\"\<,\>\"", ",", "2"}], "]"}]}],
       ")"}]}], "/;", 
    RowBox[{"StringMatchQ", "[", 
     RowBox[{"str", ",", 
      RowBox[{"StringExpression", "[", 
       RowBox[{
       "\"\<\\!\\(\\*StyleBox[\>\"", ",", "x___", ",", "\"\<]\\)\>\""}], 
       "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexOrnament", "[", "str_String", "]"}], ":=", 
   RowBox[{
    RowBox[{"TexOrnamentExpr", "@", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"str", ",", "StandardForm", ",", "HoldForm"}], "]"}]}], "/;", 
    RowBox[{"StringMatchQ", "[", 
     RowBox[{"str", ",", 
      RowBox[{"StringExpression", "[", 
       RowBox[{"\"\<\\!\\(\>\"", ",", "x___", ",", "\"\<\\)\>\""}], "]"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexOrnament", "[", "str_String", "]"}], ":=", 
   RowBox[{"Removetext", "@", 
    RowBox[{"ToString", "@", 
     RowBox[{"TeXForm", "@", "str"}]}]}]}], ";"}]}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.646380443538195*^9, 3.646380449078203*^9}, 
   3.6463809465688996`*^9, 3.6977335634519854`*^9, {3.697733663193126*^9, 
   3.6977336678041325`*^9}, {3.697733714325198*^9, 3.6977337279892178`*^9}, {
   3.697734736900443*^9, 3.6977347952235255`*^9}, {3.697734906866683*^9, 
   3.6977349131286917`*^9}, {3.6977353518773117`*^9, 
   3.6977353961573744`*^9}, {3.6977385861693363`*^9, 
   3.6977385864493365`*^9}, {3.6977386302283983`*^9, 
   3.6977386516734285`*^9}, {3.6977387013034987`*^9, 
   3.6977387098755107`*^9}, {3.6977387902726245`*^9, 
   3.6977388114276543`*^9}, {3.6977388500057087`*^9, 
   3.6977389196298065`*^9}, {3.6977428678843837`*^9, 3.69774292209446*^9}, {
   3.6977431804178305`*^9, 3.697743205512866*^9}, {3.697743305915008*^9, 
   3.697743311226015*^9}, {3.697743476019248*^9, 3.6977434765292487`*^9}, {
   3.6977436112694387`*^9, 3.6977436117594395`*^9}, {3.6978191618869143`*^9, 
   3.6978191994339676`*^9}, {3.6978199284899983`*^9, 
   3.6978199539560347`*^9}, {3.6978199871540813`*^9, 3.697819987424082*^9}, {
   3.697820331756568*^9, 3.6978203321565685`*^9}, 3.6978205885329304`*^9, {
   3.6978212606458797`*^9, 3.697821312067952*^9}, {3.697821346075*^9, 
   3.6978213488950043`*^9}, {3.697821736459551*^9, 3.697821736959552*^9}},
 ExpressionUUID -> "035ba010-f12a-4a43-a39d-f18f53a76841"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.4. Functions", "Subsection",ExpressionUUID->"3973b9e0-9e95-4479-aa8b-59ddf59fdc2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Functions", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Sin", "]"}], ":=", "\"\<\\\\sin\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Cos", "]"}], ":=", "\"\<\\\\cos\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Sec", "]"}], ":=", "\"\<\\\\sec\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Csc", "]"}], ":=", "\"\<\\\\csc\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Cot", "]"}], ":=", "\"\<\\\\cot\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Tan", "]"}], ":=", "\"\<\\\\tan\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Log", "]"}], ":=", "\"\<\\\\log\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Sinh", "]"}], ":=", "\"\<\\\\sinh\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Cosh", "]"}], ":=", "\"\<\\\\cosh\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Tanh", "]"}], ":=", "\"\<\\\\tanh\>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6057869383231277`*^9, 3.6057869467831397`*^9}, {
  3.616396846940979*^9, 3.616396858730995*^9}, {3.616396899191052*^9, 
  3.6163969265510902`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"d249f157-8a0c-4e92-badf-9d2b35a24e1c"],

Cell["\<\
Special display for trig functions with a simple tensor field as argument.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6190827784180603`*^9, 3.6190828130521564`*^9}, {
  3.619082885172258*^9, 
  3.6190829020422816`*^9}},ExpressionUUID->"f170c925-019e-4261-b861-\
ccf141c13e68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexTrigFuncs", "=", 
   RowBox[{"{", 
    RowBox[{
    "Sin", ",", "Cos", ",", "Tan", ",", "Cot", ",", "Sec", ",", "Csc", ",", 
     "Sinh", ",", "Cosh", ",", "Tanh"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"trig", ":", 
       RowBox[{"Alternatives", "@@", "$TexTrigFuncs"}]}], ")"}], "[", 
     RowBox[{
      RowBox[{"T_", "?", "xTensorQ"}], "[", "]"}], "]"}], "]"}], ":=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "trig", "]"}], ",", "\"\< \>\"", ",", 
       RowBox[{"Tex", "[", "T", "]"}]}], "]"}], ",", 
     RowBox[{"\"\< \\\\\>\"", "\[Rule]", "\"\<\\\\\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"trig", ":", 
         RowBox[{"Alternatives", "@@", "$TexTrigFuncs"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"T_", "?", "xTensorQ"}], "[", "]"}], "]"}], ",", 
      "i_Integer"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "trig", "]"}], ",", "\"\<^\>\"", ",", 
      RowBox[{"Tex", "[", "i", "]"}], ",", 
      RowBox[{"Tex", "[", "T", "]"}]}], "]"}], "/;", 
    RowBox[{"And", "[", 
     RowBox[{
      RowBox[{"i", ">", "1"}], ",", 
      RowBox[{"i", "<", "10"}]}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619082734807999*^9, 3.6190827370680027`*^9}, {
  3.619082840072195*^9, 3.6190828520322113`*^9}, {3.619083177226715*^9, 
  3.619083356506966*^9}, {3.619083389908013*^9, 3.6190834138420944`*^9}, {
  3.619084145531215*^9, 3.619084154571228*^9}, {3.619084253091366*^9, 
  3.619084258991374*^9}, {3.619084366625573*^9, 3.619084367135574*^9}, {
  3.6190844220256505`*^9, 3.6190844395156755`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"7904d897-0b18-44e9-a72a-40c54c31187e"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.5. Symbols", "Subsection",ExpressionUUID->"9c1d7be7-c3bf-46e3-bf3d-a32b43d500b7"],

Cell["Symbol formatting on the result of PrintAs:", "Text",ExpressionUUID->"761dcef7-0a70-455f-980d-fc39468cbb6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Symbols", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"including", " ", "constant"}], "-", 
      RowBox[{"symbols", " ", "and", " ", "parameters"}]}], ")"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", "symbol_Symbol", "]"}], ":=", 
    RowBox[{"Tex", "@", 
     RowBox[{"PrintAs", "[", "symbol", "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.583136000553097*^9, 3.5831360129083185`*^9}, 
   3.6463746344950624`*^9, 3.6463747067151637`*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"f3368a15-310a-4444-976c-a49524be9895"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.6. Indices", "Subsection",ExpressionUUID->"3bff6572-8474-47a4-b96d-89d32186e9c1"],

Cell["\<\
Add an extra space at the end of the string if we find a backslash. This is \
to avoid things like \[OpenCurlyDoubleQuote]\\alphab\[CloseCurlyDoubleQuote] \
instead of \[OpenCurlyDoubleQuote]\\alpha b\[CloseCurlyDoubleQuote] in the \
list of indices.\
\>", "Text",
 CellChangeTimes->{{3.5643839961071606`*^9, 
  3.5643840968521376`*^9}},ExpressionUUID->"a50bd4a9-5f2c-4b33-bc1b-\
c54097ca9d3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtraSpaceIfBackslash", "[", "str_String", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"StringFreeQ", "[", 
      RowBox[{"str", ",", "\"\<\\\\\>\""}], "]"}], ",", "str", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"str", ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[211]:=",ExpressionUUID->"84c63f21-15b6-4b70-bb16-c87432bac1f9"],

Cell["\<\
Those indices which are not recognized by neither UpIndexQ or DownIndexQ (for \
example patterns) are treated as symbols from the IndexForm:\
\>", "Text",
 CellChangeTimes->{{3.5831374324650116`*^9, 
  3.58313744851744*^9}},ExpressionUUID->"28956fc1-a9ea-4504-8e8c-\
848ba651b96e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexIndexForm", "[", "index_", "]"}], ":=", 
  RowBox[{"Tex", "[", 
   RowBox[{"IndexForm", "[", "index", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.583137441294627*^9},
 CellLabel->
  "In[212]:=",ExpressionUUID->"358830e1-96da-4f41-968a-2a11a00e7961"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"One", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexUpIndex", "[", "index_", "]"}], ":=", 
    RowBox[{"ExtraSpaceIfBackslash", "@", 
     RowBox[{"TexIndexForm", "@", "index"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.564384118161775*^9, 3.5643841191601768`*^9}, {
  3.5687125825738554`*^9, 3.568712608376301*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"b6f45586-45ae-4f42-bb55-c59c29c1eefb"],

Cell["Jose\[CloseCurlyQuote]s old code. Now deactivated.", "Text",ExpressionUUID->"1e03b6a7-4c6c-467e-a04c-cca5519c8d5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Lists", " ", "of", " ", "indices"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", "list_IndexList", "]"}], ":=", 
     RowBox[{"Apply", "[", 
      RowBox[{"StringJoin", ",", 
       RowBox[{"TexIndex", "/@", "list"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"list_IndexList", ",", "der_String"}], "]"}], ":=", 
     "\"\<TODO\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"IndexList", "[", "]"}], "]"}], ":=", 
     RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Individual", " ", "index"}], ",", " ", 
     RowBox[{
     "with", " ", "or", " ", "without", " ", "a", " ", "derivative"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"index_", "?", "UpIndexQ"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}^{\>\"", ",", 
       RowBox[{"TexUpIndex", "[", "index", "]"}], ",", "\"\<}\>\""}], "]"}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{"index_", "?", "DownIndexQ"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}_{\>\"", ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"ChangeIndex", "[", "index", "]"}], "]"}], ",", "\"\<}\>\""}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{
       RowBox[{"index_", "?", "UpIndexQ"}], ",", "der_String"}], "]"}], ":=", 
     
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}^{\>\"", ",", 
       RowBox[{"Tex", "@", "der"}], ",", 
       RowBox[{"TexUpIndex", "[", "index", "]"}], ",", "\"\<}\>\""}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", 
      RowBox[{
       RowBox[{"index_", "?", "DownIndexQ"}], ",", "der_String"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<{}_{\>\"", ",", 
       RowBox[{"Tex", "@", "der"}], ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"ChangeIndex", "[", "index", "]"}], "]"}], ",", "\"\<}\>\""}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexIndex", "[", "index_", "]"}], ":=", 
     RowBox[{"ToString", "[", "index", "]"}]}], ";"}]}]}]], "Input",
 Evaluatable->False,ExpressionUUID->"ac005b47-5e56-489f-8b7e-575073df3674"],

Cell["Thomas\[CloseCurlyQuote] newer code. Highly recursive:", "Text",ExpressionUUID->"cda374a8-213f-4b2e-9579-54e82fb27947"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexPrintInitialBracesQ", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initbraces", "[", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{"$TexPrintInitialBracesQ", ",", "\"\<{}\>\"", ",", "\"\<\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Main", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndices", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndices", "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"initbraces", "[", "]"}], ",", "\"\<^{\>\"", ",", 
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndices", "[", 
     RowBox[{
      RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"initbraces", "[", "]"}], ",", "\"\<_{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", 
       RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
      RowBox[{"TexIndicesFromDown", "[", "more", "]"}], ",", "\"\<}\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Previous", " ", "index", " ", "was", " ", "up"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromUp", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromUp", "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndicesFromUp", "[", 
     RowBox[{
      RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<}{}_{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", 
       RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
      RowBox[{"TexIndicesFromDown", "[", "more", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Previous", " ", "index", " ", "was", " ", "down"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromDown", "[", "]"}], ":=", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexIndicesFromDown", "[", 
    RowBox[{
     RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexUpIndex", "[", 
      RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
     RowBox[{"TexIndicesFromDown", "[", "more", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexIndicesFromDown", "[", 
     RowBox[{
      RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<}{}^{\>\"", ",", 
      RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
      RowBox[{"TexIndicesFromUp", "[", "more", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "With", " ", "derivative", " ", "indices", " ", "in", " ", "postfix", " ", 
    "notation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDIndices", "[", "post_", "]"}], "[", 
    RowBox[{
     RowBox[{"first_", "?", "UpIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<{}^{\>\"", ",", "post", ",", 
     RowBox[{"TexUpIndex", "[", "first", "]"}], ",", 
     RowBox[{"TexIndicesFromUp", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDIndices", "[", "post_", "]"}], "[", 
    RowBox[{
     RowBox[{"first_", "?", "DownIndexQ"}], ",", "more___"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<{}_{\>\"", ",", "post", ",", 
     RowBox[{"TexUpIndex", "[", 
      RowBox[{"ChangeIndex", "@", "first"}], "]"}], ",", 
     RowBox[{"TexIndicesFromDown", "[", "more", "]"}], ",", "\"\<}\>\""}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[214]:=",ExpressionUUID->"04014627-75dd-4ec4-a518-e79327f5b716"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.7. Operators", "Subsection",ExpressionUUID->"fdc34e0e-f9ac-412e-a125-6079b5b3dbda"],

Cell[TextData[{
 "Note that ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " expands -(a+b) into -a-b, but not -2(a+b). We also include the former \
case, because we could be formatting a held expression, for instance. \nWe \
also introduce OrderedPlus which is supposed to do mean the same as Plus, but \
it will not reorder the elements, but it will remove zeros.\nToOrderedPlus \
can be used to transform Plus to OrderedPlus sorted with respect to \
ToOrderedPlusSortFunc."
}], "Text",
 CellChangeTimes->{{3.616503934745057*^9, 3.6165040014151506`*^9}, {
  3.6165040713952484`*^9, 3.616504080035261*^9}, {3.679984831916006*^9, 
  3.679984913585802*^9}},ExpressionUUID->"b6c92e07-86b4-4b8b-b025-\
aba50a20af36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrderedPlus", "[", 
    RowBox[{"0", ",", "terms__"}], "]"}], ":=", 
   RowBox[{"OrderedPlus", "[", "terms", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderedPlus", "[", 
    RowBox[{"terms1__", ",", "0", ",", "terms2___"}], "]"}], ":=", 
   RowBox[{"OrderedPlus", "[", 
    RowBox[{"terms1", ",", "terms2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderedPlus", "[", "term_", "]"}], ":=", "term"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"OrderedPlus", "[", "expr___", "]"}], ",", "StandardForm"}], 
   "]"}], ":=", 
  RowBox[{"xAct`xTensor`Private`interpretbox", "[", 
   RowBox[{
    RowBox[{"OrderedPlus", "[", "expr", "]"}], ",", 
    RowBox[{"RowBox", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"xAct`xTensor`Private`MakeSequenceBox", "[", 
        RowBox[{
         RowBox[{"{", "expr", "}"}], ",", 
         RowBox[{"StyleBox", "[", 
          RowBox[{"\"\<+\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Blue"}]}], "]"}], ",", 
         "StandardForm"}], "]"}], "}"}], "]"}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61650400841516*^9, 3.6165041140753083`*^9}, {
  3.6799822007459335`*^9, 3.679982246876856*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"9df04169-d295-4134-ad05-f9f379038385"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ToOrderedPlusSortFunc", "[", "expr_", "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Plus", "@@", 
     RowBox[{"Exponent", "[", 
      RowBox[{"expr", ",", 
       RowBox[{"Variables", "[", "expr", "]"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToOrderedPlus", "=", 
   RowBox[{"expr_Plus", "\[RuleDelayed]", 
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"OrderedPlus", "@@", "expr"}], ",", "ToOrderedPlusSortFunc"}], 
     "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6799828087319465`*^9, 3.679982821763468*^9}, {
   3.6799846370663676`*^9, 3.679984649876496*^9}, 3.680499270894944*^9},
 CellLabel->
  "In[231]:=",ExpressionUUID->"6e483e84-69b2-41e7-9c26-00f7fe80a549"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Unary", " ", "minus"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Minus", "]"}], "=", "\"\<- \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "expr_Plus"}], "|", 
        RowBox[{"-", "expr_OrderedPlus"}]}], ")"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "Minus", "]"}], ",", 
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"-", "expr_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"TexOperator", "[", "Minus", "]"}], "<>", 
      RowBox[{"Tex", "[", "expr", "]"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6165041280253277`*^9, 3.6165041433953495`*^9}, {
  3.616505013008712*^9, 3.616505027528732*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"b83ae2b4-a767-4e0c-b41d-c19c68309c39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Product", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Times", "]"}], ":=", "\"\< \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", "1", "]"}], ":=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", 
      RowBox[{"-", "1"}], "]"}], ":=", 
     RowBox[{"TexOperator", "[", "Minus", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", 
      RowBox[{"(", 
       RowBox[{"expr_Plus", "|", "expr_OrderedPlus"}], ")"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexFactor", "[", "expr_", "]"}], ":=", 
     RowBox[{"Tex", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexOrdinaryTimes", "[", "expr_Times", "]"}], ":=", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"TexFactor", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", 
        RowBox[{"TexOperator", "[", "Times", "]"}]}], "]"}]}]}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{
     RowBox[{"TexOrdinaryTimes", "[", "expr_", "]"}], ":=", 
     RowBox[{"Tex", "@", "expr"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5594680046559944`*^9, 3.559468010740005*^9}, 
   3.559468052407678*^9, {3.616504166665382*^9, 3.616504173855392*^9}, {
   3.6165050438187547`*^9, 3.6165050480887604`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"d614bfcf-f099-4b1e-9f15-9c9c55ce8cc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexFractionAsFraction", "=", "True"}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[243]:=",ExpressionUUID->"55bab7b3-5847-4ff0-8036-3193d11482d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"numer", "=", 
        RowBox[{"Numerator", "[", "expr", "]"}]}], ",", 
       RowBox[{"denom", "=", 
        RowBox[{"Denominator", "[", "expr", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"NumberQ", "[", "denom", "]"}]}], ",", 
         "$TexFractionAsFraction"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TexFracExpression", "[", 
        RowBox[{"numer", ",", "denom", ",", "$TexFraction"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TexOrdinaryTimes", "[", "expr", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[244]:=",ExpressionUUID->"983c113a-a894-49d0-a5b9-dc113fbd4f40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Sum", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Plus", "]"}], ":=", "\"\< + \>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"(", 
       RowBox[{"expr_Plus", "|", "expr_OrderedPlus"}], ")"}], "]"}], ":=", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Tex", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", 
        RowBox[{"TexOperator", "[", "Plus", "]"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616504204669483*^9, 3.6165042419795356`*^9}, {
  3.616505060588778*^9, 3.6165050651887846`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"758940b9-9bb9-49f9-904c-3fd1936ef121"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Square", " ", "root", " ", "of", " ", "a", " ", "number"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"num_", "?", "NumberQ"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\sqrt{\>\"", ",", 
       RowBox[{"Tex", "[", "num", "]"}], ",", "\"\<}\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"num_", "?", "NumberQ"}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"$TexSmallFraction", ",", "\"\<{1}{\\\\sqrt{\>\"", ",", 
       RowBox[{"Tex", "[", "num", "]"}], ",", "\"\<}}\>\""}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[247]:=",ExpressionUUID->"3a9bda42-7901-4199-9527-1e92b308df08"],

Cell["\<\
Special code to include square roots of numbers in the fractions.\
\>", "Text",ExpressionUUID->"08843d05-9bd7-476d-aafa-0a59d29ed0e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", "expr_Times", "]"}], ":=", 
   RowBox[{"Times", "@@", 
    RowBox[{"(", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"List", "@@", "expr"}], ",", "NumberQ"}], "]"}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", 
    RowBox[{"num_", "?", "NumberQ"}], "]"}], ":=", "num"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractNumericalFactor", "[", "___", "]"}], ":=", "1"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[249]:=",ExpressionUUID->"9ae5b557-ef7a-4552-8071-466ae4fa0ddb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Other", " ", "square", " ", "roots"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"expr", ":", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"num_", "?", "NumberQ"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "]"}], ",", "___"}], "]"}]}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numfactor", "=", 
         RowBox[{"ExtractNumericalFactor", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"numer", "=", 
         RowBox[{"Numerator", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"denom1", "=", 
         RowBox[{"Denominator", "[", 
          RowBox[{"expr", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Or", "[", 
         RowBox[{
          RowBox[{"!", "$TexFractionAsFraction"}], ",", 
          RowBox[{"NumberQ", "[", "denom1", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"TexFracExpression", "[", 
           RowBox[{
            RowBox[{"Numerator", "[", "numfactor", "]"}], ",", 
            RowBox[{
             RowBox[{"Denominator", "[", "numfactor", "]"}], 
             RowBox[{"Sqrt", "[", "num", "]"}]}], ",", "$TexSmallFraction"}], 
           "]"}], ",", 
          RowBox[{"TexFactor", "[", 
           RowBox[{"expr", " ", 
            RowBox[{
             RowBox[{"Sqrt", "[", "num", "]"}], "/", "numfactor"}]}], "]"}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TexFracExpression", "[", 
         RowBox[{"numer", ",", 
          RowBox[{"denom1", " ", 
           RowBox[{"Sqrt", "[", "num", "]"}]}], ",", "$TexFraction"}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[252]:=",ExpressionUUID->"d67e162d-f7c0-457d-9595-9254dac16c97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Power", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Power", "]"}], ":=", "\"\<^\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", 
      RowBox[{"x", ":", 
       RowBox[{"(", 
        RowBox[{"_Symbol", "|", "_Integer", "|", 
         RowBox[{
          RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}]}], ")"}]}], "]"}],
      ":=", 
     RowBox[{"Tex", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", 
      RowBox[{"x", ":", 
       RowBox[{"Scalar", "[", "expr_", "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Tex", "[", "x", "]"}], "/;", "$TexScalarParentheses"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexBase", "[", "x_", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "x", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexExponent", "[", "x_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$TexSmallFraction", "=", "$TexSmallFractionExponent"}], 
        "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tex", "=", 
           RowBox[{"Tex", "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", "tex", "]"}], "===", "1"}], ",", 
           "tex", ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<{\>\"", ",", "tex", ",", "\"\<}\>\""}], "]"}]}], 
          "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Tex", "[", 
       RowBox[{"Power", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\frac{1}{\>\"", ",", 
         RowBox[{"Tex", "[", "x", "]"}], ",", "\"\<}\>\""}], "]"}], "/;", 
       RowBox[{
        RowBox[{"ByteCount", "[", "x", "]"}], "<", "200"}]}]}], ";"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"TexFracExpression", "[", 
       RowBox[{"1", ",", "x", ",", "$TexFraction"}], "]"}], "/;", 
      "$TexFractionAsFraction"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", "n_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexBase", "[", "x", "]"}], ",", 
       RowBox[{"TexOperator", "[", "Power", "]"}], ",", 
       RowBox[{"TexExponent", "[", "n", "]"}]}], "]"}]}], ";"}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5806310177668314`*^9, 3.580631044115278*^9}, {
  3.5831348611260953`*^9, 3.583134950935453*^9}, {3.5831349858639145`*^9, 
  3.583134996565533*^9}, {3.6057870236332474`*^9, 3.605787033513261*^9}, {
  3.6057870673133082`*^9, 3.6057871173333783`*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"1b079d80-166f-4246-97b6-8b8beb7a56c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Abs", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "x_", "]"}], ",", "n_"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<|\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "x", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<|\>\"", "]"}], ",", 
       RowBox[{"TexOperator", "[", "Power", "]"}], ",", 
       RowBox[{"TexExponent", "[", "n", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Abs", "[", "x_", "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOpen", "[", "\"\<|\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "x", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<|\>\"", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6057871411334114`*^9, 3.6057871451434174`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"5f693c2e-c053-42cb-af53-4b15394dafe8"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.8. Basis objects", "Subsection",
 CellChangeTimes->{
  3.583148454082223*^9},ExpressionUUID->"ccb50393-d7fb-428d-a398-\
10db3c74e6d5"],

Cell[BoxData[
 RowBox[{"(*", " ", "Basis", " ", "*)"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[262]:=",ExpressionUUID->"1e7ced2b-fce5-4896-87f4-08cf5e16e5ca"],

Cell["\<\
This has to come before the general tensor code because we might want to \
change the typesetting for a basis object.\
\>", "Text",
 CellChangeTimes->{{3.583148658941783*^9, 
  3.5831487177070856`*^9}},ExpressionUUID->"acd0da8d-4b7c-4b39-8f8e-\
6faf901c33fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Basis", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"TexBasis", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831484888078833`*^9, 3.5831484922710896`*^9}, {
  3.5831485666052203`*^9, 3.583148598756877*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"a7d97eab-9e04-45f0-bf7f-ae5821ad29c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexBasis", "[", "inds__", "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", "Basis", "]"}], ",", 
     RowBox[{"TexIndices", "[", "inds", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831486042324867`*^9, 3.5831486370861444`*^9}, {
  3.583148744726333*^9, 3.5831487495311413`*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"087ad6f0-0a0d-4df4-a6b2-4c71241d439a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_Integer", ",", 
       RowBox[{"basis_", "?", "BasisQ"}]}], "}"}], ",", "texstring_String"}], 
    "]"}], ":=", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexBasis", "[", 
      RowBox[{"ind_", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "basis"}], "}"}]}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"texstring", ",", 
       RowBox[{"TexIndices", "[", "ind", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{"{", 
     RowBox[{"i_Integer", ",", 
      RowBox[{"basis_", "?", "BasisQ"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Unset", "[", 
    RowBox[{"TexBasis", "[", 
     RowBox[{"ind_", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "basis"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_Integer", ",", 
       RowBox[{"-", 
        RowBox[{"basis_", "?", "BasisQ"}]}]}], "}"}], ",", 
     "texstring_String"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexBasis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "basis"}]}], "}"}], ",", "ind_"}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"texstring", ",", 
       RowBox[{"TexIndices", "[", "ind", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831492595092382`*^9, 3.5831493793018484`*^9}, {
   3.5831494248539286`*^9, 3.58314948842404*^9}, 3.5831500002931395`*^9},
 CellLabel->
  "In[265]:=",ExpressionUUID->"ac8f0fc4-1b24-499a-8a81-902ffd2465ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FormatTexBasis", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", 
      RowBox[{"{", 
       RowBox[{"i_Integer", ",", "basis_"}], "}"}], "]"}], ",", 
     "texstring_String"}], "]"}], ":=", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"TexCovDPrefix", "[", 
      RowBox[{"covd", ",", 
       RowBox[{"IndexList", "[", 
        RowBox[{"{", 
         RowBox[{"i", ",", "basis"}], "}"}], "]"}]}], "]"}], ",", 
     "texstring"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormatTexBasis", "[", 
   RowBox[{
    RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", 
    RowBox[{"{", 
     RowBox[{"i_Integer", ",", "basis_"}], "}"}], "]"}], "]"}], ":=", 
  RowBox[{"Unset", "[", 
   RowBox[{"TexCovDPrefix", "[", 
    RowBox[{"covd", ",", 
     RowBox[{"IndexList", "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "basis"}], "}"}], "]"}]}], "]"}], "]"}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5831495227285004`*^9, 3.583149548796146*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"086ccb24-c9e6-4f59-a692-d2cec58d9712"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.9. Tensors", "Subsection",
 CellChangeTimes->{
  3.5831484573738284`*^9},ExpressionUUID->"b9c1bd29-032d-433e-9323-\
b16b38a4db32"],

Cell["Jose\[CloseCurlyQuote]s old code on tensors:", "Text",ExpressionUUID->"7ab4b7c3-4e82-44e1-90d8-1ce1d84d5269"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Tensors", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", "indices___", "]"}], "]"}], 
     ":=", 
     RowBox[{"TexTensorCombine", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "tensor", "]"}], ",", 
       RowBox[{"TexIndex", "/@", 
        RowBox[{"IndexList", "[", "indices", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexTensorCombine", "[", 
      RowBox[{"tensor_", ",", 
       RowBox[{"IndexList", "[", "indices___", "]"}]}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"tensor", ",", "indices"}], "]"}]}], ";"}]}]}]], "Input",
 Evaluatable->False,ExpressionUUID->"c0cdd6aa-0113-42f9-9692-0d21a597e2ca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"New symbol created: \"\>", 
   "\[InvisibleSpace]", "\<\"TexTensorCombine\"\>", 
   "\[InvisibleSpace]", "\<\", Context: \"\>", 
   "\[InvisibleSpace]", "\<\"xAct`xTensor`Private`\"\>"}],
  SequenceForm[
  "New symbol created: ", "TexTensorCombine", ", Context: ", 
   "xAct`xTensor`Private`"],
  Editable->False]], "Print",ExpressionUUID->"a0ca6f70-552d-418e-a550-\
0b6a2ef103fd"]
}, Open  ]],

Cell["Thomas\[CloseCurlyQuote] code, producing less parenthesization:", "Text",ExpressionUUID->"fdd7276f-7982-401c-ad70-c2769580659f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Tensors", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"tensor_", "?", "xTensorQ"}], "[", "indices___", "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "tensor", "]"}], ",", 
      RowBox[{"TexIndices", "[", "indices", "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619628741889248*^9, 3.6196287434992495`*^9}, {
  3.6196292342800336`*^9, 3.61962927462009*^9}, {3.6196293634602146`*^9, 
  3.6196293644102154`*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"693a37ae-7363-45e3-8bc8-4a91a74798b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.10. Scalar functions", "Subsection",
 CellChangeTimes->{{3.5831484590118313`*^9, 
  3.5831484595266323`*^9}},ExpressionUUID->"db4503e9-5519-442d-b601-\
6f012da8ea7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Derivatives", " ", "of", " ", "scalar", " ", "functions"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"deriv", "[", 
      RowBox[{"var_", ",", "1"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"deriv", "[", 
      RowBox[{"var_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial^{\>\"", "<>", 
      RowBox[{"Tex", "[", "n", "]"}], "<>", "\"\<}\>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"vars_List", ",", "ders_List"}], "]"}], ":=", 
     RowBox[{"Inner", "[", 
      RowBox[{"withrespectto", ",", "vars", ",", "ders", ",", "StringJoin"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "0"}], "]"}], ":=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "1"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"withrespectto", "[", 
      RowBox[{"var_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial \>\"", "<>", 
      RowBox[{"Tex", "[", "var", "]"}], "<>", "\"\<^{\>\"", "<>", 
      RowBox[{"Tex", "[", "n", "]"}], "<>", "\"\<}\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "ders__", "]"}], "[", 
        RowBox[{"f_", "?", "ScalarFunctionQ"}], "]"}], "[", "vars__", "]"}], 
      "]"}], ":=", 
     RowBox[{"\"\<\\\\frac{\>\"", "<>", 
      RowBox[{"deriv", "[", 
       RowBox[{
        RowBox[{"f", "[", "vars", "]"}], ",", 
        RowBox[{"Plus", "[", "ders", "]"}]}], "]"}], "<>", "\"\<}{\>\"", "<>", 
      RowBox[{"withrespectto", "[", 
       RowBox[{
        RowBox[{"{", "vars", "}"}], ",", 
        RowBox[{"{", "ders", "}"}]}], "]"}], "<>", "\"\<}\>\""}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[271]:=",ExpressionUUID->"1448c191-c1f1-4dff-bd34-d38579d904a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial", "[", "n_Symbol", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial", "[", "n_", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial2", "[", "n_Symbol", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<!!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Factorial2", "[", "n_", "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<!!\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Pochhammer", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}], ",", "\"\<_{\>\"", ",", 
    RowBox[{"Tex", "[", "k", "]"}], ",", "\"\<}\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"Binomial", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<\\\\binom{\>\"", ",", 
    RowBox[{"Tex", "[", "n", "]"}], ",", "\"\<}{\>\"", ",", 
    RowBox[{"Tex", "[", "k", "]"}], ",", "\"\<}\>\""}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5954310761892896`*^9, 3.595431081729297*^9}, {
  3.5954313887097273`*^9, 3.5954314408708*^9}, {3.5955779884494324`*^9, 
  3.595578109859602*^9}, {3.595578219019755*^9, 3.5955782280997677`*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"864e8efd-8eee-411b-8e17-4d270306936d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Other", " ", "scalar", " ", "functions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "args__", "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Tex", "[", "f", "]"}], ",", 
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"InsertComma", "[", 
         RowBox[{"Tex", "/@", 
          RowBox[{"{", "args", "}"}]}], "]"}]}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InsertComma", "[", "arguments_List", "]"}], ":=", 
     RowBox[{"Insert", "[", 
      RowBox[{"arguments", ",", "\"\<, \>\"", ",", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"2", ",", 
          RowBox[{"Length", "[", "arguments", "]"}]}], "]"}]}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[284]:=",ExpressionUUID->"06199b68-0459-47a0-89a0-d09fda83c9fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.11. Inert heads", "Subsection",
 CellChangeTimes->{
  3.583148461710636*^9},ExpressionUUID->"a1dc0b28-d5eb-46cf-aad2-\
71a49a8a2f53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Innert", " ", "heads"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"ih_", "?", "InertHeadQ"}], "[", 
      RowBox[{"expr_", ",", "z___"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"Tex", "[", "ih", "]"}], ",", 
      RowBox[{"TexOpen", "[", "\"\<[\>\"", "]"}], ",", 
      RowBox[{"Tex", "[", "expr", "]"}], ",", 
      RowBox[{"TexClose", "[", "\"\<]\>\"", "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellLabel->
  "In[286]:=",ExpressionUUID->"93ee7daf-57f5-404d-9090-1842282b7ecb"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.12. Scalar expressions", "Subsection",
 CellChangeTimes->{
  3.583148463192639*^9},ExpressionUUID->"e8d5844b-cb51-4d9f-a413-\
8e5497b77f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Remove", " ", "the", " ", "Scalar", " ", "head"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$TexScalarParentheses", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Scalar", "[", "expr_", "]"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{"$TexScalarParentheses", ",", "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
         RowBox[{"Tex", "[", "expr", "]"}], ",", 
         RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Tex", "[", "expr", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[287]:=",ExpressionUUID->"d95c42cb-715e-41dd-8763-5b8adf2eb385"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.13. Covariant derivatives", "Subsection",
 CellChangeTimes->{
  3.583148465033442*^9},ExpressionUUID->"608a8787-fec7-49bf-9558-\
db6e01a084c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Covariant", " ", "derivatives"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"covd_Symbol", "?", "CovDQ"}], "[", "inds__", "]"}], "[", 
       "expr_", "]"}], "]"}], ":=", 
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{"covd", ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"IndexList", "[", "inds", "]"}], ",", "$CovDFormat"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{
      "covd_", ",", "exprstring_String", ",", "list_IndexList", ",", 
       "\"\<Prefix\>\""}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexCovDPrefix", "[", 
        RowBox[{"covd", ",", "list"}], "]"}], ",", "exprstring"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDPrefix", "[", 
      RowBox[{"covd_", ",", "list_IndexList"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"TexCovD", "[", "covd", "]"}]}], ",", 
       RowBox[{"TexIndices", "@@", "list"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovDCombine", "[", 
      RowBox[{
      "covd_", ",", "exprstring_String", ",", "list_IndexList", ",", 
       "\"\<Postfix\>\""}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"exprstring", ",", 
       RowBox[{
        RowBox[{"TexCovDIndices", "[", 
         RowBox[{"First", "@", 
          RowBox[{"TexCovD", "@", "covd"}]}], "]"}], "@@", "list"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "$CovDFormat", " ", "only", " ", "gives", " ", 
      "one", " ", "string"}], ",", " ", 
     RowBox[{"use", " ", "it", " ", "for", " ", "both", " ", 
      RowBox[{"cases", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexCovD", "[", "covd_", "]"}], ":=", 
     RowBox[{"Tex", "/@", 
      RowBox[{"SymbolOfCovD", "[", "covd", "]"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5831350205895753`*^9, 3.5831350985585127`*^9}, {
   3.583135714339394*^9, 3.583135719565403*^9}, 3.583136176427806*^9, {
   3.583146255318761*^9, 3.5831463017756424`*^9}, {3.5831463427725143`*^9, 
   3.5831464231750555`*^9}, 3.5831466103753843`*^9, {3.583146716502371*^9, 
   3.5831467772644777`*^9}, {3.58314680738813*^9, 3.583146811990138*^9}, {
   3.583147184504193*^9, 3.583147288415975*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"af38f09b-6f3b-4c1c-aa48-059e1bb554b6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"{", "a_", "}"}], ",", "b___"}], "]"}], ":=", 
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "a"}], "}"}], ",", "b"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"CovD", "[", 
      RowBox[{"expr_", ",", "ders___", ",", 
       RowBox[{
        RowBox[{"der_Symbol", "?", "CovDQ"}], "[", "inds__", "]"}]}], "]"}], 
     "]"}], ":=", 
    RowBox[{"TexCovDCombine", "[", 
     RowBox[{
      RowBox[{"TexCovD", "[", "der", "]"}], ",", 
      RowBox[{"Tex", "[", "expr", "]"}], ",", 
      RowBox[{"IndexList", "[", "inds", "]"}], ",", "$CovDFormat"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.5831462782664013`*^9, 3.5831462978288355`*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"e5b05be7-c00e-4f9a-a0e7-023628513ff2"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.14. Lie derivatives and brackets", "Subsection",
 CellChangeTimes->{
  3.583148466609045*^9, {3.6205422433640704`*^9, 
   3.6205422474740763`*^9}},ExpressionUUID->"e4652de8-278d-4d22-81f6-\
1fc50c10b296"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Lie", " ", "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"LieD", "[", 
       RowBox[{"n_Symbol", "[", "_", "]"}], "]"}], "[", "expr_", "]"}], "]"}],
     ":=", 
    RowBox[{"\"\<\\\\mathcal{L}_\>\"", "<>", 
     RowBox[{"Tex", "[", "n", "]"}], "<>", "\"\< \>\"", "<>", 
     RowBox[{"Tex", "[", "expr", "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6407639077970543`*^9, 3.640763911047058*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"bda37ad5-b0c0-4deb-bfac-8d39b54cc112"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Brackets", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Bracket", "[", 
      RowBox[{"expr1_", ",", "expr2_"}], "]"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"TexOpen", "[", "\"\<[\>\"", "]"}], ",", 
      RowBox[{"Tex", "[", "expr1", "]"}], ",", "\"\<, \>\"", ",", " ", 
      RowBox[{"Tex", "[", "expr2", "]"}], ",", 
      RowBox[{"TexClose", "[", "\"\<]\>\"", "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.620542260424094*^9, 3.6205423774442577`*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"32aa9a74-bc5c-42f2-9b89-e3bec221d2c1"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.15. Parametric derivatives", "Subsection",
 CellChangeTimes->{
  3.583148468949049*^9},ExpressionUUID->"7f6b9329-1025-4dca-9e01-\
95b276471b25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Parametric", " ", "derivative"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexParamD", "[", 
      RowBox[{"{", "ps_", "}"}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial_\>\"", "<>", 
      RowBox[{"Tex", "[", "ps", "]"}], "<>", "\"\< \>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TexParamD", "[", 
      RowBox[{"ps", ":", 
       RowBox[{"{", "__", "}"}]}], "]"}], ":=", 
     RowBox[{"\"\<\\\\partial_\>\"", "<>", 
      RowBox[{"Tex", "[", 
       RowBox[{"First", "[", "ps", "]"}], "]"}], "<>", "\"\<^{\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"Length", "[", "ps", "]"}], "]"}], "<>", "\"\<} \>\""}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{
       RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$ParamDFormat", "==", "\"\<Postfix\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"Tex", "[", "expr", "]"}], ",", "\"\<{}_{,\>\"", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"Tex", "/@", 
            RowBox[{"{", "ps", "}"}]}], ")"}]}], ",", "\"\<}\>\""}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"StringJoin", ",", 
          RowBox[{"TexParamD", "/@", 
           RowBox[{"Split", "@", 
            RowBox[{"Sort", "[", 
             RowBox[{"{", "ps", "}"}], "]"}]}]}]}], "]"}], "<>", 
        RowBox[{"Tex", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Tex", "[", 
       RowBox[{
        RowBox[{"ParamD", "[", "ps__", "]"}], "[", "expr_", "]"}], "]"}], ":=", \

      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"StringJoin", ",", 
         RowBox[{"TexParamD", "/@", 
          RowBox[{"Split", "@", 
           RowBox[{"Sort", "[", "ps", "]"}]}]}]}], "]"}], "<>", 
       RowBox[{"TexOpen", "[", "\"\<[\>\"", "]"}], "<>", 
       RowBox[{"Tex", "[", "expr", "]"}], "<>", 
       RowBox[{"TexClose", "[", "\"\<]\>\"", "]"}]}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[297]:=",ExpressionUUID->"6d9c445a-b1e5-4641-83fe-ede0c88499bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.16. Equalities and inequalities", "Subsection",
 CellChangeTimes->{
  3.5831484708834524`*^9, {3.5955814809293222`*^9, 3.5955814858993287`*^9}, {
   3.595581619059515*^9, 
   3.5955816199895163`*^9}},ExpressionUUID->"e302008e-6ac4-4e41-9709-\
84f682f298a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Equal", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "expr_Equal", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Tex", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", "\"\< = \>\""}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Equal", "]"}], ":=", "\"\< = \>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.5955815034193535`*^9}, {
  3.6045951807047195`*^9, 3.6045952122747636`*^9}, {3.6799834197272587`*^9, 
  3.6799834394271297`*^9}, {3.679983474347828*^9, 3.6799834762078657`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"62d27083-30cc-43bc-bea9-70f27b2911a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Less", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "expr_Less", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Tex", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", "\"\< < \>\""}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Less", "]"}], ":=", "\"\< < \>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.595581516679372*^9}, {
  3.60459521669477*^9, 3.6045952291947875`*^9}, {3.679983496158264*^9, 
  3.679983504568433*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"ef0aeec3-a116-4956-8855-2f14318ac1f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "LessEqual", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "expr_LessEqual", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Tex", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", "\"\< \\\\leq \>\""}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "LessEqual", "]"}], ":=", "\"\< \\\\leq \>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.595581516679372*^9}, {
  3.5955815554794264`*^9, 3.595581563029437*^9}, {3.6045952337547936`*^9, 
  3.6045952552448235`*^9}, {3.679983506798477*^9, 3.679983519378729*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"b10ae447-219e-445c-894c-43bb5691445b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Less", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "expr_Greater", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Tex", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", "\"\< > \>\""}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "Greater", "]"}], ":=", "\"\< > \>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.595581516679372*^9}, {
  3.595581585799469*^9, 3.595581591359476*^9}, {3.6045952599348307`*^9, 
  3.6045952743748503`*^9}, {3.67998352093876*^9, 3.6799835348190374`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"1081df14-4808-46f5-abb8-4ffeb2a5d0a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "LessEqual", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "expr_GreaterEqual", "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Tex", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", "\"\< \\\\geq \>\""}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "GreaterEqual", "]"}], ":=", "\"\< \\\\geq \>\""}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5955814987393465`*^9, 3.595581516679372*^9}, {
  3.5955815554794264`*^9, 3.595581563029437*^9}, {3.595581595839483*^9, 
  3.5955816066794977`*^9}, {3.604595277994856*^9, 3.6045952966048813`*^9}, {
  3.6799835370890827`*^9, 3.679983556549472*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"c98a1307-09f9-4431-9c1c-88390a39e499"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.17. The TexPrint function", "Subsection",
 ExpressionUUID -> "e2b7e8ac-5584-426a-80b5-4a9dab921c4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexFixExtraRules", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[310]:=",ExpressionUUID->"1d830e06-524f-4287-b6a0-4696ceb9db6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", "that", " ", "we", " ", "remove", " ", "the", " ", 
    RowBox[{"dollars", "!"}], " ", "This", " ", "is", " ", "because", " ", 
    "\[Mu]3", " ", "is", " ", "converted", " ", "into", " ", 
    RowBox[{"$", "\\", "mu$3"}], " ", "for", " ", "instance"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexFix", "[", "string_String", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringReplace", "[", 
       RowBox[{"string", ",", 
        RowBox[{"\"\<$\>\"", "->", "\"\<\>\""}]}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<+-\>\"", "\[Rule]", "\"\<-\>\""}], ",", 
          RowBox[{"\"\<+ -\>\"", "\[Rule]", "\"\<- \>\""}], ",", 
          RowBox[{"\"\< _\>\"", "->", "\"\<_\>\""}], ",", 
          RowBox[{"\"\< ^\>\"", "->", "\"\<^\>\""}], ",", 
          RowBox[{"\"\<  \>\"", "->", "\"\< \>\""}], ",", 
          RowBox[{"\"\<   \>\"", "->", "\"\< \>\""}], ",", " ", 
          RowBox[{"\"\< }\>\"", "\[Rule]", "\"\<}\>\""}], ",", " ", 
          RowBox[{"\"\<  }\>\"", "\[Rule]", "\"\<}\>\""}], ",", " ", 
          RowBox[{"\"\< )\>\"", "\[Rule]", "\"\<)\>\""}], ",", " ", 
          RowBox[{"\"\<  )\>\"", "\[Rule]", "\"\<)\>\""}]}], "}"}], ",", 
        "$TexFixExtraRules"}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.564383847298499*^9, 3.5643838565961156`*^9}, {
  3.5643843380753613`*^9, 3.5643843429893703`*^9}, {3.5643850301715765`*^9, 
  3.5643850442116013`*^9}, {3.728803899813012*^9, 3.728803934133975*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"7aa86cf1-727d-4a96-9e49-8a568d5abea1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Main", ".", " ", "Public"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TexPrint", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"initlevel_:", "Automatic"}]}], "]"}], ":=", 
    RowBox[{"TexFix", "@", 
     RowBox[{"TexParenthesis", "[", 
      RowBox[{
       RowBox[{"ScreenDollarIndices", "[", "expr", "]"}], ",", "initlevel"}], 
      "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[312]:=",ExpressionUUID->"a8ed8c09-28cb-4c6f-9561-c81be43c5ff7"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.18. Matrices", "Subsection",
 CellChangeTimes->{{3.559468159345866*^9, 3.5594681704062853`*^9}, 
   3.559468557988966*^9},ExpressionUUID->"09942665-d371-47be-bfd7-\
761cc84c136e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexMatrixParen", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexMatrix", "[", 
   RowBox[{
    RowBox[{"M_", "?", "MatrixQ"}], ",", 
    RowBox[{"F_:", " ", "Tex"}]}], "]"}], ":=", 
  RowBox[{"TexFix", "@", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rows", "=", 
        RowBox[{"Length", "[", "M", "]"}]}], ",", 
       RowBox[{"cols", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"First", "@", "M"}]}]}]}], "}"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\left\>\"", ",", 
       RowBox[{"$TexMatrixParen", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\\\\begin{array}{\>\"", ",", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"\"\<c\>\"", ",", 
          RowBox[{"{", "cols", "}"}]}], "]"}]}], ",", "\"\<}\\n\>\"", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{
               RowBox[{"F", "/@", "#"}], ",", "\"\< & \>\""}], "]"}], "]"}], 
            "&"}], "/@", "M"}], ",", "\"\<\\\\\\\\\\n\>\""}], "]"}], "]"}], 
       ",", "\"\<\\n\\\\end{array}\\\\right\>\"", ",", 
       RowBox[{"$TexMatrixParen", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559468186645914*^9, 3.559468186645914*^9}, {
   3.5594686726803675`*^9, 3.5594686744587708`*^9}, {3.5594688200392265`*^9, 
   3.5594688221920304`*^9}, {3.5594688679937105`*^9, 3.559468877540928*^9}, 
   3.5594695668437386`*^9, {3.6407639275970817`*^9, 3.640763931237087*^9}, {
   3.679983584730036*^9, 3.679983647151284*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"851ad325-571f-413e-91be-b287fc062478"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.19. Hold", "Subsection",
 CellChangeTimes->{{3.5915971338389783`*^9, 
  3.591597147628998*^9}},ExpressionUUID->"188cac56-ec18-434b-a469-\
b04c4d614c83"],

Cell["\<\
Hold can be used to stop a derivative to use the Leibniz rule, and it can \
also stop other automatic rules to be applied. Therefore, it might be a \
useful tool for typesetting too. We just typeset it as a parentesis.\
\>", "Text",
 CellChangeTimes->{{3.591597295079204*^9, 3.591597376519318*^9}, {
  3.591597408584703*^9, 3.5915975180315533`*^9}, {3.591597585772648*^9, 
  3.591597611092684*^9}},ExpressionUUID->"01451bb6-586e-4343-a90b-\
b12d1a6a825a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"Hold", "[", "expr_", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5915972372791233`*^9, 3.591597252769145*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"e1bd6282-181f-48f3-a974-a2c5566e6f3e"]
}, Closed]],

Cell[CellGroupData[{

Cell["3.20. SeriesData", "Subsection",
 CellChangeTimes->{{3.5915971338389783`*^9, 3.591597147628998*^9}, {
  3.6045914295767665`*^9, 
  3.6045914337767725`*^9}},ExpressionUUID->"a989b3bd-be46-4d84-bb90-\
9d7f95f83612"],

Cell["Older (deactivated)", "Text",
 CellChangeTimes->{{3.616502316647503*^9, 3.616502319947507*^9}, {
  3.6165024442217293`*^9, 
  3.6165024483217354`*^9}},ExpressionUUID->"f890ad87-18d8-4b13-bd48-\
7e877b18bf52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"sdata", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"DirectedInfinity", "[", "1", "]"}], ",", 
       RowBox[{"{", "coeffs___", "}"}], ",", "nmin_Integer", ",", 
       "nmax_Integer", ",", "den_"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Normal", "@", "sdata"}], "]"}], ",", 
    "\"\< + \\\\mathcal{O}\>\"", ",", 
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"(", "x", ")"}], "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "nmax"}], "/", "den"}], ")"}]}], "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.616396030386691*^9, 3.616396039056703*^9}, {
  3.6163967364108243`*^9, 3.616396741800832*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"907983a4-fde5-48f9-9a57-f97e0ba5ccce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"sdata", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"x_", ",", "x0_", ",", 
       RowBox[{"{", "coeffs___", "}"}], ",", "nmin_Integer", ",", 
       "nmax_Integer", ",", "den_"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"Tex", "[", 
     RowBox[{"Normal", "@", "sdata"}], "]"}], ",", 
    "\"\< + \\\\mathcal{O}\>\"", ",", 
    RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
    RowBox[{"Tex", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "x0"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"nmax", "/", "den"}], ")"}]}], "]"}], ",", 
    RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6045915248268995`*^9, 3.6045915353569145`*^9}, {
  3.604595837233989*^9, 3.604595839003991*^9}, {3.6163960149566693`*^9, 
  3.616396018356674*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"de26f310-2738-477b-90fe-38aa27661665"],

Cell["New 2014-08-08", "Text",
 CellChangeTimes->{{3.616502311437495*^9, 3.616502313807499*^9}, {
  3.6165060253073215`*^9, 
  3.6165060294573274`*^9}},ExpressionUUID->"b65befdb-6ea0-4107-8334-\
2172b837acbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"sd", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"DirectedInfinity", "[", "1", "]"}], ",", "coefflist_List", 
       ",", "nmin_", ",", "nmax_", ",", "den_"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Tex", "[", 
   RowBox[{"OrderedPlus", "@@", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"coefflist", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "*", 
           RowBox[{"x", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"#", "-", "1", "+", "nmin"}], ")"}]}], "/", "den"}], 
             ")"}]}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "coefflist"}]}]}], ")"}], ",", 
      RowBox[{"TexString", "@", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\mathcal{O}\>\"", ",", 
         RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
         RowBox[{"Tex", "[", 
          RowBox[{
           RowBox[{"(", "x", ")"}], "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "nmax"}], "/", "den"}], ")"}]}], "]"}], ",", 
         RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616502205667347*^9, 3.616502249337408*^9}, 
   3.616502482691783*^9, {3.6165026768620553`*^9, 3.6165026869040956`*^9}, {
   3.616502840146332*^9, 3.616502850846347*^9}, {3.616503202940888*^9, 
   3.616503203500889*^9}, {3.616503253810959*^9, 3.616503263850973*^9}, {
   3.6165035310363955`*^9, 3.616503539396407*^9}, {3.6165044030497613`*^9, 
   3.6165044641598463`*^9}, {3.616504519883973*^9, 3.6165045272239833`*^9}, {
   3.616504599444084*^9, 3.616504715704247*^9}, {3.616505358883244*^9, 
   3.6165053659932537`*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"55209a21-8d86-4930-83b2-b998c6fc6556"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{"sd", ":", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{
      "x_", ",", "x0_", ",", "coefflist_List", ",", "nmin_", ",", "nmax_", 
       ",", "den_"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Tex", "[", 
   RowBox[{"OrderedPlus", "@@", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"coefflist", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"OrderedPlus", "[", 
             RowBox[{"x", ",", 
              RowBox[{"-", "x0"}]}], "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "1", "+", "nmin"}], ")"}], "/", "den"}], 
             ")"}]}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "coefflist"}]}]}], ")"}], ",", 
      RowBox[{"TexString", "@", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\mathcal{O}\>\"", ",", 
         RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
         RowBox[{"Tex", "[", 
          RowBox[{
           RowBox[{"OrderedPlus", "[", 
            RowBox[{"x", ",", 
             RowBox[{"-", "x0"}]}], "]"}], "^", 
           RowBox[{"(", 
            RowBox[{"nmax", "/", "den"}], ")"}]}], "]"}], ",", 
         RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616502453411742*^9, 3.616502497621804*^9}, 
   3.616502694996129*^9, {3.6165028555463533`*^9, 3.6165028664163685`*^9}, {
   3.616502995080597*^9, 3.6165030008406053`*^9}, {3.6165032672009783`*^9, 
   3.6165032740109873`*^9}, {3.6165035465964174`*^9, 3.616503559076435*^9}, {
   3.6165037092706933`*^9, 3.6165037116406965`*^9}, {3.616504486249878*^9, 
   3.6165045399640007`*^9}, {3.616504738284279*^9, 3.6165047490942936`*^9}, {
   3.6165053693432584`*^9, 3.6165054214573793`*^9}, {3.6165055076675005`*^9, 
   3.6165055356475396`*^9}},
 CellLabel->
  "In[319]:=",ExpressionUUID->"ba16ed4f-1e42-405e-bceb-6a2150713db4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. SymManipulator", "Section",
 CellChangeTimes->{{3.5450150224250093`*^9, 3.5450150283062196`*^9}},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"0ecfef3e-3925-45d6-b79f-a1c01de56073"],

Cell[CellGroupData[{

Cell["4.1. Tex for SymH and CovarD", "Subsection",ExpressionUUID->"3b36fc65-7f7c-41ac-904d-dc84f36233b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tex", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xAct`SymManipulator`SymH", "[", 
      RowBox[{"headlist_", ",", "sym_", ",", "label_"}], "]"}], "?", 
     "xTensorQ"}], "[", "inds___", "]"}], "]"}], ":=", 
  RowBox[{"TexSymH", "[", 
   RowBox[{
    RowBox[{"xAct`SymManipulator`SymH", "[", 
     RowBox[{"headlist", ",", "sym", ",", "label"}], "]"}], "[", "inds", 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.511599597135436*^9, 3.511599619022236*^9}, {
   3.5446721379221973`*^9, 3.5446721417574167`*^9}, 3.544947656489681*^9, {
   3.545015129643997*^9, 3.545015158831649*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"2ff84bf6-cf61-4ed1-b67a-075cfd980fca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"xAct`SymManipulator`CovarD", "[", 
     RowBox[{
      RowBox[{"D1_", "?", "CovDQ"}], ",", 
      RowBox[{"T_", "?", "xTensorQ"}], ",", "list_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"Last", "@", 
       RowBox[{"SymbolOfCovD", "[", "D1", "]"}]}], "]"}], ",", 
     RowBox[{"Tex", "[", "T", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5160825913697968`*^9, 3.5160826372254195`*^9}, 
   3.5449476584396844`*^9, 3.5449490665771575`*^9, 3.5449491358880796`*^9, {
   3.545015164697259*^9, 3.5450151839008927`*^9}, 3.545015926524597*^9},
 CellLabel->
  "In[321]:=",ExpressionUUID->"369ff1f9-3994-4c65-aaa1-e32fb49cb95f"]
}, Closed]],

Cell[CellGroupData[{

Cell["4.2. TexSymH", "Subsection",ExpressionUUID->"0864d58f-4ccf-46fb-b738-810bdec0e64d"],

Cell["\<\
This is a new code that can handle all cases that are possible to write in a \
nice way. The symmetries that are accepted are disjoint unions of symmetric \
and antisymmetric groups. The indices belonging to one such disjoint subgroup \
have to be all up or all down. If two disjoint subgroups are both acting on \
up or down indices, they have to act on disjoint ranges of indices. If any of \
these criteria fails, messages are printed, and the output is similar to the \
display form. \
\>", "Text",
 CellChangeTimes->{{3.545110811684252*^9, 3.545110856643531*^9}, {
  3.5451108948479977`*^9, 3.545111079318322*^9}, {3.545111127616007*^9, 
  3.5451112038533406`*^9}, {3.5451112426662087`*^9, 
  3.5451112947703004`*^9}},ExpressionUUID->"dc562e28-2586-4a41-b105-\
cbf14acec1d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexGroupSymbols", "[", 
    RowBox[{"points_", ",", "sym_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"xAct`SymManipulator`SubgroupQ", "[", 
      RowBox[{
       RowBox[{"Symmetric", "[", "points", "]"}], ",", "sym"}], "]"}], ",", 
     RowBox[{"(*", " ", "Symmetric", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"xAct`SymManipulator`SubgroupQ", "[", 
      RowBox[{
       RowBox[{"Antisymmetric", "[", "points", "]"}], ",", "sym"}], "]"}], 
     ",", 
     RowBox[{"(*", " ", "Antisymmetric", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<[\>\"", ",", "\"\<]\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", "True", ",", 
     RowBox[{"(*", " ", 
      RowBox[{"Everything", " ", "else"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<Unkown\>\"", ",", "\"\<Unkown\>\""}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5450656415620627`*^9, 3.5450657173469963`*^9}, {
  3.5450728757790265`*^9, 3.545072878477831*^9}, {3.545108184021636*^9, 
  3.545108255376161*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"eb6a1b8e-5dd6-4399-a5a6-95bd2db2659d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexSymH", "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xAct`SymManipulator`SymH", "[", 
       RowBox[{"headlist_", ",", "sym_", ",", "label_"}], "]"}], "[", 
      "inds___", "]"}], ")"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"texfail", "=", "False"}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"List", "[", "inds", "]"}]}]}], ",", 
      RowBox[{"indlist", "=", 
       RowBox[{"List", "@", "inds"}]}], ",", "longorbits", ",", 
      "orbitgroupsymbols", ",", "orbitondowninds", ",", "orbitonupinds", ",", 
      "downsymorbits", ",", "upsymorbits", ",", "excludesymdowninds", ",", 
      "splitdowninds", ",", "splitupinds", ",", "downorbitranges", ",", 
      "uporbitranges", ",", "excludesymupinds", ",", "downindexslots", ",", 
      "beginsym", ",", "endsym", ",", "beginexclude", ",", "endexclude", ",", 
      "preindexsymbolrules", ",", "postindexsymbolrules"}], "}"}], ",", 
    RowBox[{
     RowBox[{"longorbits", "=", 
      RowBox[{"Sort", "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Orbits", "[", 
          RowBox[{"sym", ",", "n"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"orbitgroupsymbols", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexGroupSymbols", "[", 
         RowBox[{"#", ",", "sym"}], "]"}], "&"}], "/@", "longorbits"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Select", "[", 
          RowBox[{"orbitgroupsymbols", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "===", "\"\<Unkown\>\""}], 
            "&"}]}], "]"}]}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<Not a disjoint union of symmetric and antisymmetric \
groups.\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"downindexslots", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "indlist"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"DownIndexQ", "[", 
          RowBox[{"indlist", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orbitondowninds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"xAct`SymManipulator`Private`subsetQ", "[", 
         RowBox[{"#", ",", "downindexslots"}], "]"}], "&"}], "/@", 
       "longorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"orbitonupinds", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "downindexslots"}], "]"}], "]"}], "\[Equal]", 
         "0"}], "&"}], "/@", "longorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"And", "@@", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Or", ",", 
           RowBox[{"{", 
            RowBox[{"orbitondowninds", ",", "orbitonupinds"}], "}"}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Not all indices are in good positions.\>\"", 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"downsymorbits", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"longorbits", ",", "orbitondowninds"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upsymorbits", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"longorbits", ",", "orbitonupinds"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"OrderedQ", "[", 
           RowBox[{"Join", "@@", "downsymorbits"}], "]"}], ",", 
          RowBox[{"OrderedQ", "[", 
           RowBox[{"Join", "@@", "upsymorbits"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"texfail", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<The symmetries are overlapping.\>\"", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"downorbitranges", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Last", "@", "#"}]}], "]"}], ",", "downindexslots"}], 
         "]"}], "&"}], "/@", "downsymorbits"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"uporbitranges", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Last", "@", "#"}]}], "]"}], ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "@", "n"}], ",", "downindexslots"}], "]"}]}], 
         "]"}], "&"}], "/@", "upsymorbits"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"splitdowninds", "=", 
      RowBox[{"Sequence", "@@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SplitBy", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"downorbitranges", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"downsymorbits", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "#"}], "]"}], 
            "&"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "downsymorbits"}]}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"splitupinds", "=", 
      RowBox[{"Sequence", "@@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SplitBy", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"uporbitranges", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"upsymorbits", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "#"}], "]"}], 
            "&"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "upsymorbits"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"excludesymdowninds", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"splitdowninds", ",", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"IntersectingQ", "[", 
           RowBox[{
            RowBox[{"Sequence", "@@@", "downsymorbits"}], ",", "#"}], "]"}]}],
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"excludesymupinds", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"splitupinds", ",", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"IntersectingQ", "[", 
           RowBox[{
            RowBox[{"Sequence", "@@@", "upsymorbits"}], ",", "#"}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"beginsym", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"First", "/@", "downsymorbits"}], ",", 
        RowBox[{"First", "/@", "upsymorbits"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"endsym", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Last", "/@", "downsymorbits"}], ",", 
        RowBox[{"Last", "/@", "upsymorbits"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"beginexclude", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymdowninds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}], ",", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymupinds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"endexclude", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymdowninds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}], ",", 
        RowBox[{"Last", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"excludesymupinds", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], ")"}], "&"}]}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{"orbitgroupsymbols", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Position", "[", 
                RowBox[{"longorbits", ",", "#", ",", "2", ",", "1"}], 
                "]"}]}]}], ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "beginsym"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{"orbitgroupsymbols", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Position", "[", 
                RowBox[{"longorbits", ",", "#", ",", "2", ",", "1"}], 
                "]"}]}]}], ",", "2"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "endsym"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"preindexsymbolrules", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", "\"\<|\>\""}], "]"}], "&"}], "/@", 
         "beginexclude"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"postindexsymbolrules", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", "\"\<|\>\""}], "]"}], "&"}], "/@", 
         "endexclude"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", "preindexsymbolrules"}], ")"}], "/.", 
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"postindexsymbolrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", "postindexsymbolrules"}], ")"}], "/.", 
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"texfail", ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Could not typset the SymH object nicely.\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
         "\"\<\\\\underset{\>\"", ",", "label", ",", "\"\<}{Sym}(\>\"", ",", 
          RowBox[{"TexPrint", "@", 
           RowBox[{"xAct`SymManipulator`RemoveSym", "@", "x"}]}], ",", 
          "\"\<)\>\""}], "]"}]}], ",", 
       RowBox[{"TexKnownSymH", "[", 
        RowBox[{
        "headlist", ",", "n", ",", "indlist", ",", "preindexsymbolrules", ",",
          "postindexsymbolrules"}], "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5450651934356756`*^9, 3.5450652115785074`*^9}, {
   3.545065288876643*^9, 3.5450653050850716`*^9}, {3.545065442256113*^9, 
   3.545065443145314*^9}, {3.54506547492257*^9, 3.545065490428997*^9}, {
   3.5450656072264023`*^9, 3.545065626398836*^9}, {3.5450657320422215`*^9, 
   3.545065745380245*^9}, {3.5450657767363005`*^9, 3.5450658944073067`*^9}, {
   3.545066040361163*^9, 3.5450661377521343`*^9}, {3.545066516794286*^9, 
   3.5450665343443165`*^9}, {3.545066668480598*^9, 3.545066685578228*^9}, {
   3.5450671261509275`*^9, 3.545067294132023*^9}, {3.545067354847329*^9, 
   3.5450674561539073`*^9}, {3.5450676180977917`*^9, 
   3.5450676914491205`*^9}, {3.545067882487056*^9, 3.545068098158435*^9}, {
   3.545068181462581*^9, 3.5450681835061846`*^9}, {3.5450682713499393`*^9, 
   3.5450682790251527`*^9}, {3.5450683222528286`*^9, 
   3.5450683956353574`*^9}, {3.545068453480259*^9, 3.545068468783886*^9}, {
   3.5450687045938997`*^9, 3.54506872183193*^9}, {3.5450687614872*^9, 
   3.545068787554846*^9}, {3.5450688792674065`*^9, 3.5450688926834307`*^9}, {
   3.545068928891094*^9, 3.5450689894816003`*^9}, {3.545069029636071*^9, 
   3.545069047716503*^9}, {3.5450690916149797`*^9, 3.545069126403041*^9}, {
   3.545069711015068*^9, 3.5450697451791277`*^9}, {3.5450698222588634`*^9, 
   3.545069851306114*^9}, {3.5450700025795803`*^9, 3.5450702051147356`*^9}, {
   3.5450703791954412`*^9, 3.5450704071818905`*^9}, {3.545070638031096*^9, 
   3.545070703598011*^9}, 3.545070845964861*^9, {3.54507088493373*^9, 
   3.5450709393934255`*^9}, {3.545070988673912*^9, 3.5450710955340996`*^9}, {
   3.5450712856048336`*^9, 3.5450714319486904`*^9}, {3.545071526968457*^9, 
   3.545071605171395*^9}, {3.5450716352638474`*^9, 3.545071635981449*^9}, {
   3.5450717176475925`*^9, 3.545071720159197*^9}, {3.545071913271936*^9, 
   3.545071951523203*^9}, {3.54507249047395*^9, 3.545072495216358*^9}, {
   3.545072649469429*^9, 3.5450727031647234`*^9}, {3.5450727418995914`*^9, 
   3.545072751384408*^9}, {3.545106624579497*^9, 3.5451070082465706`*^9}, {
   3.5451070605066624`*^9, 3.5451070897879143`*^9}, {3.5451072151819344`*^9, 
   3.5451072175531387`*^9}, {3.5451072767708426`*^9, 3.545107280468049*^9}, {
   3.5451075095388513`*^9, 3.545107509913252*^9}, 3.545107817374192*^9, {
   3.545107853893856*^9, 3.545107925045581*^9}, {3.5451081642096014`*^9, 
   3.5451081809796305`*^9}, {3.5451082669201813`*^9, 3.5451083596623445`*^9}, 
   3.5451083990212135`*^9, {3.5451084967875853`*^9, 3.545108574553722*^9}, {
   3.545108625846612*^9, 3.545108627999416*^9}, {3.5451086791207056`*^9, 
   3.5451087744992733`*^9}, {3.5451088554946156`*^9, 
   3.5451088715782433`*^9}, {3.545109087482623*^9, 3.5451092069788327`*^9}, 
   3.545110335002214*^9, {3.54511044654241*^9, 3.5451104492100143`*^9}, {
   3.6151291771285443`*^9, 3.6151291774585447`*^9}, 3.615129585339116*^9, {
   3.6405929711009665`*^9, 3.640593024161041*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"831f57a0-c756-44f2-b2f0-a61359382151"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexKnownSymH", "[", 
   RowBox[{
   "headlist_", ",", "n_", ",", " ", "indlist_", ",", "preindexsymbolrules_", 
    ",", " ", "postindexsymbolrules_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numindices", "=", 
       RowBox[{"Length", "/@", 
        RowBox[{"SlotsOfTensor", "/@", "headlist"}]}]}], ",", 
      "partitionedslots", ",", "internalexpr", ",", " ", "indicesoftensor", 
      ",", " ", 
      RowBox[{"texstring", "=", "\"\<\>\""}], ",", "  ", 
      RowBox[{"texstringtensor", "=", "\"\<\>\""}], ",", " ", 
      RowBox[{"i", "=", "1"}], ",", " ", "CovarDs", ",", " ", 
      RowBox[{"newheadlist", "=", "headlist"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CovarDs", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"newheadlist", ",", "xAct`SymManipulator`CovarD", ",", "2"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "CovarDs"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numindices", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"numindices", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Sequence", "[", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"newheadlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", ",", "3"}], "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"numindices", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "-", 
                  RowBox[{"Length", "@", 
                   RowBox[{"newheadlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "3"}], "]"}], "]"}]}]}]}], "]"}]}], 
              ")"}], "&"}], "/@", "CovarDs"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newheadlist", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"newheadlist", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Sequence", "[", 
                RowBox[{
                 RowBox[{"Last", "@", 
                  RowBox[{"SymbolOfCovD", "@", 
                   RowBox[{"newheadlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"newheadlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], ")"}], 
             "&"}], "/@", "CovarDs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"CovarDs", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "newheadlist", ",", "xAct`SymManipulator`CovarD", ",", "2"}], 
           "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extract", " ", "indices", " ", "belonging", " ", "to", " ", "the", " ",
        "different", " ", 
       RowBox[{"tensors", ".", " ", "Can"}], " ", "this", " ", "be", " ", 
       "done", " ", "in", " ", "a", " ", "simpler", " ", 
       RowBox[{"way", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"partitionedslots", "=", 
      RowBox[{"Last", "/@", 
       RowBox[{"Rest", "@", 
        RowBox[{"FoldList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "]"}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "]"}]}], "}"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], ",", "numindices"}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"indicesoftensor", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"indlist", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "partitionedslots"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "@", "newheadlist"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"texstringtensor", "=", " ", 
         RowBox[{"TexTensorWithSym", "[", 
          RowBox[{
           RowBox[{"newheadlist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"indicesoftensor", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"partitionedslots", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", ",", "preindexsymbolrules", 
           ",", " ", "postindexsymbolrules"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", "texstringtensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "texstring"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.545106618542286*^9, 3.5451066187138863`*^9}, {
   3.5451073326813407`*^9, 3.545107380043024*^9}, 3.5451074265467052`*^9, {
   3.545107520833271*^9, 3.545107613076233*^9}, {3.5451083647479534`*^9, 
   3.5451083699739623`*^9}, {3.5451092649017344`*^9, 3.545109299315395*^9}, 
   3.5451095049705563`*^9, {3.5451104526732206`*^9, 3.545110467352846*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"c84bfc37-09f4-4daa-aeca-4a0c6b02f540"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexTensorWithSym", "[", 
   RowBox[{
   "head_", ",", "inds_", ",", "slots_", ",", "preindexsymbolrules_", ",", 
    " ", "postindexsymbolrules_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"texstring", "=", 
       RowBox[{"Tex", "@", "head"}]}], ",", " ", 
      RowBox[{"i", "=", "1"}], ",", " ", "fromdown", ",", 
      RowBox[{"postindexsymbol", "=", "\"\<\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "inds", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", 
           RowBox[{"TexSymIndex", "[", 
            RowBox[{
             RowBox[{"inds", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"i", "\[Equal]", "1"}], ",", "fromdown", ",", 
             RowBox[{
              RowBox[{"slots", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/.", 
              "preindexsymbolrules"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fromdown", "=", 
         RowBox[{"DownIndexQ", "[", 
          RowBox[{"inds", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"postindexsymbol", "=", 
         RowBox[{
          RowBox[{"slots", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/.", "postindexsymbolrules"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"texstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"texstring", ",", "postindexsymbol"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "inds"}], ">", "0"}], ",", " ", 
       RowBox[{"texstring", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"texstring", ",", "\"\<}\>\""}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "texstring"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5451095741566772`*^9, 3.545109627508771*^9}, {
   3.545109710438517*^9, 3.545109724150941*^9}, 3.545109841931148*^9, {
   3.5451098829602203`*^9, 3.5451098867822266`*^9}, {3.5451099471075325`*^9, 
   3.5451100710029507`*^9}, {3.545110470730053*^9, 3.545110482773274*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"a79f595c-d32d-44f9-b2fd-a51140fe9593"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexSymIndex", "[", 
   RowBox[{
   "index_", ",", "firstindexQ_", ",", "fromdownQ_", ",", "preindexsymbol_"}],
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "indexstring", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"indexstring", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}], "&&", 
         RowBox[{"Not", "[", "$TexPrintInitialBracesQ", "]"}]}], ",", 
        "\"\<_{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}], "&&", 
         "$TexPrintInitialBracesQ"}], ",", "\"\<{}_{\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", 
         RowBox[{"Not", "[", "$TexPrintInitialBracesQ", "]"}]}], ",", 
        "\"\<^{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"firstindexQ", "&&", "$TexPrintInitialBracesQ"}], ",", 
        "\"\<{}^{\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"fromdownQ", "&&", 
         RowBox[{"DownIndexQ", "[", "index", "]"}]}], ",", "\"\<\>\"", ",", 
        "\[IndentingNewLine]", "fromdownQ", ",", "\"\<}{}^{\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DownIndexQ", "[", "index", "]"}], ",", "\"\<}{}_{\>\"", ",", 
        "\[IndentingNewLine]", "True", ",", "\"\<\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"indexstring", ",", "preindexsymbol", ",", 
       RowBox[{"TexUpIndex", "[", 
        RowBox[{"UpIndex", " ", "@", "index"}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5115823822282057`*^9, 3.5115823970638056`*^9}, {
   3.5115827587342052`*^9, 3.5115828530362053`*^9}, 3.5115829200694056`*^9, {
   3.5115829515502057`*^9, 3.5115830791894054`*^9}, {3.5115832595456057`*^9, 
   3.511583299356806*^9}, {3.5115833884796057`*^9, 3.5115834525488057`*^9}, {
   3.5115834884132056`*^9, 3.5115837453452053`*^9}, {3.511583789196806*^9, 
   3.5115838052492056`*^9}, {3.5115838378064055`*^9, 
   3.5115839419988055`*^9}, {3.5115839952104053`*^9, 
   3.5115840202172055`*^9}, {3.5115842219876056`*^9, 
   3.5115842652308054`*^9}, {3.5115872711526055`*^9, 
   3.5115872738826056`*^9}, {3.5115883817946053`*^9, 3.511588404040206*^9}, {
   3.511594716331606*^9, 3.5115947536000056`*^9}, {3.5121019416140003`*^9, 
   3.5121020010968*^9}, {3.544949169693339*^9, 3.544949175168948*^9}, 
   3.5449504778034363`*^9, {3.544951562774544*^9, 3.544951565145748*^9}, {
   3.5450153199643316`*^9, 3.5450153479195805`*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"35ff1138-6882-4b2c-85c0-1f4c56e86d93"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["5. xTerior", "Section",
 CellChangeTimes->{{3.5450150224250093`*^9, 3.5450150283062196`*^9}, 
   3.61908490820138*^9, {3.61908519325185*^9, 3.6190851968218555`*^9}},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"9a8428fe-356a-40a2-97ae-550cc6b3c1d9"],

Cell[CellGroupData[{

Cell["5.1. Tex for the structures in xTerior", "Subsection",
 CellChangeTimes->{
  3.61908519985186*^9, {3.6190852364659595`*^9, 
   3.6190852458159723`*^9}},ExpressionUUID->"380127a2-c8c1-49c3-b899-\
71410cee71f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Wedge", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "Wedge", "]"}], ":=", 
     "\"\< \\\\wedge \>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", "expr_Wedge", "]"}], ":=", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"TexFactor", "/@", 
         RowBox[{"List", "@@", "expr"}]}], ",", 
        RowBox[{"TexOperator", "[", "Wedge", "]"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616504204669483*^9, 3.6165042419795356`*^9}, {
  3.616505060588778*^9, 3.6165050651887846`*^9}, {3.6190853996861877`*^9, 
  3.6190854302862306`*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"ac9c839f-5380-48b8-a1e5-fb9ca9b4ba83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Exterior", " ", "derivative"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TexOperator", "[", "xAct`xTerior`Diff", "]"}], ":=", 
     "\"\< d \>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"xAct`xTerior`Diff", "[", 
        RowBox[{
         RowBox[{"expr_Wedge", "|", "expr_Plus", "|", "expr_Times"}], ",", 
         "covd___"}], "]"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "xAct`xTerior`Diff", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covd", "===", "PD"}], ",", "\"\<\>\"", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<^{\>\"", ",", 
           RowBox[{"Tex", "[", 
            RowBox[{
             RowBox[{"SymbolOfCovD", "[", "covd", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<}\>\""}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}], ",", 
       RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"xAct`xTerior`Diff", "[", 
        RowBox[{"expr_", ",", "covd___"}], "]"}], "]"}], "]"}], ":=", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"TexOperator", "[", "xAct`xTerior`Diff", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covd", "===", "PD"}], ",", "\"\<\>\"", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<^{\>\"", ",", 
           RowBox[{"Tex", "[", 
            RowBox[{
             RowBox[{"SymbolOfCovD", "[", "covd", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<}\>\""}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6190865004039216`*^9, 3.619086525503957*^9}, 
   3.6190868000693893`*^9, {3.619086841799448*^9, 3.6190868834795065`*^9}, {
   3.6190869945696616`*^9, 3.6190870213296995`*^9}, 3.6190873167741613`*^9, {
   3.6190885228670425`*^9, 3.6190885240070443`*^9}, {3.619626126464985*^9, 
   3.6196261865891175`*^9}, {3.619626781260213*^9, 3.6196268378602924`*^9}, {
   3.619626905370387*^9, 3.6196269112303953`*^9}, {3.6196269727404814`*^9, 
   3.6196270093405323`*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"fe9f0035-6650-48bd-895b-2acf5cf2aa28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Coframe", " ", "and", " ", "dx"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Coframe", "[", "man_", "]"}], "]"}], ":=", 
     "\"\<\\\\theta\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`dx", "[", "man_", "]"}], "]"}], ":=", 
     "\"\<dx\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6190873200641656`*^9, 3.6190873454782495`*^9}, {
  3.619087459418409*^9, 3.6190875205584946`*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"a6825211-ee25-46fe-b3dc-a7c4694d3ece"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"xAct`xTerior`Hodge", "[", "met_", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<{*}_{\>\"", ",", 
     RowBox[{"Tex", "[", "met", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`Hodge", "[", "met_", "]"}], "[", 
     RowBox[{"expr_Wedge", "|", "expr_Plus", "|", "expr_Times"}], "]"}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Hodge", "[", "met", "]"}], "]"}], ",", 
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`Hodge", "[", "met_", "]"}], "[", "expr_", "]"}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Hodge", "[", "met", "]"}], "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"xAct`xTerior`Codiff", "[", "met_", "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\delta_{\>\"", ",", 
     RowBox[{"Tex", "[", "met", "]"}], ",", "\"\<}\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`Codiff", "[", "met_", "]"}], "[", 
     RowBox[{"expr_Wedge", "|", "expr_Plus", "|", "expr_Times"}], "]"}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Codiff", "[", "met", "]"}], "]"}], ",", 
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`Codiff", "[", "met_", "]"}], "[", "expr_", "]"}], 
    "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"Tex", "[", 
      RowBox[{"xAct`xTerior`Codiff", "[", "met", "]"}], "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`CartanD", "[", 
      RowBox[{
       RowBox[{"v_", "?", "xTensorQ"}], "[", "a_", "]"}], "]"}], "[", 
     RowBox[{
      RowBox[{"expr_Wedge", "|", "expr_Plus", "|", "expr_Times"}], ",", 
      "covd_"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\mathcal{L}\>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Or", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"{", "covd", "}"}]}], "\[Equal]", "0"}], ",", 
         RowBox[{"covd", "===", "xAct`xTensor`PD"}]}], "]"}], ",", "\"\<\>\"",
        ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<^{\>\"", ",", 
         RowBox[{"Tex", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"SymbolOfCovD", "[", "covd", "]"}]}]}], ",", 
         "\"\<}{}\>\""}], "]"}]}], "]"}], ",", "\"\<_{\>\"", ",", 
     RowBox[{"Tex", "[", "v", "]"}], ",", "\"\<}\>\"", ",", 
     RowBox[{"TexOpen", "[", "\"\<(\>\"", "]"}], ",", 
     RowBox[{"Tex", "[", "expr", "]"}], ",", 
     RowBox[{"TexClose", "[", "\"\<)\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{
     RowBox[{"xAct`xTerior`CartanD", "[", 
      RowBox[{
       RowBox[{"v_", "?", "xTensorQ"}], "[", "a_", "]"}], "]"}], "[", 
     RowBox[{"expr_", ",", "covd___"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\mathcal{L}\>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Or", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"{", "covd", "}"}]}], "\[Equal]", "0"}], ",", 
         RowBox[{"covd", "===", "xAct`xTensor`PD"}]}], "]"}], ",", "\"\<\>\"",
        ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<^{\>\"", ",", 
         RowBox[{"Tex", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"SymbolOfCovD", "[", "covd", "]"}]}]}], ",", 
         "\"\<}{}\>\""}], "]"}]}], "]"}], ",", "\"\<_{\>\"", ",", 
     RowBox[{"Tex", "[", "v", "]"}], ",", "\"\<}\>\"", ",", 
     RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{
      RowBox[{"xAct`xTerior`Int", "[", 
       RowBox[{
        RowBox[{"v_", "?", "xTensorQ"}], "[", "a_", "]"}], "]"}], "[", 
      "expr_", "]"}], "]"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\\\iota_{\>\"", ",", 
     RowBox[{"Tex", "[", "v", "]"}], ",", "\"\<}\>\"", ",", 
     RowBox[{"Tex", "[", "expr", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tex", "[", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"form", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "xAct`xTerior`ChristoffelForm", "|", "xAct`xTerior`ConnectionForm", 
         "|", "xAct`xTerior`RiemannForm", "|", "xAct`xTerior`CurvatureForm", 
         "|", "xAct`xTerior`TorsionForm"}], ")"}], "[", 
       RowBox[{"covd_", ",", "vb___"}], "]"}]}], "]"}], "]"}], ":=", 
   RowBox[{"Tex", "@", 
    RowBox[{"PrintAs", "@", "form"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6190879102330885`*^9, 3.6190879910582495`*^9}, {
   3.6190880436983232`*^9, 3.61908810550841*^9}, {3.6190882080785537`*^9, 
   3.619088221208572*^9}, {3.619088387636853*^9, 3.6190884484869385`*^9}, {
   3.6190885348811073`*^9, 3.6190885491311274`*^9}, {3.61962582570852*^9, 
   3.619625860694613*^9}, {3.619625906234677*^9, 3.619626075764914*^9}, {
   3.619626452575705*^9, 3.619626454055707*^9}, {3.619627358469118*^9, 
   3.619627400499177*^9}, {3.619627446249241*^9, 3.6196274844692945`*^9}, 
   3.6196275264693527`*^9, {3.6196275582593975`*^9, 3.61962760280046*^9}, {
   3.619627707374655*^9, 3.6196278023157873`*^9}, {3.619627999620112*^9, 
   3.619628009610126*^9}, {3.6196282626845284`*^9, 3.6196283282946205`*^9}, 
   3.619629504994461*^9, {3.619629735354783*^9, 3.619629743714795*^9}, {
   3.6196297824688973`*^9, 3.619629789628907*^9}, {3.6196298445489845`*^9, 
   3.6196299116990786`*^9}, {3.619630059453333*^9, 3.6196300705833488`*^9}, {
   3.620540927590987*^9, 3.620540944251011*^9}, {3.620541180365389*^9, 
   3.620541205365424*^9}, {3.620541255826495*^9, 3.62054136081069*^9}, {
   3.620541613791044*^9, 3.6205416651951647`*^9}, {3.620541915875516*^9, 
   3.620541937519594*^9}, {3.620541974739646*^9, 3.620542069879779*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"29de0b5e-79a1-4688-bf37-6a03e23194a0"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["6. TexBreak", "Section",
 CellChangeTimes->{3.545015046527052*^9, 3.6190852024718637`*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"f9e1ffe1-b04a-4846-bc74-a884a6711de2"],

Cell[CellGroupData[{

Cell["6.1. TexBreak function", "Subsection",
 CellChangeTimes->{
  3.619085204661866*^9},ExpressionUUID->"b17aac68-8a64-4a5b-8a0f-\
1d350d75b43e"],

Cell["\<\
We need the internal function PartitionRagged. For old versions of \
Mathematica, we need to supply an implementation.\
\>", "Text",
 CellChangeTimes->{{3.727410552715109*^9, 3.727410560170476*^9}},
 ExpressionUUID -> "fcd66f28-69e4-4b14-a530-7c2a438a50b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"oldPartitionRagged", "[", 
    RowBox[{"l_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"Last", "/@", 
    RowBox[{"Rest", "@", 
     RowBox[{"FoldList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "]"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "]"}]}], "}"}], 
        "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", "p"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"System`$VersionNumber", "<", "8."}], ",", 
    RowBox[{"partitionRagged", "=", "oldPartitionRagged"}], ",", 
    RowBox[{"partitionRagged", "=", "Internal`PartitionRagged"}]}], "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.727410556466342*^9},
 CellLabel->
  "In[343]:=",ExpressionUUID->"01a699ef-d89d-4698-80d7-5652a8b555ad"],

Cell["Jose\[CloseCurlyQuote]s old code for TexBreak:", "Text",
 ExpressionUUID -> "b5e18e40-23d4-4255-8ec2-202f208781a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"StringInsert", "[", 
    RowBox[{"string", ",", "\"\< \\\\nonumber \\\\\\\\ \\n\>\"", ",", 
     RowBox[{"Last", "/@", 
      RowBox[{"Split", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"string", ",", 
           RowBox[{"\"\< + \>\"", "|", "\"\< - \>\""}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerPart", "[", 
           RowBox[{"#1", "/", "n"}], "]"}], "===", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"#2", "/", "n"}], "]"}]}], "&"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.588328778432424*^9, 
  3.5883287990868607`*^9}},ExpressionUUID->"8b74c26b-5efb-4a25-898a-\
b815dffb2866"],

Cell["\<\
Barry\[CloseCurlyQuote]s new code with the TexBreakBy option \
\[OpenCurlyDoubleQuote]TexPoint\[CloseCurlyDoubleQuote] added by Thomas:\
\>", "Text",ExpressionUUID->"5e8dd041-e4ed-4a52-a90f-a1366d3d94fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TexBreak", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TexBreakBy", "\[Rule]", "\"\<Character\>\""}], ",", 
     RowBox[{"TexBreakAt", "\[Rule]", 
      RowBox[{"\"\< + \>\"", "|", "\"\< - \>\""}]}], ",", 
     RowBox[{
     "TexBreakString", "\[Rule]", "\"\< \\\\nonumber \\\\\\\\ \\n&&\>\""}], 
     ",", 
     RowBox[{"EquationMarks", "\[Rule]", "False"}], ",", 
     RowBox[{"TexBreakInParenthesis", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588078862582654*^9, 3.5880789023627243`*^9}, {
  3.715232437717578*^9, 3.715232491701953*^9}},
 CellLabel->
  "In[345]:=",ExpressionUUID->"913da0af-5240-46db-b40b-92e6080ccc25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BreakingFunction", "[", 
    RowBox[{"rulelist_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"best", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"rulelist", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "n"}], "&"}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "best"}], "\[Equal]", "0"}], ",", 
       RowBox[{"Last", "@", 
        RowBox[{"First", "[", "rulelist", "]"}]}], ",", 
       RowBox[{"Last", "@", 
        RowBox[{"Last", "@", "best"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SplittingFunction", "[", 
    RowBox[{"string_String", ",", "breakat_", ",", "breakinparenthesis_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"splittablePositions", ",", "splitstructure"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Count", " ", "the", " ", "bracket", " ", "level", " ", "and", " ", 
       "split", " ", "only", " ", "when", " ", "breakat", " ", "appears", " ",
        "at", " ", "bracket", " ", "level", " ", "0."}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "At", " ", "which", " ", "position", " ", "do", " ", "we", " ", "find", 
       " ", "breakat", " ", "or", " ", 
       RowBox[{"brackets", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"breakinparenthesis", "===", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"splittablePositions", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"StringPosition", "[", 
           RowBox[{"string", ",", 
            RowBox[{"breakat", "|", "\"\<{\>\"", "|", "\"\<}\>\""}]}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"splittablePositions", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"StringPosition", "[", 
           RowBox[{"string", ",", 
            RowBox[{
            "breakat", "|", "\"\<{\>\"", "|", "\"\<}\>\"", "|", "\"\<(\>\"", 
             "|", "\"\<)\>\""}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Construct", " ", "a", " ", "structure", " ", "of", " ", "the", " ", 
         "kind", " ", 
         RowBox[{"{", 
          RowBox[{"pos", ",", " ", "n", ",", " ", "notbracketQ"}], "}"}]}], 
        ",", " ", 
        RowBox[{
        "where", " ", "pos", " ", "is", " ", "the", " ", "position", " ", 
         "of", " ", "the", " ", "character"}], ",", " ", 
        RowBox[{
        "n", " ", "is", " ", "1", " ", "for", " ", "opening", " ", 
         "brackets"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], " ", "for", " ", "closing", " ", "brackets", " ",
          "and", " ", "0", " ", "for", " ", "everything", " ", 
         RowBox[{"else", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"splitstructure", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"string", ",", 
             RowBox[{"{", "#", "}"}]}], "]"}], ",", "\"\<{\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "1", ",", "False"}], "}"}], ",", "\"\<(\>\"", 
           ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "1", ",", "False"}], "}"}], ",", "\"\<}\>\"", 
           ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}], ",", "False"}], "}"}], ",", "\"\<)\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}], ",", "False"}], "}"}], ",", "_", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "0", ",", "True"}], "}"}]}], "]"}], "&"}], "/@",
         "splittablePositions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Compute", " ", "the", " ", "bracket", " ", "level", " ", "by", " ", 
         "accumulating", " ", "the", " ", 
         RowBox[{"n", "'"}], 
         RowBox[{"s", ".", " ", "Return"}], " ", "a", " ", "structure", " ", 
         RowBox[{"{", 
          RowBox[{"pos", ",", " ", "possiblebreakQ"}], "}"}]}], ",", " ", 
        RowBox[{
        "and", " ", "extract", " ", "the", " ", "possible", " ", "breaking", 
         " ", 
         RowBox[{"positions", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"splitstructure", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"#2", "\[Equal]", "0"}], ",", 
              RowBox[{"#1", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"splitstructure", ",", 
           RowBox[{"Accumulate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
             "splitstructure"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"splittablePositions", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"Select", "[", 
         RowBox[{"splitstructure", ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PointBreakingFunction", "[", 
    RowBox[{
    "perLinein_", ",", "n_", ",", "texedwidthin_", ",", "pagewidth_", ",", 
     "splittablePositionsin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nearestTerm", ",", 
       RowBox[{"positions", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"perLine", "=", "perLinein"}], ",", 
       RowBox[{"texedwidth", "=", "texedwidthin"}], ",", 
       RowBox[{"splittablePositions", "=", "splittablePositionsin"}]}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Split", " ", "parts", " ", "where", " ", "lengths", " ", "are", " ", 
       "given", " ", "explicitly"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "perLine"}], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"Length", "@", "splittablePositions"}], ">", "0"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nearestTerm", "=", 
          RowBox[{"BreakingFunction", "[", 
           RowBox[{
            RowBox[{"Thread", "@", 
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"Accumulate", "@", "texedwidth"}], ",", " ", 
               RowBox[{"Range", "@", 
                RowBox[{"Length", "@", "texedwidth"}]}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"perLine", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/.", 
             RowBox[{"latextextwidth", "->", "pagewidth"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"perLine", "=", 
          RowBox[{"Rest", "@", 
           RowBox[{"Normal", "@", "perLine"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nearestTerm", "\[LessEqual]", 
            RowBox[{"Length", "@", "splittablePositions"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"positions", ",", 
              RowBox[{"splittablePositions", "[", 
               RowBox[{"[", "nearestTerm", "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"splittablePositions", "=", 
             RowBox[{"Drop", "[", 
              RowBox[{"splittablePositions", ",", "nearestTerm"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"texedwidth", "=", 
             RowBox[{"Drop", "[", 
              RowBox[{"texedwidth", ",", "nearestTerm"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"splittablePositions", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"texedwidth", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{" ", 
        RowBox[{
        "Split", " ", "remainder", " ", "into", " ", "strings", " ", "of", 
         " ", 
         RowBox[{"length", "~", "n"}]}], ")"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "splittablePositions"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nearestTerm", "=", 
          RowBox[{"BreakingFunction", "[", 
           RowBox[{
            RowBox[{"Thread", "@", 
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"Accumulate", "@", "texedwidth"}], ",", " ", 
               RowBox[{"Range", "@", 
                RowBox[{"Length", "@", "texedwidth"}]}]}], "]"}]}], ",", 
            RowBox[{"n", "/.", 
             RowBox[{"latextextwidth", "->", "pagewidth"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nearestTerm", "\[LessEqual]", 
            RowBox[{"Length", "@", "splittablePositions"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"positions", ",", 
              RowBox[{"splittablePositions", "[", 
               RowBox[{"[", "nearestTerm", "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"splittablePositions", "=", 
             RowBox[{"Drop", "[", 
              RowBox[{"splittablePositions", ",", "nearestTerm"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"texedwidth", "=", 
             RowBox[{"Drop", "[", 
              RowBox[{"texedwidth", ",", "nearestTerm"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"splittablePositions", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"texedwidth", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "positions"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588080124533271*^9, 3.5880801251104717`*^9}, {
  3.727334497617021*^9, 3.727334607583501*^9}, {3.7273346542153444`*^9, 
  3.7273346579038215`*^9}, {3.727334690616264*^9, 3.7273346949637585`*^9}, {
  3.7273357508958077`*^9, 3.727335802552883*^9}, {3.727335844738163*^9, 
  3.727335912898426*^9}, {3.727335964193879*^9, 3.727335983455639*^9}, {
  3.7273361573446054`*^9, 3.727336192104974*^9}, {3.727336326590088*^9, 
  3.7273363979414797`*^9}, {3.727336664948242*^9, 3.7273366664340925`*^9}, {
  3.7273369140587006`*^9, 3.727336986543435*^9}, {3.7273404705537233`*^9, 
  3.727340471023249*^9}, {3.72734057921856*^9, 3.727340579788499*^9}},
 CellLabel->
  "In[346]:=",ExpressionUUID->"d47f80bc-04b1-4f80-9770-b13526e2c306"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TexBreak", "[", 
     RowBox[{"string_String", ",", "n_", ",", "l_List", ",", "options___"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "splittablePositions", ",", "breakat", ",", "breakby", ",", 
        "breakstring", ",", "splitat", ",", "positions", ",", "perLine", ",", 
        "splitted", ",", "texedwidth", ",", "mark", ",", "pagewidth", ",", 
        "tmpselect", ",", "breakinparenthesis"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "breakat", ",", "breakby", ",", "breakstring", ",", "mark", ",", 
          "breakinparenthesis"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "TexBreakAt", ",", "TexBreakBy", ",", "TexBreakString", ",", " ", 
            "EquationMarks", ",", "TexBreakInParenthesis"}], "}"}], "/.", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", 
         RowBox[{"Options", "[", "TexBreak", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Positions", " ", "where", " ", "the", " ", "string", " ", "can", " ",
          "be", " ", 
         RowBox[{"split", ":", " ", 
          RowBox[{"wherever", " ", "+", " ", "or", " ", "-", " ", 
           RowBox[{"is", " ", "encountered"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Older", " ", 
           RowBox[{"code", ":", " ", "splittablePositions"}]}], "=", 
          RowBox[{"First", "/@", 
           RowBox[{"StringPosition", "[", 
            RowBox[{"string", ",", "breakat"}], "]"}]}]}], ";"}], " ", "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"splittablePositions", "=", 
        RowBox[{"SplittingFunction", "[", 
         RowBox[{"string", ",", "breakat", ",", "breakinparenthesis"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"The", " ", 
         RowBox[{"terms", "/", "characters"}], " ", "per", " ", "line", " ", 
         "that", " ", "the", " ", "user", " ", "specified"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"l", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"perLine", "=", 
          RowBox[{"SparseArray", "[", 
           RowBox[{"l", ",", "Automatic", ",", "n"}], "]"}]}], ",", 
         RowBox[{"perLine", "=", 
          RowBox[{"{", "n", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Positions", " ", "at", " ", "which", " ", "the", " ", "string", " ", 
         "will", " ", "be", " ", "split"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "breakby", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\"\<Character\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"positions", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"iter", ",", 
              RowBox[{"currentPosition", "=", "0"}], ",", "nearestPosition", 
              ",", 
              RowBox[{"strlen", "=", 
               RowBox[{"StringLength", "[", "string", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Split", " ", "parts", " ", "where", " ", "lengths", " ", "are", 
              " ", "given", " ", "explicitly"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"iter", "=", "1"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"iter", "\[LessEqual]", 
                  RowBox[{"Length", "[", "perLine", "]"}]}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"currentPosition", "+", 
                   RowBox[{"perLine", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}]}], "<", "strlen"}], 
                 ")"}]}], ",", 
               RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmpselect", "=", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"splittablePositions", "-", "currentPosition"}], 
                   ",", "Positive"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"nearestPosition", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", "tmpselect"}], ">", "0"}], ",", 
                   RowBox[{"Nearest", "[", 
                    RowBox[{"tmpselect", ",", 
                    RowBox[{"perLine", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestPosition", "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"currentPosition", "+=", 
                    RowBox[{"First", "@", "nearestPosition"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", "currentPosition"}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"currentPosition", "=", "strlen"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{" ", 
               RowBox[{
               "Split", " ", "remainder", " ", "into", " ", "strings", " ", 
                "of", " ", 
                RowBox[{"length", "~", "n"}]}], ")"}], " ", "*)"}], 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"currentPosition", "+", "n"}], "<", "strlen"}], 
                ")"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmpselect", "=", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"splittablePositions", "-", "currentPosition"}], 
                   ",", "Positive"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"nearestPosition", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", "tmpselect"}], ">", "0"}], ",", 
                   RowBox[{"Nearest", "[", 
                    RowBox[{"tmpselect", ",", "n"}], "]"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nearestPosition", "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"currentPosition", "+=", 
                    RowBox[{"First", "@", "nearestPosition"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"positions", ",", "currentPosition"}], "]"}]}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"currentPosition", "=", "strlen"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Term\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "The", " ", "terms", " ", "at", " ", "which", " ", "we", " ", 
           "want", " ", "to", " ", "split"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"splitat", "=", 
           RowBox[{"Accumulate", "[", "perLine", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Pad", " ", "out", " ", "every", " ", "n", " ", "terms"}], 
           " ", "*)"}], 
          RowBox[{"splitat", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"splitat", ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", "splitat", "]"}], "+", "n"}], ",", 
                RowBox[{"Length", "[", "splittablePositions", "]"}], ",", 
                "n"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Remove", " ", "split", " ", "points", " ", "which", " ", "are", 
            " ", "past", " ", "the", " ", "end", " ", "of", " ", "the", " ", 
            "string"}], " ", "*)"}], 
          RowBox[{"splitat", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"splitat", ",", 
             RowBox[{
              RowBox[{"#", "\[LessEqual]", 
               RowBox[{"Length", "[", "splittablePositions", "]"}]}], "&"}]}],
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "The", " ", "positions", " ", "in", " ", "the", " ", "string", " ",
             "to", " ", "split", " ", "at"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"positions", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"splittablePositions", ",", "#"}], "]"}], "&"}], ",", 
             "splitat"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\"\<TexPoint\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"splitted", "=", 
           RowBox[{"StringTake", "[", 
            RowBox[{"string", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Prepend", "[", 
                 RowBox[{"splittablePositions", ",", "1"}], "]"}], ",", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"splittablePositions", "-", "1"}], ",", 
                  RowBox[{"StringLength", "@", "string"}]}], "]"}]}], "}"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"texedwidth", "=", 
           RowBox[{"TexWidths", "@@", "splitted"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pagewidth", "=", 
           RowBox[{"First", "@", "texedwidth"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"texedwidth", "=", 
           RowBox[{"Rest", "@", "texedwidth"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"positions", "=", 
           RowBox[{"PointBreakingFunction", "[", 
            RowBox[{
            "perLine", ",", "n", ",", "texedwidth", ",", "pagewidth", ",", 
             "splittablePositions"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Throw", "[", "\"\<Invalid value for option TexBreakBy.\>\"", 
          "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Split", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"AddEquationMarks", "[", 
        RowBox[{
         RowBox[{"StringInsert", "[", 
          RowBox[{"string", ",", "breakstring", ",", "positions"}], "]"}], 
         ",", "mark"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Shortcuts", " ", "and", " ", "defaults"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "n_", ",", "options___"}], "]"}], ":=", 
   RowBox[{"TexBreak", "[", 
    RowBox[{"string", ",", "n", ",", 
     RowBox[{"{", "}"}], ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexBreak", "[", 
    RowBox[{"string_String", ",", "options___"}], "]"}], ":=", 
   RowBox[{"TexBreak", "[", 
    RowBox[{"string", ",", "200", ",", 
     RowBox[{"{", "}"}], ",", "options"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[349]:=",ExpressionUUID->"3740ff6f-cc36-415f-a05f-bc96c7e9937a"]
}, Closed]],

Cell[CellGroupData[{

Cell["6.2. TexWidths", "Subsection",
 CellChangeTimes->{{3.5822792082243814`*^9, 3.5822792262580137`*^9}, 
   3.61908520690187*^9},
 ExpressionUUID -> "45c97c55-4664-4e85-a0d8-6e850f0de568"],

Cell["\<\
Thomas\[CloseCurlyQuote] code for determining the widths of a sequence of tex \
expressions measured in printer points. 
A file TexActWidthTest.tex is written and passed to the inline latex command. \
The widths are then extracted from the output.The first output is the latex \
textwidth environment variable.\
\>", "Text",
 CellChangeTimes->{{3.5822792405320387`*^9, 3.5822794098547363`*^9}, {
  3.582279477122054*^9, 3.582279533204152*^9}, {3.582281862071843*^9, 
  3.5822818631014447`*^9}, {3.5883302044787283`*^9, 
  3.5883302417783937`*^9}},ExpressionUUID->"55d3c8e1-2164-4245-b475-\
dc7cb4fe0832"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "latextextwidth", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588329526017937*^9, 3.58832953339675*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"58c837f0-a0e1-4542-a14b-0f7e01875738"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TexDirectory", "=", "$TemporaryDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TexTmpDirectory", "=", "$TemporaryDirectory"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5880819971481667`*^9, 3.5880820029981775`*^9}, {
  3.5883139972465963`*^9, 3.5883140035490074`*^9}, {3.6410294708241997`*^9, 
  3.6410294711542006`*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"f6cf244a-5510-4475-8ce0-6bc765a061c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Or", 
     StyleBox["[", "Code"], 
     RowBox[{
      RowBox[{"StringMatchQ", "[", 
       RowBox[{"System`$Version", ",", "\"\<*Linux*\>\""}], "]"}], ",", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{"System`$Version", ",", "\"\<*Mac OS*\>\""}], "]"}]}], 
     StyleBox["]", "Input"]}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "latexlist", "}"}], ",", 
      RowBox[{
       RowBox[{"latexlist", "=", 
        RowBox[{"ReadList", "[", 
         RowBox[{"\"\<!$SHELL -l -c 'which pdflatex'\>\"", ",", "String"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "latexlist"}], ">", "0"}], ",", 
         RowBox[{"$LatexExecutable", "=", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"First", "@", "latexlist"}], ",", 
            "\"\< -interaction nonstopmode -halt-on-error\>\""}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
         "$LatexExecutable", ":=", 
          "\"\<pdflatex -interaction nonstopmode -halt-on-error\>\""}]}], 
        "]"}], ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "$LatexExecutable", ":=", 
      "\"\<pdflatex -interaction nonstopmode -halt-on-error\>\""}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.64103091763655*^9, 3.712045805944728*^9},
 CellLabel->
  "In[355]:=",ExpressionUUID->"98e9d480-e40e-4b75-9011-98416395b963"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "$TexInitLatexClassCode", "=", 
   "\"\<\\\\documentclass[10pt,a4paper]{article}\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "$TexInitLatexInternalClassCode", "=", 
   "\"\<\\\\documentclass[border=2pt,varwidth]{standalone}\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58796424998662*^9, 3.5879642770994673`*^9}, {
  3.728550561197211*^9, 3.7285505831046925`*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"6adfeaf7-650d-4cf4-9d44-562b09e2e070"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexInitLatexPackages", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<{amssymb}\>\"", ",", " ", "\"\<{amsmath}\>\"", ",", " ", 
     "\"\<{amsthm}\>\"", ",", " ", "\"\<{latexsym}\>\""}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5879639239928474`*^9, 3.587964043301857*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"0c03530b-eb8a-468c-9981-de34a13cfdfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexInitLatexExtraCode", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587964316895138*^9, 3.5879643241179504`*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"4b02e3b5-ac61-4f81-b922-ee3aebfcd944"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexInitLatexCode", "[", "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"$TexInitLatexClassCode", ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<\\\\usepackage\>\"", ",", "#", ",", "\"\<\\n\>\""}], 
        "]"}], "&"}], "/@", "$TexInitLatexPackages"}], "]"}], ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"#", ",", "\"\<\\n\>\""}], "]"}], "&"}], "/@", 
      "$TexInitLatexExtraCode"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5879640603838873`*^9, 3.5879640620218897`*^9}, {
  3.587964133782016*^9, 3.5879641970401273`*^9}, {3.5879642832926784`*^9, 
  3.5879642946962986`*^9}, {3.5879643380487747`*^9, 3.5879643663784246`*^9}},
 CellLabel->
  "In[360]:=",ExpressionUUID->"2a3f0903-70fd-4b2f-977b-5520b7ece475"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWidthsWriteFile", "[", "strs___", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmpfile", "=", 
       RowBox[{"OpenWrite", "[", "\"\<TexActWidthTest.tex\>\"", "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WriteString", "[", 
       RowBox[{"tmpfile", ",", 
        RowBox[{"TexInitLatexCode", "[", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\newlength{\\\\widthofexpr}\n\
\\\\newcommand{\\\\testwidth}[1]{\\\\settowidth{\\\\widthofexpr}{\\\\hbox{$\\\
\\displaystyle{}#1$}}}\n\
\\\\newcommand{\\\\writewidth}[1]{\\\\settowidth{\\\\widthofexpr}{\\\\hbox{$\\\
\\displaystyle{}#1$}}\n\\\\immediate\\\\write0{\\\\the\\\\widthofexpr}}\n\
\\\\begin{document}\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"tmpfile", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<\\\\testwidth{\>\"", ",", "#", ",", "\"\<}\\n\>\""}], 
           "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "strs", "}"}]}], ";", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", "\"\<\\\\immediate\\\\write0{xActWidthStart}\\n\>\""}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\immediate\\\\write0{\\\\the\\\\textwidth}\\n\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"tmpfile", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<\\\\writewidth{\>\"", ",", "#", ",", "\"\<}\\n\>\""}],
            "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "strs", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "tmpfile", ",", 
        "\"\<\\\\immediate\\\\write0{xActWidthEnd}\n\\\\end{document}\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "tmpfile", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5667368665048637`*^9, 3.566737158694377*^9}, {
   3.5667375329026356`*^9, 3.5667375603430834`*^9}, {3.5667384453678555`*^9, 
   3.5667384669738936`*^9}, {3.56673869190849*^9, 3.566738694217294*^9}, {
   3.566738914280682*^9, 3.5667389242958994`*^9}, {3.566738957477158*^9, 
   3.566739032123289*^9}, {3.5668338784885716`*^9, 3.5668338942445993`*^9}, {
   3.5668379798323755`*^9, 3.566837984652784*^9}, {3.582277943697157*^9, 
   3.582277947628364*^9}, {3.582278714357714*^9, 3.5822787257925344`*^9}, 
   3.582278792919452*^9, {3.587964407921297*^9, 3.5879644092784996`*^9}, {
   3.588082594863217*^9, 3.5880825961736193`*^9}, {3.588328100892034*^9, 
   3.588328139143301*^9}, 3.5883285196747694`*^9, {3.61639822081534*^9, 
   3.6163982298228555`*^9}},
 CellLabel->
  "In[361]:=",ExpressionUUID->"f25e918e-27af-4d1c-a3b1-8ad2608da85d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractTexWidths", "[", "str1_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str2", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"str1", ",", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "str1", ",", "\"\<xActWidthStart\>\"", ",", "1", ",", "1"}], 
           "]"}]}]}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ToExpression", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<pt\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}], "/@", 
       RowBox[{"Take", "[", 
        RowBox[{"str2", ",", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"First", "@", 
            RowBox[{"Position", "[", 
             RowBox[{
             "str2", ",", "\"\<xActWidthEnd\>\"", ",", "1", ",", "1"}], 
             "]"}]}]}], "-", "1"}]}], "]"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5667392386832523`*^9, 3.566739265406099*^9}, {
  3.5822788277387133`*^9, 3.582278828222314*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"cad804dc-1c05-4f23-b227-27c04690fc77"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWidths", "[", "strs___", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TexOut", ",", "errorpos"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<TexWidth call with list length \>\"", ",", " ", 
         RowBox[{"Length", "@", 
          RowBox[{"{", "strs", "}"}]}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDirectory", "[", "$TexTmpDirectory", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexWidthsWriteFile", "[", "strs", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TexOut", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{
         "\"\<!\>\"", "<>", "$LatexExecutable", "<>", 
          "\"\< TexActWidthTest.tex\>\""}], ",", "String"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "TexOut"}], "\[Equal]", "0"}], ",", 
        "\"\<Could not find Latex. Check if $LatexExecutable contains the \
correct name and path.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"errorpos", "=", 
       RowBox[{"DeleteFile", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<TexActWidthTest.tex\>\"", ",", "\"\<TexActWidthTest.log\>\"", 
          ",", "\"\<TexActWidthTest.aux\>\""}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"errorpos", "=!=", "Null"}], ",", 
        RowBox[{
        "Print", "[", "\"\<Tex Error: could not delete temporary files\>\"", 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ResetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "TexOut", ",", "\"\<xActWidthEnd\>\"", ",", "1", ",", "1"}], 
           "]"}]}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ExtractTexWidths", "@", "TexOut"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorpos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"TexOut", ",", 
            RowBox[{"str_String", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "StartOfString", " ", "~~", " ", "\"\<!\>\"", "~~", 
                  "___"}]}], "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "errorpos"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Drop", "[", 
               RowBox[{"TexOut", ",", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"First", "@", "errorpos"}]}], "-", "1"}]}], 
               "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
              RowBox[{"Sequence", "@@", "TexOut"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<Tex Error\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5880820151349983`*^9, 3.5880820156497993`*^9}, {
  3.5880826026164303`*^9, 3.588082604082833*^9}, {3.588314020662237*^9, 
  3.58831404499828*^9}, {3.6834481355226994`*^9, 3.683448136062705*^9}, {
  3.68344817159406*^9, 3.6834482209445534`*^9}, {3.6834482672450166`*^9, 
  3.6834483233455777`*^9}, {3.727335121912364*^9, 3.72733517111191*^9}, {
  3.727335283437677*^9, 3.7273352857548575`*^9}, {3.727340688164119*^9, 
  3.727340692198415*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"831d8051-a733-4652-864c-bb8024710593"]
}, Closed]],

Cell[CellGroupData[{

Cell["6.2. TexPrintAlignedEquations", "Subsection",
 CellChangeTimes->{{3.5822792082243814`*^9, 3.5822792262580137`*^9}, 
   3.5823534292637043`*^9, 
   3.6190852087918725`*^9},ExpressionUUID->"24183a8c-ad83-4120-aa8a-\
d70bf89d9e26"],

Cell["\<\
Thomas\[CloseCurlyQuote] code for typesetting a list of equations in an \
aligned environment. Use $TexprintPageWidth to adjust the linebreaking.\
\>", "Text",
 CellChangeTimes->{{3.5822792405320387`*^9, 3.5822794098547363`*^9}, {
  3.582279477122054*^9, 3.582279533204152*^9}, {3.582281862071843*^9, 
  3.5822818631014447`*^9}, {3.582353436985718*^9, 3.582353490993013*^9}, {
  3.5823535218186665`*^9, 
  3.582353528604679*^9}},ExpressionUUID->"a283ceba-2dc7-416d-b3e1-\
d9d5183a30fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexPrintPageWidth", "=", "latextextwidth"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.5823533085350924`*^9, 3.582353340218748*^9, 
  3.5883296440789447`*^9},
 CellLabel->
  "In[364]:=",ExpressionUUID->"a454ed16-81b7-4a28-848a-967a9420c5c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TexPrintAlignedEquations", "[", 
    RowBox[{"eq_Equal", ",", "x___"}], "]"}], ":=", 
   RowBox[{"TexPrintAlignedEquations", "[", 
    RowBox[{
     RowBox[{"{", "eq", "}"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TexPrintAlignedEquations", "[", 
    RowBox[{"eq_", ",", "x___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"TexPrintAlignedEquations", "[", 
     RowBox[{
      RowBox[{"{", "eq", "}"}], ",", "x"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Head", "[", "eq", "]"}], "==", "Equal"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.582352460861911*^9, 3.582352487896758*^9}, {
  3.6834510110646477`*^9, 3.6834510232076473`*^9}, {3.6836137413956738`*^9, 
  3.6836137425557203`*^9}, {3.684599819839319*^9, 3.6845998199693193`*^9}, {
  3.6845998668553905`*^9, 3.6845998695613947`*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"3fb90955-d9a0-4d4d-9e02-005de5df5566"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LHSpart", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", "a"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588316016438143*^9, 3.588316054003009*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"c1f0ab1b-879a-4526-a6b3-80dbac744417"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSpart", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", "b"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5883160602898197`*^9, 3.588316062224223*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"ea597879-63fe-4d41-a8b7-454216a6691e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LHSpart", "[", "b_", "]"}], ":=", "\"\<\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588316088354269*^9, 3.5883160974490848`*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"6df28451-7490-4c72-9600-83884d04b49a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHSpart", "[", "b_", "]"}], ":=", "b"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5883161074331026`*^9, 3.5883161092427053`*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"0f3336f6-a0a8-4f13-812a-6827d68d656c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"TexPrintAlignedEquations", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TexPrintAlignedEquations", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Labels", "\[Rule]", "False"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6834472856331806`*^9, 3.68344728653319*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"bc434725-184f-4283-8393-406d3c6f392a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexLabelName", "[", "str_String", "]"}], ":=", 
   RowBox[{"\"\<eq:\>\"", "<>", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"str", ",", 
        RowBox[{"CharacterEncoding", "\[Rule]", "\"\<ASCII\>\""}]}], "]"}], 
      ",", 
      RowBox[{
       RowBox[{"\"\<\\\\[\>\"", "~~", 
        RowBox[{"a", ":", 
         RowBox[{"ShortestMatch", "[", "___", "]"}]}], "~~", "\"\<]\>\""}], 
       "\[RuleDelayed]", "a"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6836140818020988`*^9, 3.683614097792898*^9}, {
  3.683614245541402*^9, 3.683614248881569*^9}, {3.7273434195629854`*^9, 
  3.727343428639646*^9}, {3.7273434732750053`*^9, 3.7273435231662397`*^9}, {
  3.7273436329828353`*^9, 3.7273436413121157`*^9}, {3.7273438014484262`*^9, 
  3.7273438124049234`*^9}},
 CellLabel->
  "In[373]:=",ExpressionUUID->"630e0550-8ab1-4abc-83aa-25b2794471b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TexPrintAlignedEquations", "[", 
   RowBox[{
    RowBox[{"eqlist", ":", 
     RowBox[{"{", "eqs___", "}"}]}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TexLHS", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TexPrint", "[", 
          RowBox[{"xAct`TexAct`Private`LHSpart", "@", "#"}], "]"}], "&"}], "/@",
         "eqlist"}]}], ",", 
      RowBox[{"TexRHS", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TexPrint", "[", 
          RowBox[{"xAct`TexAct`Private`RHSpart", "@", "#"}], "]"}], "&"}], "/@",
         "eqlist"}]}], ",", "splittableRHSPositions", ",", "splittedRHS", ",",
       "AllWidths", ",", "LHSWidths", ",", "RHSWidths", ",", "MaxRHSWidth", 
      ",", "pagewidth", ",", "RHSBreakPositions", ",", 
      RowBox[{"eqnames", "=", 
       RowBox[{"{", 
        RowBox[{"ReleaseHold", "[", 
         RowBox[{"ToString", "/@", 
          RowBox[{"HoldForm", "/@", 
           RowBox[{"Hold", "[", "eqs", "]"}]}]}], "]"}], "}"}]}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TexLHS", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"#", ",", "\"\<={}\>\""}], "]"}], "&"}], "/@", "TexLHS"}], 
       ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "1", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}], ",", 
          RowBox[{"TexBreakString", "\[Rule]", "\"\<\\n\>\""}]}], "]"}], 
        "&"}], "/@", "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"splittableRHSPositions", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"SplittingFunction", "[", 
         RowBox[{"#", ",", 
          RowBox[{"TexBreakAt", "/.", 
           RowBox[{"Options", "[", "TexBreak", "]"}]}], ",", 
          RowBox[{"TexBreakInParenthesis", "/.", 
           RowBox[{"Options", "[", "TexBreak", "]"}]}]}], "]"}], "&"}], "/@", 
       "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"splittedRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"#2", ",", "1"}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"#2", "-", "1"}], ",", 
               RowBox[{"StringLength", "@", "#1"}]}], "]"}]}], "}"}], "]"}]}],
          "]"}], "&"}], "@@@", 
       RowBox[{"(", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"TexRHS", ",", "splittableRHSPositions"}], "}"}], "]"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AllWidths", "=", 
      RowBox[{"TexWidths", "@@", 
       RowBox[{"Join", "[", 
        RowBox[{"TexLHS", ",", 
         RowBox[{"Join", "@@", "splittedRHS"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pagewidth", "=", 
      RowBox[{"First", "@", "AllWidths"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"LHSWidths", "=", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"Rest", "@", "AllWidths"}], ",", 
        RowBox[{"Length", "@", "TexLHS"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RHSWidths", "=", 
      RowBox[{"partitionRagged", "[", 
       RowBox[{
        RowBox[{"Drop", "[", 
         RowBox[{"AllWidths", ",", 
          RowBox[{"1", "+", 
           RowBox[{"Length", "@", "TexLHS"}]}]}], "]"}], ",", 
        RowBox[{"Length", "/@", "splittedRHS"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxRHSWidth", "=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"$TexPrintPageWidth", "/.", 
          RowBox[{"latextextwidth", "\[Rule]", "pagewidth"}]}], ")"}], "-", 
        RowBox[{"Max", "@", "LHSWidths"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RHSBreakPositions", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"PointBreakingFunction", "[", 
         RowBox[{
          RowBox[{"{", "MaxRHSWidth", "}"}], ",", "MaxRHSWidth", ",", "#1", 
          ",", "pagewidth", ",", "#2"}], "]"}], "&"}], "@@@", 
       RowBox[{"(", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"RHSWidths", ",", "splittableRHSPositions"}], "}"}], "]"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringInsert", "[", 
         RowBox[{"#1", ",", "\"\<\\\\nonumber\\\\\\\\\\n&\>\"", ",", "#2"}], 
         "]"}], "&"}], "@@@", 
       RowBox[{"(", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"TexRHS", ",", "RHSBreakPositions"}], "}"}], "]"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TexRHS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
          "\"\<\\n\\\\nonumber\>\"", "\[Rule]", "\"\<\\\\nonumber\>\""}]}], 
         "]"}], "&"}], "/@", "TexRHS"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\begin{align}\\n\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"#1", ",", "\"\<&\>\"", ",", "#2", ",", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"And", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Labels", "]"}], ",", 
                    RowBox[{"NameQ", "[", "#3", "]"}]}], "]"}], ",", 
                   RowBox[{"StringJoin", "[", 
                    RowBox[{"\"\< \\\\label{\>\"", ",", 
                    RowBox[{"TexLabelName", "[", "#3", "]"}], ",", 
                    "\"\<}\>\""}], "]"}], ",", "\"\<\>\""}], "]"}]}], "]"}], 
               "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"TexLHS", ",", "TexRHS", ",", "eqnames"}], "}"}]}], 
             "]"}], ",", "\"\<,\\\\\\\\\\n\>\""}], "]"}], "]"}], ",", 
         RowBox[{
         "\"\<,\\\\\\\\\\n=\>\"", "\[Rule]", " ", "\"\<\\\\\\\\\\n=\>\""}]}], 
        "]"}], ",", "\"\<.\\n\\\\end{align}\>\""}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexPrintAlignedEquations", "[", 
   RowBox[{"other_", ",", "x___"}], "]"}], ":=", 
  RowBox[{"TexPrintAlignedEquations", "[", 
   RowBox[{
    RowBox[{"Evaluate", "@", "other"}], ",", "x"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.582350630150895*^9, 3.5823507144690437`*^9}, {
   3.5823507687727385`*^9, 3.582350874228924*^9}, {3.582350904492977*^9, 
   3.5823511035961266`*^9}, {3.5823511561536193`*^9, 3.582351343977949*^9}, {
   3.5823514728497753`*^9, 3.5823515379642897`*^9}, {3.582351571114348*^9, 
   3.58235158382837*^9}, 3.582351806643562*^9, {3.582351844926029*^9, 
   3.582351871711276*^9}, {3.582352037945168*^9, 3.5823521056024866`*^9}, {
   3.582352163135388*^9, 3.5823522668755703`*^9}, {3.582352317653659*^9, 
   3.582352410723423*^9}, {3.5883161246243324`*^9, 3.58831615733759*^9}, 
   3.588319134767502*^9, {3.5883257446774955`*^9, 3.5883257892467737`*^9}, {
   3.588328364626097*^9, 3.588328420739396*^9}, {3.588329357584441*^9, 
   3.5883293619992495`*^9}, {3.5883295612427993`*^9, 3.588329586967244*^9}, 
   3.6834472988633127`*^9, 3.683448598531354*^9, {3.683614113003659*^9, 
   3.683614118243921*^9}, {3.684599879838411*^9, 3.684599903538447*^9}, {
   3.727341154613081*^9, 3.727341179464419*^9}, {3.727343461136676*^9, 
   3.72734346932593*^9}, {3.727343507919178*^9, 3.72734351806316*^9}, {
   3.7273436312192554`*^9, 3.7273436454137173`*^9}, {3.7273438215082183`*^9, 
   3.727343830582049*^9}, 3.7274106036178393`*^9},
 CellLabel->
  "In[374]:=",ExpressionUUID->"efd33116-231f-4517-86d5-3e578a3238cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TexPrintAlignedExpressions", "[", "list_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Texed", "=", 
      RowBox[{"TexPrint", "/@", "list"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "1", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}], ",", 
          RowBox[{"TexBreakString", "\[Rule]", "\"\<\\n\>\""}]}], "]"}], 
        "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TexBreak", "[", 
         RowBox[{"#", ",", "$TexPrintPageWidth", ",", 
          RowBox[{"TexBreakBy", "\[Rule]", "\"\<TexPoint\>\""}], ",", 
          RowBox[{
          "TexBreakString", "\[Rule]", "\"\<\\\\nonumber\\\\\\\\\\n&\>\""}]}],
          "]"}], "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Texed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
          "\"\<\\n\\\\nonumber\>\"", "\[Rule]", "\"\<\\\\nonumber\>\""}]}], 
         "]"}], "&"}], "/@", "Texed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<\\\\begin{align}\\n&\>\"", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{"Texed", ",", "\"\<,\\\\\\\\\\n&\>\""}], "]"}], "]"}], ",", 
       "\"\<.\\n\\\\end{align}\>\""}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588327304915236*^9, 3.5883273473629103`*^9}, {
   3.588327400059803*^9, 3.5883275744057093`*^9}, {3.588327891149666*^9, 
   3.588327901586084*^9}, 3.5883279884314365`*^9, {3.5883296105544853`*^9, 
   3.588329629134118*^9}},
 CellLabel->
  "In[376]:=",ExpressionUUID->"e0fa29d1-8496-4198-b947-d25ba142b1d4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["7. TexView", "Section",
 CellChangeTimes->{
  3.54501505147226*^9, {3.5880787462220497`*^9, 3.588078782258113*^9}, {
   3.5880831976346755`*^9, 3.588083198352277*^9}, 3.6190852110618753`*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"211a0c3e-6043-415b-9795-81a106a8c667"],

Cell[CellGroupData[{

Cell["7.1. TexView", "Subsection",
 CellChangeTimes->{{3.5880787928973317`*^9, 3.588078796485338*^9}, {
   3.5880826484025106`*^9, 3.5880826489641113`*^9}, 
   3.619085213011894*^9},ExpressionUUID->"78944756-5d81-434f-996b-\
b18d162abb2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexViewExt", "=", "\"\<.pdf\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588314511329899*^9, 3.5883145172267094`*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"b233e755-e197-4d30-bb48-a9199877c4db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddEquationMarks", "[", 
    RowBox[{"string_", ",", 
     RowBox[{"mark_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{
    "mark", ",", "\[IndentingNewLine]", "False", ",", " ", "string", ",", 
     "\[IndentingNewLine]", "Automatic", ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"string", ",", "6"}], "]"}], "===", "\"\<\\\\begin\>\""}], 
       ",", "string", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"StringMatchQ", "[", 
           RowBox[{"string", ",", 
            RowBox[{"___", "~~", " ", "\"\<\\\\\\\\\>\"", "~~", "___"}]}], 
           "]"}]}], ",", 
         RowBox[{"AddEquationMarks", "[", 
          RowBox[{"string", ",", "\"\<equation\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"firstlinebreak", "=", 
             RowBox[{"Last", "@", 
              RowBox[{"First", "@", 
               RowBox[{"StringPosition", "[", 
                RowBox[{"string", ",", " ", "\"\<\\\\\\\\\>\"", ",", "1"}], 
                "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"string", ",", "firstlinebreak"}], "]"}], ",", 
               RowBox[{"___", "~~", "\"\<&\>\"", "~~", "___"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AddEquationMarks", "[", 
              RowBox[{"string", ",", "\"\<eqnarray\>\""}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"string", ",", "firstlinebreak"}], "]"}], ",", 
                 RowBox[{"___", "~~", "\"\<=\>\"", "~~", "___"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"AddEquationMarks", "[", 
                RowBox[{
                 RowBox[{"StringReplace", "[", 
                  RowBox[{"string", ",", 
                   RowBox[{"\"\<=\>\"", "\[Rule]", "\"\<&=&\>\""}], ",", 
                   "1"}], "]"}], ",", "\"\<eqnarray\>\""}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AddEquationMarks", "[", 
                RowBox[{
                 RowBox[{"StringJoin", "[", 
                  RowBox[{"\"\<&&\>\"", ",", "string"}], "]"}], ",", 
                 "\"\<eqnarray\>\""}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", "_", ",", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "\"\<\\\\begin{\>\"", ",", "mark", ",", "\"\<}\\n\>\"", ",", " ", 
       "string", ",", " ", "\"\<\\n\\\\end{\>\"", ",", "mark", ",", 
       "\"\<}\\n\>\""}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588079319554257*^9, 3.5880794857725487`*^9}, 
   3.5880800377659187`*^9, {3.5880802053570127`*^9, 3.5880802098966208`*^9}, 
   3.588314579814019*^9, {3.5883146261461005`*^9, 3.588314628486105*^9}, {
   3.5883147200426655`*^9, 3.5883147229130707`*^9}, {3.58831480802682*^9, 
   3.5883148370272713`*^9}, {3.5883153615479927`*^9, 
   3.5883154354609222`*^9}, {3.588315498625433*^9, 3.5883155267210827`*^9}, {
   3.5883155690751567`*^9, 3.5883155921787977`*^9}, {3.588315699241785*^9, 
   3.588315702985792*^9}, {3.58831574744587*^9, 3.588315870779687*^9}, 
   3.588315905208947*^9, 3.5883187976509094`*^9, {3.5883189126699114`*^9, 
   3.5883189764428234`*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"207d5836-2b69-4498-b7a0-ab50a8bacb73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexWriteFile", "[", 
    RowBox[{"str_String", ",", "file_String"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"outfile", "=", 
       RowBox[{"OpenWrite", "[", "file", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", 
        RowBox[{"TexInitLatexCode", "[", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", "\"\<\\\\begin{document}\\n\>\""}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"outfile", ",", "str"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "outfile", ",", 
        "\"\<\\n\\\\immediate\\\\write0{TexActFinished}\n\
\\\\end{document}\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "outfile", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5667368665048637`*^9, 3.566737158694377*^9}, {
   3.5667375329026356`*^9, 3.5667375603430834`*^9}, {3.5667384453678555`*^9, 
   3.5667384669738936`*^9}, {3.56673869190849*^9, 3.566738694217294*^9}, {
   3.566738914280682*^9, 3.5667389242958994`*^9}, {3.566738957477158*^9, 
   3.566739032123289*^9}, {3.5668338784885716`*^9, 3.5668338942445993`*^9}, {
   3.5668379798323755`*^9, 3.566837984652784*^9}, {3.582277943697157*^9, 
   3.582277947628364*^9}, {3.582278714357714*^9, 3.5822787257925344`*^9}, 
   3.582278792919452*^9, {3.587964407921297*^9, 3.5879644092784996`*^9}, {
   3.588080454005849*^9, 3.5880805702260537`*^9}, {3.5880806297089577`*^9, 
   3.588080630457759*^9}, {3.58808074505556*^9, 3.5880807973000526`*^9}, {
   3.5880808368929214`*^9, 3.58808084734494*^9}, {3.5915978293329887`*^9, 
   3.59159783035299*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"470e9cb7-d2a1-4ed0-a120-a1422819a844"],

Cell["\<\
TexView can open the pdf file in Mathematica if $TexViewInternal==True. \
Thanks Leo Stein for the suggestion and code.\
\>", "Text",
 CellChangeTimes->{{3.7285504500106983`*^9, 3.7285505342128997`*^9}},
 ExpressionUUID -> "bb55281a-ba18-449a-8a9b-2dad59a77e4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexViewInternal", "=", "False"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.728550317799204*^9, 3.728550329777499*^9}, {
  3.7285503717466435`*^9, 3.728550374961692*^9}, {3.7285504286309195`*^9, 
  3.7285504354939013`*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"8d6ad377-bffd-466d-8846-6c76c6bc2c95"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexView", "[", 
    RowBox[{"texstr_String", ",", 
     RowBox[{"file_String:", "\"\<TexActView\>\""}], ",", 
     RowBox[{"openfileq_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TexOut", ",", "errorpos"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"SetDirectory", "[", "$TexDirectory", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"$TexViewInternal", ",", "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "$TexInitLatexClassCode", "=", "$TexInitLatexInternalClassCode"}], 
           "}"}], ",", 
          RowBox[{"TexWriteFile", "[", 
           RowBox[{"texstr", ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"file", ",", "\"\<.tex\>\""}], "]"}]}], "]"}]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TexWriteFile", "[", 
          RowBox[{"texstr", ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"file", ",", "\"\<.tex\>\""}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"TexOut", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"\"\<!\>\"", "<>", "$LatexExecutable", "<>", "\"\< \>\""}],
            ",", "file", ",", "\"\<.tex\>\""}], "]"}], ",", "String"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "TexOut"}], "\[Equal]", "0"}], ",", 
        "\"\<Could not find Latex. Check if $LatexExecutable contains the \
correct name and path.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ResetDirectory", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
           "TexOut", ",", "\"\<TexActFinished\>\"", ",", "1", ",", "1"}], 
           "]"}]}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SetDirectory", "[", "$TexDirectory", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<Typesetting OK.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"openfileq", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"$TexViewInternal", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Importing file: \>\"", ",", " ", "file", ",", 
                "$TexViewExt"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"result", "=", 
                  RowBox[{"Import", "[", 
                   RowBox[{"StringJoin", "[", 
                    RowBox[{"file", ",", "$TexViewExt"}], "]"}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ResetDirectory", "[", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"result", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Opening file: \>\"", ",", " ", "file", ",", 
                "$TexViewExt"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"SystemOpen", "[", 
               RowBox[{"StringJoin", "[", 
                RowBox[{"file", ",", "$TexViewExt"}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ResetDirectory", "[", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorpos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"TexOut", ",", 
            RowBox[{"str_String", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringMatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "StartOfString", " ", "~~", " ", "\"\<!\>\"", "~~", 
                  "___"}]}], "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "errorpos"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Drop", "[", 
               RowBox[{"TexOut", ",", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"First", "@", "errorpos"}]}], "-", "1"}]}], 
               "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Tex Error:\\n\>\"", ",", 
              RowBox[{"Sequence", "@@", "TexOut"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<Tex Error\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5880808916022177`*^9, 3.58808102911646*^9}, {
   3.588081061408516*^9, 3.5880810645285215`*^9}, {3.588081134354244*^9, 
   3.5880811620286927`*^9}, 3.588081480739253*^9, {3.5880817583573403`*^9, 
   3.5880818022090178`*^9}, {3.5880818778703575`*^9, 3.588081878135558*^9}, {
   3.5880821751912794`*^9, 3.5880821842704954`*^9}, 3.588082344030376*^9, {
   3.588082396228068*^9, 3.588082490779834*^9}, {3.5880826813965683`*^9, 
   3.588082687152979*^9}, {3.5880830216195664`*^9, 3.588083082818474*^9}, {
   3.588314071331126*^9, 3.5883140800671415`*^9}, {3.588314536321143*^9, 
   3.5883145395815487`*^9}, {3.610714560731741*^9, 3.6107146126018133`*^9}, {
   3.6834483651559954`*^9, 3.683448365525999*^9}, {3.728550896238967*^9, 
   3.728551237345513*^9}, {3.728551516568971*^9, 3.7285515478326535`*^9}},
 CellLabel->
  "In[381]:=",ExpressionUUID->"7fe7dddf-03ee-480c-aa20-6553d33ff139"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"eqlist", ":", 
     RowBox[{"{", 
      RowBox[{"eq_Equal", ",", "eqs___"}], " ", "}"}]}], ",", "opt___"}], 
   "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedEquations", "[", "eqlist", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"list_List", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedExpressions", "[", "list", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"eq_Equal", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"TexPrintAlignedEquations", "[", "eq", "]"}], ",", "opt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TexView", "[", 
   RowBox[{"expr_", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"TexView", "[", 
   RowBox[{
    RowBox[{"AddEquationMarks", "[", 
     RowBox[{
      RowBox[{"TexPrint", "[", "expr", "]"}], ",", "Automatic"}], "]"}], ",", 
    "opt"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588082251163413*^9, 3.5880823173075294`*^9}, {
   3.5880831103369217`*^9, 3.58808318304865*^9}, {3.5883146112792745`*^9, 
   3.588314613244878*^9}, 3.588325925294613*^9, {3.5883260153379707`*^9, 
   3.588326016102372*^9}, {3.588326121418157*^9, 3.5883261307625737`*^9}, {
   3.5883264389255147`*^9, 3.588326735857436*^9}, {3.588327792401492*^9, 
   3.5883278118859262`*^9}, {3.591597869353045*^9, 3.5915978798330593`*^9}, {
   3.591597921613118*^9, 3.5915979675631824`*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"17dd8740-381a-4d90-8503-e6b6edc4df5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TexPort", "[", 
    RowBox[{"expr_", ",", " ", "file_String"}], "]"}], ":=", 
   RowBox[{"TexView", "[", 
    RowBox[{"expr", ",", "file", ",", "False"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61071469566193*^9, 3.6107147418119946`*^9}},
 CellLabel->
  "In[386]:=",ExpressionUUID->"35a177e7-b492-4b07-99e2-deda31264352"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["8. Color support", "Section",
 CellChangeTimes->{
  3.54501505147226*^9, {3.5880787462220497`*^9, 3.588078782258113*^9}, {
   3.5880831976346755`*^9, 3.588083198352277*^9}, {3.604593894578455*^9, 
   3.6045939032884674`*^9}, 3.6190852179459333`*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"c83f706e-9f0e-49b0-aa24-ab6d1cb6b55e"],

Cell[CellGroupData[{

Cell["8.1. EnableTexColor", "Subsection",
 CellChangeTimes->{{3.5880787928973317`*^9, 3.588078796485338*^9}, {
  3.5880826484025106`*^9, 3.5880826489641113`*^9}, {3.6045939062184715`*^9, 
  3.604593914038482*^9}, {3.6463815455207376`*^9, 
  3.646381545820739*^9}},ExpressionUUID->"5007de29-5958-4638-848c-\
c37120e2bec3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnableTexColor", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"TexColor", "[", 
       RowBox[{"str_", ",", "col_RGBColor"}], "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<\\\\textcolor[rgb]\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"List", "@@", 
          RowBox[{"(", "col", ")"}]}], "]"}], ",", "\"\<{\>\"", ",", "str", 
        ",", "\"\<}\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TexColor", "[", 
       RowBox[{"str_", ",", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "]"}], "|", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"1", ",", "0", ",", "0"}], "]"}]}]}], "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<\\\\red{\>\"", ",", "str", ",", "\"\<}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TexColor", "[", 
       RowBox[{"str_", ",", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "]"}], "|", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0", ",", "1", ",", "0"}], "]"}]}]}], "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<\\\\green{\>\"", ",", "str", ",", "\"\<}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TexColor", "[", 
       RowBox[{"str_", ",", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "]"}], "|", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0", ",", "0", ",", "1"}], "]"}]}]}], "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<\\\\blue{\>\"", ",", "str", ",", "\"\<}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TexStyleBox", "[", 
       RowBox[{"str_", ",", "rules__"}], "]"}], ":=", 
      RowBox[{"TexColor", "[", 
       RowBox[{
        RowBox[{"Tex", "@", "str"}], ",", 
        RowBox[{"FontColor", "/.", 
         RowBox[{"{", "rules", "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$TexInitLatexPackages", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"$TexInitLatexPackages", ",", "\"\<{color}\>\""}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$TexInitLatexExtraCode", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"$TexInitLatexExtraCode", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\\\\newcommand{\\\\red}[1]{\\\\textcolor{red}{#1}}\>\"", ",", 
           "\"\<\\\\newcommand{\\\\green}[1]{\\\\textcolor{green}{#1}}\>\"", 
           ",", "\"\<\\\\newcommand{\\\\blue}[1]{\\\\textcolor{blue}{#1}}\>\"\
"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6006237472958565`*^9, 3.600623848865999*^9}, {
   3.600623905156078*^9, 3.600623908666083*^9}, {3.6045942175880227`*^9, 
   3.6045942224580297`*^9}, {3.646381579690786*^9, 3.646381581250788*^9}, {
   3.648207765247387*^9, 3.6482078106374507`*^9}, {3.648207861517522*^9, 
   3.648207870807535*^9}, {3.6482081068878655`*^9, 3.648208132097901*^9}, {
   3.6977390212099504`*^9, 3.697739034682969*^9}, {3.6978216467494245`*^9, 
   3.697821657161439*^9}, 3.697821761574587*^9, {3.7284817321414986`*^9, 
   3.728481842592291*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"4d278347-1d42-4be5-9493-ba483c1b313c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DisableTexColor", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"TexStyleBox", "[", 
       RowBox[{"str_", ",", "rules__"}], "]"}], "=."}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$TexInitLatexPackages", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"$TexInitLatexPackages", ",", "\"\<{color}\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"$TexInitLatexExtraCode", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"$TexInitLatexExtraCode", ",", 
        RowBox[{"Alternatives", "[", 
         RowBox[{
         "\"\<\\\\newcommand{\\\\red}[1]{\\\\textcolor{red}{#1}}\>\"", ",", 
          "\"\<\\\\newcommand{\\\\green}[1]{\\\\textcolor{green}{#1}}\>\"", 
          ",", "\"\<\\\\newcommand{\\\\blue}[1]{\\\\textcolor{blue}{#1}}\>\""}\
], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6006237472958565`*^9, 3.600623848865999*^9}, {
   3.600623905156078*^9, 3.600623908666083*^9}, {3.604594118417884*^9, 
   3.604594150917929*^9}, {3.6045942288780384`*^9, 3.6045942996281376`*^9}, {
   3.6463815881707983`*^9, 3.6463815900408*^9}, {3.6977390447849836`*^9, 
   3.6977390499269905`*^9}, 3.6978218564827204`*^9, {3.728481858872007*^9, 
   3.728481862344906*^9}},
 CellLabel->
  "In[388]:=",ExpressionUUID->"0a4b9d9f-470d-4dd3-922c-85114e88ca12"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["9. EndPackage", "Section",
 CellChangeTimes->{3.54501505147226*^9, 3.5880787289840193`*^9, 
  3.604593933347625*^9, 3.6190852199059362`*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"f02c611a-d82e-4ed9-9f6f-aa6c0dce7f33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[389]:=",ExpressionUUID->"956c3d57-f836-45f7-a2ce-e62890309034"],

Cell[BoxData["\<\"xAct`TexAct`Private`\"\>"], "Output",
 CellLabel->
  "Out[389]=",ExpressionUUID->"f4493b03-0240-4d39-ac5e-f359bbccf3d4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[390]:=",ExpressionUUID->"f8aa1644-62a2-47dc-88fc-e03f6c1b3121"]
}, Closed]],

Cell[CellGroupData[{

Cell["10. Examples", "Section",
 CellChangeTimes->{
  3.545015052985463*^9, 3.5880787314956236`*^9, 3.6045939358776283`*^9, {
   3.619085221365938*^9, 3.6190852216659384`*^9}},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"90b4b878-6f88-437a-ae3f-a22f6f598e1a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "xAct`xCoba`"}]], "Input",
 CellChangeTimes->{{3.583148963735118*^9, 3.5831489733759346`*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"c78137c7-ea58-4f47-9149-1d5b42229e0a"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[391]:=",ExpressionUUID->"00370647-83db-4a92-8762-8567c1931a52"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xCoba`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.8.4\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2018", ",", "2", ",", "28"}], "}"}]}],
  SequenceForm["Package xAct`xCoba`  version ", "0.8.4", ", ", {2018, 2, 28}],
  
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[391]:=",ExpressionUUID->"4a4f1bd1-ac6c-4d34-823e-f5a3bd6dacea"],

Cell[BoxData["\<\"CopyRight (C) 2005-2018, David Yllanes and Jose M. \
Martin-Garcia, under the General Public License.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[391]:=",ExpressionUUID->"da9df5e8-b01b-49f4-89c7-48520f89dab2"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[391]:=",ExpressionUUID->"d9342429-8d67-4cda-9a65-69bfe861b124"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[391]:=",ExpressionUUID->"245c063d-2977-447d-9c2c-d2325f40208b"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[391]:=",ExpressionUUID->"1d1e3a7f-2fe3-4857-9fd3-525f9d139c5a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefManifold", "[", 
  RowBox[{"M4", ",", "4", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g"}],
     "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[392]:=",ExpressionUUID->"c7dc0213-a85d-438d-9425-2b9e8e705088"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefManifold", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"manifold \"\>", "\[InvisibleSpace]", "M4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefManifold, ": Defining ", 
   "manifold ", $CellContext`M4, ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[392]:=",ExpressionUUID->"9a5ce17f-3158-440a-a507-da9a6a77a741"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefVBundle", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vbundle \"\>", "\[InvisibleSpace]", "TangentM4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefVBundle, ": Defining ", 
   "vbundle ", $CellContext`TangentM4, ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[392]:=",ExpressionUUID->"6d134aa9-7784-4c6c-8657-7bfcb3c7effa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "->", "\"\<\[Tau]\>\""}]}], "]"}]], "Input",
 CellLabel->
  "In[393]:=",ExpressionUUID->"96088e1c-a166-4560-88bb-a2afb78ed650"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[393]:=",ExpressionUUID->"2a411396-af24-4272-bdc0-5bb59d2f5184"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "3"}], 
    RowBox[{"T", "[", 
     RowBox[{"a", ",", 
      RowBox[{"-", "b"}], ",", "c"}], "]"}]}], "+", 
   RowBox[{"7", 
    RowBox[{"T", "[", 
     RowBox[{"d", ",", "f"}], "]"}]}], "+", 
   RowBox[{"Pi", " ", 
    RowBox[{"T", "[", 
     RowBox[{"g", ",", "f"}], "]"}]}], "-", "5"}]}]], "Input",
 CellChangeTimes->{{3.5880805950612974`*^9, 3.588080596200099*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"2e6dbc83-b7e0-418a-9d37-64e5e2d14dde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "5"}], "+", 
  RowBox[{"7", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"d", "f"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`d, $CellContext`f],
    Editable->False]}], "+", 
  RowBox[{"\[Pi]", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"g", "f"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`g, $CellContext`f],
    Editable->False]}], "-", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[Tau]", 
        StyleBox[GridBox[{
           {"a", " ", "c"},
           {" ", "b", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T[$CellContext`a, -$CellContext`b, $CellContext`c],
    Editable->False]}]}]], "Output",
 CellLabel->
  "Out[394]=",ExpressionUUID->"8e56446d-153d-48c8-935f-e53d389b945a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tex", "[", "expr1", "]"}]], "Input",
 CellChangeTimes->{3.5880806017069087`*^9},
 CellLabel->
  "In[395]:=",ExpressionUUID->"609c8ba4-39a5-46fd-8c20-ff398264d12c"],

Cell[BoxData["\<\"-5 + 7 \\\\tau ^{df} + \\\\pi \\\\tau ^{gf} + -3 \\\\tau \
^{a}{}_{b}{}^{c}\"\>"], "Output",
 CellLabel->
  "Out[395]=",ExpressionUUID->"2290906e-292d-4762-967b-1fed998f1bec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", "expr1", "]"}]], "Input",
 CellChangeTimes->{3.588080603656912*^9},
 CellLabel->
  "In[396]:=",ExpressionUUID->"4dbd6ef9-b536-470c-832d-852de568924b"],

Cell[BoxData["\<\"-5 + 7 \\\\tau^{df} + \\\\pi \\\\tau^{gf} - 3 \
\\\\tau^{a}{}_{b}{}^{c}\"\>"], "Output",
 CellLabel->
  "Out[396]=",ExpressionUUID->"083364eb-133b-4590-8b18-7463f9055267"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddEquationMarks", "[", 
  RowBox[{"%", ",", "\"\<equation*\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.5880800203406878`*^9, 3.5880800338503113`*^9}, {
   3.5880801756857605`*^9, 3.5880801890705843`*^9}, {3.588080606589717*^9, 
   3.588080613048129*^9}, 3.58808289876935*^9},
 CellLabel->
  "In[397]:=",ExpressionUUID->"4788f72c-1008-427a-a7c3-423661efdafa"],

Cell[BoxData["\<\"\\\\begin{equation*}\\n-5 + 7 \\\\tau^{df} + \\\\pi \
\\\\tau^{gf} - 3 \\\\tau^{a}{}_{b}{}^{c}\\n\\\\end{equation*}\\n\"\>"], \
"Output",
 CellLabel->
  "Out[397]=",ExpressionUUID->"53895ad9-97dc-40a9-9e98-f8c06af4ddfe"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Prefix\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CovDQ", "[", "CD", "]"}], "^=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymbolOfCovD", "[", "CD", "]"}], "^=", 
   RowBox[{"{", 
    RowBox[{"\"\<;\>\"", ",", "\"\<D\>\""}], "}"}]}], ";"}]}], "Input",
 CellLabel->
  "In[398]:=",ExpressionUUID->"3770b8ba-e8f9-4cb0-b4da-1e8713cbf2de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[401]:=",ExpressionUUID->"04113740-a633-42e4-94fc-f180a550d3a4"],

Cell[BoxData["\<\"D_{a}\\\\tau^{b}{}_{c}\"\>"], "Output",
 CellLabel->
  "Out[401]=",ExpressionUUID->"9519c08c-e0d4-43dc-8372-63230456fb8d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Postfix\>\""}], ";"}]], "Input",
 CellLabel->
  "In[402]:=",ExpressionUUID->"082f6c60-0f64-4ff5-a5d5-54ed5baf9f2d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", 
  RowBox[{
   RowBox[{"CD", "[", 
    RowBox[{"-", "a"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[403]:=",ExpressionUUID->"2efbcf0c-18fc-4c45-ab60-20d8c6e80320"],

Cell[BoxData["\<\"\\\\tau^{b}{}_{c}{}_{;a}\"\>"], "Output",
 CellLabel->
  "Out[403]=",ExpressionUUID->"50dd8b7c-09c8-4d39-a4e4-564c541fdefb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Prefix\>\""}], ";"}]], "Input",
 CellLabel->
  "In[404]:=",ExpressionUUID->"bd2e272b-9a30-4fdb-b805-9fad1f6b3587"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefBasis", "[", 
  RowBox[{"B4", ",", "TangentM4", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.583148956403105*^9, 3.583148998601179*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"f08065bc-0b43-43ab-80d3-108971481e1c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefBasis", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"basis \"\>", "\[InvisibleSpace]", "B4", 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xCoba`DefBasis, ": Defining ", "basis ", $CellContext`B4, ". ", 
   ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"066766a3-969e-4940-a781-bbb05511860d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefCovD", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"parallel derivative \"\>", "\[InvisibleSpace]", 
   RowBox[{"PDB4", "[", 
    RowBox[{"-", "a"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefCovD, ": Defining ", "parallel derivative ", 
   $CellContext`PDB4[-$CellContext`a], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"1a72b60f-1c65-4951-9d26-777ffb88516c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"torsion tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"TorsionPDB4", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "torsion tensor ", 
   $CellContext`TorsionPDB4[$CellContext`a, -$CellContext`b, -$CellContext`c],
    ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"f939ef18-7d06-4199-9cdd-8cac995a0b77"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"non-symmetric Christoffel tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"ChristoffelPDB4", "[", 
    RowBox[{"a", ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", 
   "non-symmetric Christoffel tensor ", 
   $CellContext`ChristoffelPDB4[$CellContext`a, -$CellContext`b, \
-$CellContext`c], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"2f30aa3a-9108-420c-99b8-2791ec1f4652"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Riemann tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RiemannPDB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", "d"}], "]"}], "\[InvisibleSpace]", "\<\". \"\>",
    "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "vanishing Riemann tensor ", 
   $CellContext`RiemannPDB4[-$CellContext`a, -$CellContext`b, \
-$CellContext`c, $CellContext`d], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"2ac9db65-81c4-464b-b38e-4b1a126965a7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"vanishing Ricci tensor \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"RicciPDB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "vanishing Ricci tensor ", 
   $CellContext`RicciPDB4[-$CellContext`a, -$CellContext`b], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"96736346-37c9-47eb-a0db-6bca376ad530"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric +1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaUpB4", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
   "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "antisymmetric +1 density ", 
   $CellContext`etaUpB4[$CellContext`a, $CellContext`b, $CellContext`c, \
$CellContext`d], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"08512c46-c71d-4b3d-b793-94719ae28e51"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric -1 density \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"etaDownB4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefTensor, ": Defining ", "antisymmetric -1 density ", 
   $CellContext`etaDownB4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[405]:=",ExpressionUUID->"5352bc35-aff2-4c24-81a5-69f1d1c92c3e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDBasisExpr", "=", 
  RowBox[{
   RowBox[{"PDB4", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "B4"}]}], "}"}], "]"}], "[", 
   RowBox[{"T", "[", 
    RowBox[{"b", ",", 
     RowBox[{"-", "c"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.583149800144788*^9, 3.5831498073676004`*^9}, {
  3.5831501304441676`*^9, 3.583150136309778*^9}},
 CellLabel->
  "In[406]:=",ExpressionUUID->"2d6b85a5-2de1-44d4-8dbb-c43dec7d6679"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{
    SubscriptBox[
     StyleBox["\[ScriptCapitalD]",
      FontColor->RGBColor[1., 0., 0.]], 
     StyleBox["1",
      FontColor->RGBColor[1., 0., 0.]]], GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {"b", " "},
          {" ", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}]}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  $CellContext`PDB4[{1, -$CellContext`B4}][
   $CellContext`T[$CellContext`b, -$CellContext`c]],
  Editable->False]], "Output",
 CellLabel->
  "Out[406]=",ExpressionUUID->"36a217d6-0085-4f62-9207-5c45ffae943f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.583147037051734*^9, 3.583147040015739*^9}, 
   3.5831488906021895`*^9, {3.5831490114244013`*^9, 3.583149013343205*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"e36b0683-774c-4ad2-8c5b-bc6af7fb9704"],

Cell[BoxData["\<\"\\\\mathcal{D}_{1}\\\\tau^{b}{}_{c}\"\>"], "Output",
 CellLabel->
  "Out[407]=",ExpressionUUID->"54078719-b799-4677-a6ab-8b43a434f02d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"PDB4", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "B4"}]}], "}"}], "]"}], ",", "\"\<\\\\partial_r\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5831488113384504`*^9, 3.58314882837368*^9}, {
   3.58314886270934*^9, 3.58314887952617*^9}, 3.58314981838122*^9, {
   3.5831500264543853`*^9, 3.583150032756796*^9}, {3.5831501469489965`*^9, 
   3.5831501479005985`*^9}},
 CellLabel->
  "In[408]:=",ExpressionUUID->"8c26d6c0-faeb-4044-9a22-99c157e19c0d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "PDBasisExpr"}]], "Input",
 CellChangeTimes->{{3.583147037051734*^9, 3.583147040015739*^9}, 
   3.5831488906021895`*^9, {3.5831490114244013`*^9, 3.583149013343205*^9}, 
   3.583149815682415*^9, 3.5831502599399953`*^9},
 CellLabel->
  "In[409]:=",ExpressionUUID->"1c18372a-47bd-439e-bba4-48f22cc8cafe"],

Cell[BoxData["\<\"\\\\partial_r\\\\tau^{b}{}_{c}\"\>"], "Output",
 CellLabel->
  "Out[409]=",ExpressionUUID->"9e2b6d6a-11b2-452a-b2ac-be96b6f35118"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "B4"}]}], "}"}], ",", "\"\<\\\\partial_r\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.583149876631722*^9, 3.5831498867717395`*^9}, {
  3.5831500420232124`*^9, 3.5831500813820815`*^9}},
 CellLabel->
  "In[410]:=",ExpressionUUID->"fdeafb00-3204-40a6-9167-e4cae12e5603"],

Cell[BoxData[
 RowBox[{"FormatTexBasis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "B4"}], "}"}], ",", "\"\<dr\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.583149876631722*^9, 3.5831498867717395`*^9}, {
  3.5831500420232124`*^9, 3.583150065126853*^9}},
 CellLabel->
  "In[411]:=",ExpressionUUID->"7d7d95db-9a2f-4053-a033-6fd18a572b20"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Basis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "B4"}]}], "}"}], ",", "a"}], "]"}]], "Input",
 CellChangeTimes->{{3.5831489205230417`*^9, 3.583148935405468*^9}, {
  3.583149840704859*^9, 3.5831498672717056`*^9}},
 CellLabel->
  "In[412]:=",ExpressionUUID->"0b91854a-b241-40a1-8c7d-0f2c99fbd8fd"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {"e", 
      StyleBox[GridBox[{
         {" ", "a"},
         {
          StyleBox["1",
           FontColor->RGBColor[1., 0., 0.]], " "}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Basis[{1, -$CellContext`B4}, $CellContext`a],
  Editable->False]], "Output",
 CellLabel->
  "Out[412]=",ExpressionUUID->"3fc3a44f-4e49-43a4-9822-a0b7ac9c7dae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.58314893649747*^9, 3.583148938104273*^9}},
 CellLabel->
  "In[413]:=",ExpressionUUID->"d4351566-4e7b-4315-9aa2-0773741d08cd"],

Cell[BoxData["\<\"\\\\partial_r^{a}\"\>"], "Output",
 CellLabel->
  "Out[413]=",ExpressionUUID->"4d3b7acf-ce2c-4626-b162-b617a4d627df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Basis", "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "B4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5831489205230417`*^9, 3.583148935405468*^9}, {
  3.583149840704859*^9, 3.5831498672717056`*^9}, {3.5831500926921015`*^9, 
  3.5831501001801147`*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"0d84594f-765f-4d65-a457-3f0bcec21513"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {"e", 
      StyleBox[GridBox[{
         {" ", 
          StyleBox["1",
           FontColor->RGBColor[1., 0., 0.]]},
         {"a", " "}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Basis[-$CellContext`a, {1, $CellContext`B4}],
  Editable->False]], "Output",
 CellLabel->
  "Out[414]=",ExpressionUUID->"1fadb33a-6078-485e-b231-3f466b5c5415"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.58314893649747*^9, 3.583148938104273*^9}},
 CellLabel->
  "In[415]:=",ExpressionUUID->"de2d002d-1aca-4480-9915-698938e44599"],

Cell[BoxData["\<\"dr_{a}\"\>"], "Output",
 CellLabel->
  "Out[415]=",ExpressionUUID->"56e6fc16-8e1c-4c2c-8441-c16a19ecb333"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "]"}], ",", "M4"}], "]"}]], "Input",
 CellChangeTimes->{{3.5446036610339346`*^9, 3.5446036644971323`*^9}},
 CellLabel->
  "In[416]:=",ExpressionUUID->"6724f6b6-547b-45be-9f28-bf3a72dfe44b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[Lambda]", "[", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`\[Lambda][], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[416]:=",ExpressionUUID->"d49a3c93-ea0a-44bd-a0f8-a6b4883d0544"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], 
  RowBox[{"T", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}], ",", 
    RowBox[{"-", "c"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[417]:=",ExpressionUUID->"617d821a-b093-45ab-8284-e023079fb3db"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox[GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {" ", " ", " "},
          {"a", "b", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
   Editable->False], 
  SqrtBox["2"]]], "Output",
 CellLabel->
  "Out[417]=",ExpressionUUID->"fc7f1fad-6d8d-41f8-ab38-3e0112d1c4d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5446036936778016`*^9, 3.544603695958932*^9}},
 CellLabel->
  "In[418]:=",ExpressionUUID->"65aa5c4a-9d51-4aac-a9b7-c166eb381bcf"],

Cell[BoxData["\<\"\\\\tfrac{1}{\\\\sqrt{2}}\\\\tau_{abc}\"\>"], "Output",
 CellLabel->
  "Out[418]=",ExpressionUUID->"a7c21220-a69e-4df5-b393-b821822d7289"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "3"}], 
  RowBox[{"Sqrt", "[", "2", "]"}], 
  RowBox[{"\[Lambda]", "[", "]"}]}]], "Input",
 CellLabel->
  "In[419]:=",ExpressionUUID->"ced8519e-c6aa-4245-b24e-1553ae26ed91"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox["2"], " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], "3"]], "Output",
 CellLabel->
  "Out[419]=",ExpressionUUID->"fb6205e0-0c74-4b62-93ae-7a58fa2bc7fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{"\[Lambda]", "[", "]"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"\[Lambda]", "[", "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.544608577367132*^9, 3.544608608952939*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"97ee2517-3cfa-4dcc-a7f7-89e7418d950f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], 
  RowBox[{"1", "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output",
 CellLabel->
  "Out[420]=",ExpressionUUID->"bf6b7e11-9849-46e1-b43e-437fda08e0ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellLabel->
  "In[421]:=",ExpressionUUID->"70cde074-7478-40f1-82cb-252982955b79"],

Cell[BoxData["\<\"\\\\frac{2 + \\\\lambda}{1 + \\\\lambda}\"\>"], "Output",
 CellLabel->
  "Out[421]=",ExpressionUUID->"45474ad5-bfb4-427f-a176-44f399dbb378"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[422]:=",ExpressionUUID->"96d06764-6c54-46d8-a435-5632ea98909e"],

Cell[BoxData["\<\"(1 + \\\\lambda)^{-1} (2 + \\\\lambda)\"\>"], "Output",
 CellLabel->
  "Out[422]=",ExpressionUUID->"a9fa8e98-582f-42aa-b0c9-0bbe813e3787"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fracexpr", "=", 
  RowBox[{
   RowBox[{"2", "/", "3"}], 
   RowBox[{
    RowBox[{"\[Lambda]", "[", "]"}], "^", "2"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"\[Lambda]", "[", "]"}], "+", 
      RowBox[{
       RowBox[{"\[Lambda]", "[", "]"}], "^", "2"}], "-", 
      RowBox[{"3", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", "]"}], "^", "3"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"\[Lambda]", "[", "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7282777655075045`*^9, 3.7282777748199244`*^9}, {
   3.7282778081040792`*^9, 3.7282778161890793`*^9}, 3.7282779032592297`*^9, {
   3.728278120608246*^9, 3.7282781387606697`*^9}, {3.728280948837469*^9, 
   3.728280959446595*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"bacfa753-c77f-4a20-a9f4-1ce880b89132"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox[
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     InterpretationBox[
      StyleBox["\[Lambda]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[Lambda][],
      Editable->False], "+", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox["\[Lambda]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[Lambda][],
       Editable->False], "2"], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       InterpretationBox[
        StyleBox["\[Lambda]",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`\[Lambda][],
        Editable->False], "3"]}]}], ")"}]}], 
  RowBox[{"3", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     InterpretationBox[
      StyleBox["\[Lambda]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[Lambda][],
      Editable->False]}], ")"}]}]]], "Output",
 CellLabel->
  "Out[423]=",ExpressionUUID->"0c10711f-8587-40da-b5c2-14e535319935"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "fracexpr"}]], "Input",
 CellChangeTimes->{3.7282809653556895`*^9},
 CellLabel->
  "In[424]:=",ExpressionUUID->"5d90c74a-5cc3-451d-be3b-4c3ec35dd83c"],

Cell[BoxData["\<\"\\\\frac{2 \\\\lambda^2 (2 + \\\\lambda + \\\\lambda^2 - 3 \
\\\\lambda^3)}{3 (1 + \\\\lambda)}\"\>"], "Output",
 CellLabel->
  "Out[424]=",ExpressionUUID->"0b046e32-ff40-4ef7-9eba-f985cec53c39"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexNoSumInNumerator", "=", "True"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "fracexpr", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7282786562580566`*^9, 3.728278660593625*^9}, 
   3.7282809674891*^9},
 CellLabel->
  "In[425]:=",ExpressionUUID->"11ab5431-f903-4920-9bda-4f565105fe7c"],

Cell[BoxData["\<\"\\\\frac{2 \\\\lambda^2}{3 (1 + \\\\lambda)} (2 + \
\\\\lambda + \\\\lambda^2 - 3 \\\\lambda^3)\"\>"], "Output",
 CellLabel->
  "Out[425]=",ExpressionUUID->"ad6204bc-169e-4fdb-b1a4-e9548b2c0fcd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexNoSumInNumerator", "=", "True"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", 
    RowBox[{"fracexpr", "//.", "ToOrderedPlus"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.728280918128976*^9, 3.728280970091775*^9},
 CellLabel->
  "In[426]:=",ExpressionUUID->"7bf38c93-d315-442b-8905-d6893a24cfae"],

Cell[BoxData["\<\"\\\\frac{2 \\\\lambda^2}{3 (\\\\lambda + 1)} (-3 \
\\\\lambda^3 + \\\\lambda^2 + \\\\lambda + 2)\"\>"], "Output",
 CellLabel->
  "Out[426]=",ExpressionUUID->"c706a608-1572-4d08-8779-f61144e41446"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
  RowBox[{"\[Lambda]", "[", "]"}]}]], "Input",
 CellChangeTimes->{3.544608362872864*^9},
 CellLabel->
  "In[427]:=",ExpressionUUID->"3037f38c-99ee-4786-81b4-16f0b519a3ed"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox["\[Lambda]",
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`\[Lambda][],
   Editable->False], 
  RowBox[{"3", " ", 
   SqrtBox["2"]}]]], "Output",
 CellLabel->
  "Out[427]=",ExpressionUUID->"7e3d8bed-e0df-4ef0-9add-822551b1c2bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellLabel->
  "In[428]:=",ExpressionUUID->"65a4252c-ec4f-46ce-be7f-4db6838b8407"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}}\\\\lambda \"\>"], "Output",
 CellLabel->
  "Out[428]=",ExpressionUUID->"33a1045c-1c26-4ff4-adc8-850b3e7a07e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Sqrt", "[", "2", "]"}]}], "/", 
   RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}]], "Input",
 CellChangeTimes->{{3.5446037293248405`*^9, 3.5446037343081255`*^9}, {
   3.544603775909505*^9, 3.5446037779386206`*^9}, {3.544603901778704*^9, 
   3.54460393876782*^9}, 3.544605084612358*^9},
 CellLabel->
  "In[429]:=",ExpressionUUID->"94967384-f559-4a0b-91a3-a1b15d50bebd"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SqrtBox["2"], 
   RowBox[{"3", " ", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}]]}]], "Output",
 CellLabel->
  "Out[429]=",ExpressionUUID->"facc8445-90ff-4ab6-aeb4-edd641f81194"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellLabel->
  "In[430]:=",ExpressionUUID->"e7fdb2a4-953c-43cd-92b7-673965dc1231"],

Cell[BoxData["\<\"- \\\\frac{\\\\sqrt{2}}{3 \\\\lambda}\"\>"], "Output",
 CellLabel->
  "Out[430]=",ExpressionUUID->"e5368d08-b6fb-483c-ba7c-b01e4d60479f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[431]:=",ExpressionUUID->"8de0f30e-bf4f-4302-b045-d577cfd94958"],

Cell[BoxData["\<\"- \\\\tfrac{1}{3} \\\\sqrt{2} \\\\lambda^{-1}\"\>"], \
"Output",
 CellLabel->
  "Out[431]=",ExpressionUUID->"5265b32e-981e-4636-9dc6-97dc1c793a3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}]], "Input",
 CellChangeTimes->{3.5446044193493075`*^9},
 CellLabel->
  "In[432]:=",ExpressionUUID->"ad1f19b8-270c-489b-bf11-b9aa728aa3bd"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output",
 CellLabel->
  "Out[432]=",ExpressionUUID->"f82d804a-56a1-49c6-8557-50a7fb05195c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellLabel->
  "In[433]:=",ExpressionUUID->"9ada53dd-6e81-4803-ae49-525518d85913"],

Cell[BoxData["\<\"\\\\frac{1}{3 \\\\lambda}\"\>"], "Output",
 CellLabel->
  "Out[433]=",ExpressionUUID->"c94847fc-c312-4265-8b13-c35a280d755f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}], "/", 
  RowBox[{"Sqrt", "[", "2", "]"}]}]], "Input",
 CellChangeTimes->{
  3.5446044193493075`*^9, {3.544604931472599*^9, 3.5446049333707075`*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"34617b48-81a8-49ee-a907-86394b072f33"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   SqrtBox["2"], " ", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}]]], "Output",
 CellLabel->
  "Out[434]=",ExpressionUUID->"6291e5bd-c13e-4ab1-962d-78774b1bffcd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellLabel->
  "In[435]:=",ExpressionUUID->"f7582ecb-44d3-4a21-8363-98c190925f47"],

Cell[BoxData["\<\"\\\\frac{1}{3 \\\\sqrt{2} \\\\lambda}\"\>"], "Output",
 CellLabel->
  "Out[435]=",ExpressionUUID->"1810b987-9eb8-4354-a6f7-53f6fcf7fbf7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "3"}], "/", 
  RowBox[{"Sqrt", "[", "2", "]"}]}]], "Input",
 CellChangeTimes->{{3.5446049498616514`*^9, 3.544604950404682*^9}},
 CellLabel->
  "In[436]:=",ExpressionUUID->"80b37900-1aea-4146-aab3-b4bba4fec08a"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"3", " ", 
   SqrtBox["2"]}]]], "Output",
 CellLabel->
  "Out[436]=",ExpressionUUID->"b2b25128-b28d-48de-9975-5ba5f8579ca4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellLabel->
  "In[437]:=",ExpressionUUID->"2a9b5f60-529c-4d1c-8cee-ef0d72e0bc1a"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}}\"\>"], "Output",
 CellLabel->
  "Out[437]=",ExpressionUUID->"b7b44a61-4d1e-4b96-b2c2-83c78be7e11c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Lambda]", "[", "]"}], "-", "3"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"1", "-", "\[Lambda]"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.544604963424427*^9, 3.544605003711731*^9}},
 CellLabel->
  "In[438]:=",ExpressionUUID->"7b3675ef-a93a-4d07-9618-d5f29c190b8d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "3"}], "+", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False]}], 
  RowBox[{"1", "-", "\[Lambda]"}]]], "Output",
 CellLabel->
  "Out[438]=",ExpressionUUID->"835ad646-6c61-4c4f-8c9d-0aaae83c660e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.544604994392198*^9, 3.544604996902342*^9}},
 CellLabel->
  "In[439]:=",ExpressionUUID->"96637fc0-5078-4619-b647-c973b2b5b817"],

Cell[BoxData["\<\"- \\\\frac{3 -  \\\\lambda}{1 -  \\\\lambda}\"\>"], "Output",
 CellLabel->
  "Out[439]=",ExpressionUUID->"bcb27f05-f3d5-4354-9a7c-9385a8492b15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[440]:=",ExpressionUUID->"93f0e119-a363-4b7f-abc2-cef7b7da4258"],

Cell[BoxData["\<\"(1 -  \\\\lambda)^{-1} (-3 + \\\\lambda)\"\>"], "Output",
 CellLabel->
  "Out[440]=",ExpressionUUID->"2039ad15-f221-447b-bbf6-1493efbd239c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "*", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"\[Lambda]", "[", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.54460502974422*^9, 3.5446050354855485`*^9}},
 CellLabel->
  "In[441]:=",ExpressionUUID->"e4779d76-3fea-4352-aa11-c9657fed34a5"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   StyleBox[GridBox[{
      {"\[Tau]", 
       StyleBox[GridBox[{
          {" ", " ", " "},
          {"a", "b", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
   Editable->False], 
  RowBox[{
   SqrtBox["2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     InterpretationBox[
      StyleBox["\[Lambda]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[Lambda][],
      Editable->False]}], ")"}]}]]], "Output",
 CellLabel->
  "Out[441]=",ExpressionUUID->"f6c0a721-6201-4135-a022-6093ddc95512"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5446050369326315`*^9, 3.5446050413938866`*^9}},
 CellLabel->
  "In[442]:=",ExpressionUUID->"db18d7c8-0751-48a8-85e1-83a670e53379"],

Cell[BoxData["\<\"\\\\frac{\\\\tau_{abc}}{\\\\sqrt{2} (1 + \
\\\\lambda)}\"\>"], "Output",
 CellLabel->
  "Out[442]=",ExpressionUUID->"655034f2-c405-4655-912d-97a4cdc892b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$TexFractionAsFraction", "=", "False"}], "}"}], ",", 
   RowBox[{"TexPrint", "[", "%%", "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[443]:=",ExpressionUUID->"ffd81ff1-6fb8-4dff-a6aa-d9db4cc34235"],

Cell[BoxData["\<\"\\\\tfrac{1}{\\\\sqrt{2}}\\\\tau_{abc} (1 + \
\\\\lambda)^{-1}\"\>"], "Output",
 CellLabel->
  "Out[443]=",ExpressionUUID->"e70571eb-281e-406a-a568-3d48812f2388"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Lambda]", "[", "]"}], "-", "3"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Lambda]"}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"1", "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "-", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"\[Lambda]", "[", "]"}]}], "/", "3"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
  RowBox[{"2", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Lambda]", "[", "]"}], "-", "3"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.5831307531366796`*^9, 3.583130763994299*^9}, {
   3.588318871485839*^9, 3.5883188733734426`*^9}, 3.5883190503245535`*^9, {
   3.715233414975192*^9, 3.715233434709676*^9}, {3.7152334674965887`*^9, 
   3.715233471158084*^9}},
 CellLabel->
  "In[444]:=",ExpressionUUID->"58add8ee-189d-4b5b-aea3-615d6ad42101"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"3", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     InterpretationBox[
      StyleBox["\[Lambda]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[Lambda][],
      Editable->False]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "3"}], "+", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}], 
   RowBox[{"1", "-", "\[Lambda]"}]], "-", 
  FractionBox["1", 
   RowBox[{"3", " ", 
    SqrtBox["2"], " ", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False]}]]}]], "Output",
 CellLabel->
  "Out[444]=",ExpressionUUID->"abaabd99-53b3-4756-ac13-3535d3137f34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.583133108117816*^9, 3.58313311023942*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"a585b4da-2bc0-48bc-bffa-9de197589f85"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}} + 2 (-3 + \\\\lambda) -  \
\\\\frac{3 -  \\\\lambda}{1 -  \\\\lambda} -  \\\\frac{1}{3 \\\\sqrt{2} \
\\\\lambda}\"\>"], "Output",
 CellLabel->
  "Out[445]=",ExpressionUUID->"716eb34a-f877-473e-ab61-a09a1ae99f9b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexBreak", "[", 
  RowBox[{"%", ",", "1", ",", 
   RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5831307663187027`*^9, 3.583130799281561*^9}, {
   3.5883168347754617`*^9, 3.5883168366474648`*^9}, 3.5883188144365387`*^9},
 CellLabel->
  "In[446]:=",ExpressionUUID->"6f45fcdc-d1ff-404b-a2b4-e73184990b2c"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}} \\\\nonumber \\\\\\\\ \\n&& + 2 \
(-3 + \\\\lambda) \\\\nonumber \\\\\\\\ \\n&& -  \\\\frac{3 -  \\\\lambda}{1 \
-  \\\\lambda} \\\\nonumber \\\\\\\\ \\n&& -  \\\\frac{1}{3 \\\\sqrt{2} \
\\\\lambda}\"\>"], "Output",
 CellLabel->
  "Out[446]=",ExpressionUUID->"8ecf93a4-2b7e-45c8-8f22-5ec569f4e28d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexBreak", "[", 
  RowBox[{"%%", ",", "1", ",", 
   RowBox[{"TexBreakBy", "\[Rule]", "\"\<Term\>\""}], ",", 
   RowBox[{"TexBreakInParenthesis", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7152335865842667`*^9, 3.71523358956816*^9}},
 CellLabel->
  "In[447]:=",ExpressionUUID->"45da9f5b-a2f2-4ae4-8105-6fda9c8ee828"],

Cell[BoxData["\<\"\\\\tfrac{1}{3 \\\\sqrt{2}} \\\\nonumber \\\\\\\\ \\n&& + 2 \
(-3 \\\\nonumber \\\\\\\\ \\n&& + \\\\lambda) \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\frac{3 -  \\\\lambda}{1 -  \\\\lambda} \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\frac{1}{3 \\\\sqrt{2} \\\\lambda}\"\>"], "Output",
 CellLabel->
  "Out[447]=",ExpressionUUID->"f93a61ba-d3a7-4a7d-9948-0c93b3ff6745"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Scalar", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}]}], "]"}], 
    RowBox[{"T", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], "^", 
  RowBox[{"(", "2", ")"}]}]], "Input",
 CellChangeTimes->{{3.5831351756382475`*^9, 3.583135185045064*^9}},
 CellLabel->
  "In[448]:=",ExpressionUUID->"48a65cea-c1be-45ea-9383-fba51f500ea0"],

Cell[BoxData[
 SuperscriptBox[
  InterpretationBox[
   StyleBox[
    RowBox[{
     StyleBox["(",
      FontColor->RGBColor[1, 0, 0]], 
     RowBox[{
      InterpretationBox[
       StyleBox[GridBox[{
          {"\[Tau]", 
           StyleBox[GridBox[{
              {" ", " ", " "},
              {"a", "b", "c"}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox[GridBox[{
          {"\[Tau]", 
           StyleBox[GridBox[{
              {"a", "b", "c"},
              {" ", " ", " "}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c],
       Editable->False]}], 
     StyleBox[")",
      FontColor->RGBColor[1, 0, 0]]}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   xAct`xTensor`Scalar[$CellContext`T[-$CellContext`a, -$CellContext`b, \
-$CellContext`c] $CellContext`T[$CellContext`a, $CellContext`b, \
$CellContext`c]],
   Editable->False], "2"]], "Output",
 CellLabel->
  "Out[448]=",ExpressionUUID->"21c8d49a-4b00-4640-b173-188d1df8d6c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5831352098335075`*^9, 3.583135212329512*^9}},
 CellLabel->
  "In[449]:=",ExpressionUUID->"933f705b-0917-43be-8aa0-6a2f0c3b63f4"],

Cell[BoxData["\<\"(\\\\tau_{abc} \\\\tau^{abc})^2\"\>"], "Output",
 CellLabel->
  "Out[449]=",ExpressionUUID->"31e1f088-8f5e-42cd-a81d-0beda421be96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Scalar", "[", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], 
   RowBox[{"T", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5831351756382475`*^9, 3.583135185045064*^9}, {
  3.5831352273211384`*^9, 3.5831352277735395`*^9}},
 CellLabel->
  "In[450]:=",ExpressionUUID->"e1829cf4-b836-48ef-b063-28957e141cce"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{
    StyleBox["(",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{
     InterpretationBox[
      StyleBox[GridBox[{
         {"\[Tau]", 
          StyleBox[GridBox[{
             {" ", " ", " "},
             {"a", "b", "c"}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->Rational[39, 4]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`T[-$CellContext`a, -$CellContext`b, -$CellContext`c],
      Editable->False], " ", 
     InterpretationBox[
      StyleBox[GridBox[{
         {"\[Tau]", 
          StyleBox[GridBox[{
             {"a", "b", "c"},
             {" ", " ", " "}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->Rational[39, 4]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`T[$CellContext`a, $CellContext`b, $CellContext`c],
      Editable->False]}], 
    StyleBox[")",
     FontColor->RGBColor[1, 0, 0]]}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`Scalar[$CellContext`T[-$CellContext`a, -$CellContext`b, \
-$CellContext`c] $CellContext`T[$CellContext`a, $CellContext`b, \
$CellContext`c]],
  Editable->False]], "Output",
 CellLabel->
  "Out[450]=",ExpressionUUID->"0e849713-5721-426e-8c78-2c9cf0a91182"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellChangeTimes->{{3.5831352098335075`*^9, 3.583135212329512*^9}},
 CellLabel->
  "In[451]:=",ExpressionUUID->"1fad9ad4-a3ae-4362-9eae-d4ca8afa3c6e"],

Cell[BoxData["\<\"(\\\\tau_{abc} \\\\tau^{abc})\"\>"], "Output",
 CellLabel->
  "Out[451]=",ExpressionUUID->"03887ca3-be65-421f-8c80-881de88f47d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefScalarFunction", "[", 
  RowBox[{"FF", ",", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<F\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.605014846342925*^9, 3.605014870792959*^9}},
 CellLabel->
  "In[452]:=",ExpressionUUID->"5666f535-c1f4-4a97-af98-acd8ef34a1d2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefScalarFunction", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"scalar function \"\>", "\[InvisibleSpace]", "FF",
    "\[InvisibleSpace]", "\<\". \"\>", "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm[
  "** ", xAct`xTensor`DefScalarFunction, ": Defining ", 
   "scalar function ", $CellContext`FF, ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[452]:=",ExpressionUUID->"e7644290-7a56-461a-810c-b8c6c52b9706"]
}, Open  ]],

Cell["The different styles for parenthesis handling", "Text",
 CellChangeTimes->{{3.728808354322192*^9, 
  3.728808375357793*^9}},ExpressionUUID->"5e7efc3e-fd0e-4c29-8555-\
5a316a9c04da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"FF", "[", 
     RowBox[{"\[Lambda]", "[", "]"}], "]"}], "]"}], "+", 
   RowBox[{"FF", "[", 
    RowBox[{"\[Lambda]", "[", "]"}], "]"}], "+", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"FF", "[", 
      RowBox[{"\[Lambda]", "[", "]"}], "]"}], 
     RowBox[{"Sin", "[", 
      RowBox[{"FF", "[", 
       RowBox[{"\[Lambda]", "[", "]"}], "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.605014889862986*^9, 3.605014899993*^9}, {
  3.6050163129259787`*^9, 3.6050163139259796`*^9}, {3.6050169587968826`*^9, 
  3.6050169641868896`*^9}, {3.605078430281968*^9, 3.6050784723420267`*^9}, {
  3.7288081524812593`*^9, 3.7288081597543764`*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"8324d686-471d-4df7-90be-55c5772158a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox["Cos",
     ShowAutoStyles->False,
     AutoSpacing->False],
    Cos,
    Editable->False], "[", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox["F",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`FF,
      Editable->False], "[", 
     InterpretationBox[
      StyleBox["\[Lambda]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[Lambda][],
      Editable->False], "]"}], " ", 
    RowBox[{
     InterpretationBox[
      StyleBox["Sin",
       ShowAutoStyles->False,
       AutoSpacing->False],
      Sin,
      Editable->False], "[", 
     RowBox[{
      InterpretationBox[
       StyleBox["F",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`FF,
       Editable->False], "[", 
      InterpretationBox[
       StyleBox["\[Lambda]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[Lambda][],
       Editable->False], "]"}], "]"}]}], "]"}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox["F",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`FF,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox["\[Lambda]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Lambda][],
    Editable->False], "]"}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     ShowAutoStyles->False,
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   RowBox[{
    InterpretationBox[
     StyleBox["F",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`FF,
     Editable->False], "[", 
    InterpretationBox[
     StyleBox["\[Lambda]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Lambda][],
     Editable->False], "]"}], "]"}]}]], "Output",
 CellLabel->
  "Out[453]=",ExpressionUUID->"f7940af7-8347-4a2f-b813-aa1aae943eb4"]
}, Open  ]],

Cell["Same size everywhere.", "Text",
 CellChangeTimes->{{3.728808354322192*^9, 
  3.7288084074980307`*^9}},ExpressionUUID->"f8536740-6359-450c-9e08-\
7f44bc0db7a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tex", "@", "expr"}]], "Input",
 CellChangeTimes->{{3.6050166443764424`*^9, 3.605016646136445*^9}},
 CellLabel->
  "In[454]:=",ExpressionUUID->"5a2a83bd-2a9a-4485-a143-6c010d3c4903"],

Cell[BoxData["\<\"\\\\cos(F(\\\\lambda ) \\\\sin(F(\\\\lambda ))) + \
F(\\\\lambda ) + \\\\sin(F(\\\\lambda ))\"\>"], "Output",
 CellLabel->
  "Out[454]=",ExpressionUUID->"cee51bb3-5177-4733-849d-47c3fe8b4ac7"]
}, Open  ]],

Cell["Old code counts maximum parenthesis level.", "Text",
 CellChangeTimes->{{3.728808354322192*^9, 
  3.7288084509270053`*^9}},ExpressionUUID->"5497f1f6-3bf4-43b4-8ab9-\
279d7af834a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", 
  RowBox[{"expr", ",", "ParenthesisOldStyle"}], "]"}]], "Input",
 CellLabel->
  "In[455]:=",ExpressionUUID->"a77dc2fa-8db7-4083-8d9b-56a3838ff1a1"],

Cell[BoxData["\<\"\\\\cos\\\\Bigl(F\\\\bigl(\\\\lambda \\\\bigr) \
\\\\sin\\\\bigl(F(\\\\lambda)\\\\bigr)\\\\Bigr) + F\\\\Bigl(\\\\lambda \
\\\\Bigr) + \\\\sin\\\\Bigl(F\\\\bigl(\\\\lambda \\\\bigr)\\\\Bigr)\"\>"], \
"Output",
 CellLabel->
  "Out[455]=",ExpressionUUID->"950fe10b-4ee8-4004-81ce-148d28f9e2f6"]
}, Open  ]],

Cell["New code counts depth for each case.", "Text",
 CellChangeTimes->{{3.728808354322192*^9, 
  3.7288084894472*^9}},ExpressionUUID->"58a4190f-c674-4cf8-9bb3-1d5b8c1765aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", "expr", "]"}]], "Input",
 CellLabel->
  "In[456]:=",ExpressionUUID->"8e9f5254-b6a9-4d0d-b486-814cdcb2c75d"],

Cell[BoxData["\<\"\\\\cos\\\\Bigl(F(\\\\lambda) \\\\sin\\\\bigl(F(\\\\lambda)\
\\\\bigr)\\\\Bigr) + F(\\\\lambda) + \\\\sin\\\\bigl(F(\\\\lambda)\\\\bigr)\"\
\>"], "Output",
 CellLabel->
  "Out[456]=",ExpressionUUID->"dd959040-327c-4243-a300-fed073a5b22b"]
}, Open  ]],

Cell["\<\
If one wants other brackets at different levels, one can set this with \
OpenParenthesis and CloseParenthesis for each level.\
\>", "Text",
 CellChangeTimes->{{3.728808354322192*^9, 3.7288084894472*^9}, {
  3.7288086022109194`*^9, 
  3.7288086709517593`*^9}},ExpressionUUID->"fe71540a-feb3-445f-8f2b-\
8004518ff38d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"1", ",", "\"\<(\>\""}], "]"}], ":=", "\"\<\\\\bigl [\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseParenthesis", "[", 
    RowBox[{"1", ",", "\"\<)\>\""}], "]"}], ":=", "\"\<\\\\bigl ]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"2", ",", "\"\<(\>\""}], "]"}], ":=", "\"\<\\\\bigl \\\\{\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseParenthesis", "[", 
    RowBox[{"2", ",", "\"\<)\>\""}], "]"}], ":=", "\"\<\\\\bigl \\\\}\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.728808561211624*^9, 3.7288085946371665`*^9}, {
  3.7288086754167414`*^9, 3.72880871091463*^9}, {3.7288087559218755`*^9, 
  3.728808757484271*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"614f73da-cc38-4f61-ba73-541508e33524"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "[", "expr", "]"}]], "Input",
 CellLabel->
  "In[461]:=",ExpressionUUID->"5be57966-a086-46d1-8206-44b5d1003e96"],

Cell[BoxData["\<\"\\\\cos\\\\bigl \\\\{F(\\\\lambda) \\\\sin\\\\bigl \
[F(\\\\lambda)\\\\bigl ]\\\\bigl \\\\} + F(\\\\lambda) + \\\\sin\\\\bigl \
[F(\\\\lambda)\\\\bigl ]\"\>"], "Output",
 CellLabel->
  "Out[461]=",ExpressionUUID->"79d768fc-d670-4959-8c39-84b72d9f0cac"]
}, Open  ]],

Cell["Reset to default.", "Text",
 CellChangeTimes->{{3.728808354322192*^9, 3.7288084894472*^9}, {
  3.7288086022109194`*^9, 3.7288086709517593`*^9}, {3.7288087836428623`*^9, 
  3.728808807225651*^9}},ExpressionUUID->"fd8422bf-8c1f-41a1-b641-\
380a16e2406b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"1", ",", "\"\<(\>\""}], "]"}], "=."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseParenthesis", "[", 
    RowBox[{"1", ",", "\"\<)\>\""}], "]"}], "=."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenParenthesis", "[", 
    RowBox[{"2", ",", "\"\<(\>\""}], "]"}], "=."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseParenthesis", "[", 
    RowBox[{"2", ",", "\"\<)\>\""}], "]"}], "=."}], ";"}]}], "Input",
 CellChangeTimes->{{3.728808795249406*^9, 3.728808823292862*^9}},
 CellLabel->
  "In[462]:=",ExpressionUUID->"8d28192e-8a61-48c0-aa04-b2c1fb455db4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefBasis", "[", "B4", "]"}]], "Input",
 CellChangeTimes->{{3.5831502063383007`*^9, 3.5831502105815086`*^9}},
 CellLabel->
  "In[466]:=",ExpressionUUID->"92971777-e85b-4977-8097-6fbf3fa26d42"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"non-symmetric Christoffel tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "ChristoffelPDB4"}],
  
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", 
   "non-symmetric Christoffel tensor", " ", $CellContext`ChristoffelPDB4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[466]:=",ExpressionUUID->"b22a1b99-7b78-4589-af13-c47506b15445"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"Ricci tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "RicciPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "Ricci tensor", 
   " ", $CellContext`RicciPDB4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[466]:=",ExpressionUUID->"35ed242f-e8ac-4061-bf7b-b7da0033cc9a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"Riemann tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "RiemannPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "Riemann tensor", 
   " ", $CellContext`RiemannPDB4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[466]:=",ExpressionUUID->"d4261e8a-5213-4544-91ac-e9169618cbbb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"torsion tensor\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "TorsionPDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "torsion tensor", 
   " ", $CellContext`TorsionPDB4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[466]:=",ExpressionUUID->"4bcadea1-871a-47a2-a5c3-9c41c60b528b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefCovD", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"parallel derivative\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "PDB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefCovD, ": Undefined ", "parallel derivative", 
   " ", $CellContext`PDB4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[466]:=",ExpressionUUID->"684ee292-90e1-439c-b955-97abc5d21a21"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric +1 density\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "etaUpB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "antisymmetric +1 density",
    " ", $CellContext`etaUpB4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[466]:=",ExpressionUUID->"df150ac4-edde-47c8-9dab-22ddeed974eb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"antisymmetric -1 density\"\>", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "etaDownB4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "antisymmetric -1 density",
    " ", $CellContext`etaDownB4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[466]:=",ExpressionUUID->"33668fa9-dff5-4123-b15a-f7184a35bf90"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefBasis", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"basis\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "B4"}],
  SequenceForm[
  "** ", xAct`xCoba`UndefBasis, ": Undefined ", "basis", " ", $CellContext`B4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[466]:=",ExpressionUUID->"1b80cb58-b638-42d6-bc4d-0a3f8be593d4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefTensor", "/@", "$Tensors"}]], "Input",
 CellLabel->
  "In[467]:=",ExpressionUUID->"e8a948e3-dd67-44b0-b2f7-d7f9f6137486"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "T"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`T],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[467]:=",ExpressionUUID->"be77eb57-2061-4046-8772-7104c3cc0185"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "\[Lambda]"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`\[Lambda]],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[467]:=",ExpressionUUID->"435c4bba-94c3-47b3-969c-a65c339f5373"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output",
 CellLabel->
  "Out[467]=",ExpressionUUID->"b384d42c-3a61-422b-9364-b974ad2d3a45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "xAct`SymManipulator`"}]], "Input",
 CellChangeTimes->{{3.5451105751410365`*^9, 3.5451106065594916`*^9}},
 CellLabel->
  "In[468]:=",ExpressionUUID->"5923ae44-e29f-4388-8888-8e1646cb68ef"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[468]:=",ExpressionUUID->"2682b1c9-f773-4088-ab9e-404e73c3fb18"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`SymManipulator`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.9.4\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2016", ",", "11", ",", "29"}], "}"}]}],
  SequenceForm[
  "Package xAct`SymManipulator`  version ", "0.9.4", ", ", {2016, 11, 29}],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[468]:=",ExpressionUUID->"28bce61f-0363-4a24-bf35-5c1a2d8e2ecf"],

Cell[BoxData["\<\"CopyRight (C) 2011-2016, Thomas B\[ADoubleDot]ckdahl, under \
the General Public License.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[468]:=",ExpressionUUID->"dda4438c-1be9-4f6c-a201-45f0f7e655dd"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[468]:=",ExpressionUUID->"ed081665-7ff5-4692-a026-7f72e8c62fdb"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[468]:=",ExpressionUUID->"83f4d74f-f836-4191-93a4-b1e8e20dcc11"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[468]:=",ExpressionUUID->"c0b63ccb-aff7-4992-a890-b51888c395bd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"T4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<T\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5450649705892844`*^9, 3.545064989699318*^9}, {
  3.5451107209700923`*^9, 3.5451107263521023`*^9}},
 CellLabel->
  "In[469]:=",ExpressionUUID->"b6ee0839-2597-462a-930b-16cd3fb3e58b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"T4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "c"}], ",", 
     RowBox[{"-", "d"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d], ". ", ""],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[469]:=",ExpressionUUID->"6f0163df-ba85-4b2a-881f-7eaf3e45cfc7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], ",", "M4", ",", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<\[CapitalSigma]\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5450649705892844`*^9, 3.545064989699318*^9}, {
  3.545110131281456*^9, 3.545110135789864*^9}, {3.5451107284113054`*^9, 
  3.5451107330445137`*^9}, {3.5822826873528094`*^9, 3.5822826946380224`*^9}},
 CellLabel->
  "In[470]:=",ExpressionUUID->"e8580a22-4b4d-46ca-a0c1-7f1491e02261"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`b], ". ", ""],
  
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[470]:=",ExpressionUUID->"5c2f2d1f-9b7a-4b03-ba4f-b89a412f70bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ImposeSym", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalSigma]2", "[", 
     RowBox[{"d", ",", 
      RowBox[{"-", "f"}]}], "]"}], 
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", "g"}], "]"}]}], ",", 
   RowBox[{"IndexList", "[", 
    RowBox[{
     RowBox[{"-", "f"}], ",", 
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", "d", ",", "g"}], "]"}], ",", 
   RowBox[{"JoinSGS", "[", 
    RowBox[{
     RowBox[{"Symmetric", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], "]"}], ",", 
     RowBox[{"Antisymmetric", "[", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[471]:=",ExpressionUUID->"98c16c9c-0d34-4925-8867-6d739390065f"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[GridBox[{
     {
      RowBox[{
       UnderscriptBox["Sym", 
        StyleBox[
         RowBox[{
          RowBox[{"(", "36", ")"}], "[", "45", "]"}],
         FontSize->Tiny]], "[", "T", "\[CapitalSigma]", "]"}], 
      StyleBox[GridBox[{
         {" ", " ", " ", "g", "d", " "},
         {"c", "a", "b", " ", " ", "f"}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.], {
             Offset[0.034999999999999996`]}, 
            Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
             Offset[0.]}}, "RowsIndexed" -> {}}],
       FontSize->Rational[39, 4]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.034999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`SymManipulator`SymH[{$CellContext`T4, $CellContext`\[CapitalSigma]2}, 
   xAct`xPerm`StrongGenSet[{3, 4, 5, 6}, 
    xAct`xPerm`GenSet[-xAct`xPerm`Cycles[{4, 5}], 
     xAct`xPerm`Cycles[{3, 6}]]], 
   "(36)[45]"][-$CellContext`c, -$CellContext`a, -$CellContext`b, \
$CellContext`g, $CellContext`d, -$CellContext`f],
  Editable->False]], "Output",
 CellLabel->
  "Out[471]=",ExpressionUUID->"566fec15-7269-4747-83a8-825378cf80ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "%"}]], "Input",
 CellLabel->
  "In[472]:=",ExpressionUUID->"833a35bd-159a-4f2b-b298-fe257bf0abfc"],

Cell[BoxData["\<\"T_{ca(b}{}^{[g}\\\\Sigma^{d]}{}_{f)}\"\>"], "Output",
 CellLabel->
  "Out[472]=",ExpressionUUID->"a15f7f18-910c-47f9-b109-ef33e4b96945"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "@", 
  RowBox[{"Antisymmetrize", "[", 
   RowBox[{
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5822821755699935`*^9, 3.582282204586045*^9}},
 CellLabel->
  "In[473]:=",ExpressionUUID->"56070e95-de71-4aac-8ad0-a5fa0e469b7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "a", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`a, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "a", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`a, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "c", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`c, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "c", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`c, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "d", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`d, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "d", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`d, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}]}]], "Output",
 CellLabel->
  "Out[473]=",ExpressionUUID->"a1e65272-57fe-4cf4-ac4d-466375cb299f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr2", "=", 
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "b"}], ",", "c_", ",", "d_", ",", "a_"}], "]"}], 
    "\[RightTeeArrow]", 
    RowBox[{
     RowBox[{"T4", "[", 
      RowBox[{
       RowBox[{"-", "b"}], ",", "f", ",", "d", ",", "a"}], "]"}], 
     RowBox[{"\[CapitalSigma]2", "[", 
      RowBox[{"g", ",", 
       RowBox[{"-", "f"}]}], "]"}], 
     RowBox[{"\[CapitalSigma]2", "[", 
      RowBox[{"c", ",", 
       RowBox[{"-", "g"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.5822824818068485`*^9, 3.5822826115678763`*^9}, {
  3.582282713061654*^9, 3.582282758301734*^9}, {3.5823537640402923`*^9, 
  3.5823537661306963`*^9}},
 CellLabel->
  "In[474]:=",ExpressionUUID->"7c455e37-60c4-46ae-b69b-98640dbf1e4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "b", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "c", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "b", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "a", "d", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "b", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"c", "d", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "a", "c", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "b", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"d", "c", "b", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "a", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`d],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "d", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "-", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "a", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`c],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"d", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", "e", " ", " "},
           {"b", " ", "c", "a"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`a],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"d", "f"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {"f", " "},
           {" ", "e"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
    Editable->False]}]}]], "Output",
 CellLabel->
  "Out[474]=",ExpressionUUID->"6b6cbbbc-8e22-4de1-9501-8d591ae1eee5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexPrintPageWidth", "=", "latextextwidth"}], ";"}]], "Input",
 CellChangeTimes->{{3.588329844241895*^9, 3.588329854725114*^9}},
 CellLabel->
  "In[475]:=",ExpressionUUID->"67cd4b78-fd4f-479b-addd-4edae3611155"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexPrint", "@", "expr2"}]], "Input",
 CellChangeTimes->{{3.5822824226515446`*^9, 3.5822824256467495`*^9}, 
   3.588083416003859*^9},
 CellLabel->
  "In[476]:=",ExpressionUUID->"18bf4a10-de5a-4424-bc1c-3624d08751fb"],

Cell[BoxData["\<\"\\\\tfrac{1}{24} T_{abcd} -  \\\\tfrac{1}{24} T_{abdc} -  \
\\\\tfrac{1}{24} T_{acbd} + \\\\tfrac{1}{24} T_{acdb} + \\\\tfrac{1}{24} \
T_{adbc} -  \\\\tfrac{1}{24} T_{adcb} + \\\\tfrac{1}{24} T_{cabd} -  \
\\\\tfrac{1}{24} T_{cadb} -  \\\\tfrac{1}{24} T_{cbad} + \\\\tfrac{1}{24} \
T_{cbda} + \\\\tfrac{1}{24} T_{cdab} -  \\\\tfrac{1}{24} T_{cdba} -  \
\\\\tfrac{1}{24} T_{dabc} + \\\\tfrac{1}{24} T_{dacb} + \\\\tfrac{1}{24} \
T_{dbac} -  \\\\tfrac{1}{24} T_{dbca} -  \\\\tfrac{1}{24} T_{dcab} + \
\\\\tfrac{1}{24} T_{dcba} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\"\>"], "Output",
 CellLabel->
  "Out[476]=",ExpressionUUID->"018cbe14-68bf-49e1-8f83-268765e5825d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexBreak", "[", 
  RowBox[{"%", ",", "210", ",", " ", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"TexBreakBy", "\[Rule]", "\"\<TexPoint\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.588083333604514*^9, 3.5880834089838467`*^9}, 
   3.588083454551527*^9},
 CellLabel->
  "In[477]:=",ExpressionUUID->"3b4c853b-86db-4e37-85f1-60f6f8b12a42"],

Cell[BoxData["\<\"\\\\tfrac{1}{24} T_{abcd} -  \\\\tfrac{1}{24} T_{abdc} -  \
\\\\tfrac{1}{24} T_{acbd} + \\\\tfrac{1}{24} T_{acdb} \\\\nonumber \\\\\\\\ \
\\n&& + \\\\tfrac{1}{24} T_{adbc} -  \\\\tfrac{1}{24} T_{adcb} + \
\\\\tfrac{1}{24} T_{cabd} -  \\\\tfrac{1}{24} T_{cadb} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{cbad} + \\\\tfrac{1}{24} T_{cbda} + \
\\\\tfrac{1}{24} T_{cdab} -  \\\\tfrac{1}{24} T_{cdba} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{dabc} + \\\\tfrac{1}{24} T_{dacb} + \
\\\\tfrac{1}{24} T_{dbac} -  \\\\tfrac{1}{24} T_{dbca} \\\\nonumber \\\\\\\\ \
\\n&& -  \\\\tfrac{1}{24} T_{dcab} + \\\\tfrac{1}{24} T_{dcba} -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \\\\Sigma_{af} \\\\Sigma^{f}{}_{e} \
\\\\nonumber \\\\\\\\ \\n&& + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e} + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} \\\\nonumber \\\\\\\\ \\n&& -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \\\\Sigma_{cf} \\\\Sigma^{f}{}_{e} -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \\\\Sigma_{df} \\\\Sigma^{f}{}_{e} \
\\\\nonumber \\\\\\\\ \\n&& + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \
\\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\"\>"], "Output",
 CellLabel->
  "Out[477]=",ExpressionUUID->"2e11eb6f-0c69-4d41-a14f-b417fe5830ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FirstEq", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalSigma]2", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], 
    RowBox[{"\[CapitalSigma]2", "[", 
     RowBox[{
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}]}], "]"}]}], "==", "expr2"}]}]], "Input",
 CellChangeTimes->{{3.7273408974218035`*^9, 3.7273408985064955`*^9}, {
  3.7273412627690935`*^9, 3.7273412818464537`*^9}},
 CellLabel->
  "In[478]:=",ExpressionUUID->"f192b880-0574-43c1-8bef-180897e9cde4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"a", "b"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`b],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"\[CapitalSigma]", 
        StyleBox[GridBox[{
           {" ", " "},
           {"c", "d"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`d],
    Editable->False]}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "b", "c", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`c, \
-$CellContext`d],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "b", "d", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "c", "b", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`b, \
-$CellContext`d],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "c", "d", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`c, -$CellContext`d, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "d", "b", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"a", "d", "c", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`c, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "a", "b", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`b, \
-$CellContext`d],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "a", "d", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`a, -$CellContext`d, \
-$CellContext`b],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "b", "a", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`a, \
-$CellContext`d],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "b", "d", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`b, -$CellContext`d, \
-$CellContext`a],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "d", "a", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`a, \
-$CellContext`b],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"c", "d", "b", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`c, -$CellContext`d, -$CellContext`b, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "a", "b", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`b, \
-$CellContext`c],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "a", "c", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`a, -$CellContext`c, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "b", "a", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`a, \
-$CellContext`c],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "b", "c", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`b, -$CellContext`c, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "c", "a", "b"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`a, \
-$CellContext`b],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"d", "c", "b", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`d, -$CellContext`c, -$CellContext`b, \
-$CellContext`a],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "c", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"a", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "d", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"a", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "a", "d"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`d],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"c", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "d", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`d, \
-$CellContext`a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"c", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`c, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "-", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "a", "c"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`a, \
-$CellContext`c],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"d", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"T", 
         StyleBox[GridBox[{
            {" ", "e", " ", " "},
            {"b", " ", "c", "a"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`T4[-$CellContext`b, $CellContext`e, -$CellContext`c, \
-$CellContext`a],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {" ", " "},
            {"d", "f"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[-$CellContext`d, -$CellContext`f],
     Editable->False], " ", 
    InterpretationBox[
     StyleBox[GridBox[{
        {"\[CapitalSigma]", 
         StyleBox[GridBox[{
            {"f", " "},
            {" ", "e"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->Rational[39, 4]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalSigma]2[$CellContext`f, -$CellContext`e],
     Editable->False]}]}]}]], "Output",
 CellLabel->
  "Out[478]=",ExpressionUUID->"275057ad-6fca-44a5-9bca-b4b72f1cd388"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Second\[CapitalSigma]Eq", "=", 
  RowBox[{
   RowBox[{"\[CapitalSigma]2", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "\[Equal]", "0"}]}]], "Input",
 CellChangeTimes->{{3.7273407985019226`*^9, 3.7273408011731853`*^9}, {
  3.7273408956361904`*^9, 3.7273409079256935`*^9}, {3.727341269973216*^9, 
  3.72734127846086*^9}, {3.7273435449279594`*^9, 3.7273435512877827`*^9}, {
  3.7273437044880953`*^9, 3.727343710822482*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"ec4bc28f-c577-4940-9b26-c351272a9613"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[GridBox[{
      {"\[CapitalSigma]", 
       StyleBox[GridBox[{
          {" ", " "},
          {"a", "b"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`\[CapitalSigma]2[-$CellContext`a, -$CellContext`b],
   Editable->False], "\[Equal]", "0"}]], "Output",
 CellLabel->
  "Out[479]=",ExpressionUUID->"546eb3ab-f9a6-4257-9da2-6b1a3c4216cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ThirdEq", "=", 
  RowBox[{
   RowBox[{"T4", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "d"}], ",", 
     RowBox[{"-", "c"}]}], "]"}], "==", 
   RowBox[{
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "d"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}]}], "]"}], "-", 
    RowBox[{"T4", "[", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "d"}], ",", 
      RowBox[{"-", "c"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.727340911426629*^9, 3.7273409145433054`*^9}, {
  3.7273412860638075`*^9, 3.7273412885823154`*^9}},
 CellLabel->
  "In[480]:=",ExpressionUUID->"f62b2cf9-6b5c-4f09-8fb7-ffeb5afed077"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[GridBox[{
      {"T", 
       StyleBox[GridBox[{
          {" ", " ", " ", " "},
          {"a", "b", "d", "c"}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->Rational[39, 4]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`T4[-$CellContext`a, -$CellContext`b, -$CellContext`d, \
-$CellContext`c],
   Editable->False], "\[Equal]", 
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"a", "d", "b", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`a, -$CellContext`d, -$CellContext`b, \
-$CellContext`c],
    Editable->False], "-", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"T", 
        StyleBox[GridBox[{
           {" ", " ", " ", " "},
           {"b", "a", "d", "c"}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->Rational[39, 4]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`T4[-$CellContext`b, -$CellContext`a, -$CellContext`d, \
-$CellContext`c],
    Editable->False]}]}]], "Output",
 CellLabel->
  "Out[480]=",ExpressionUUID->"079d7f00-084c-4a7b-9bfd-5406f03ea17c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"texcode", "=", 
  RowBox[{"TexPrintAlignedEquations", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"FirstEq", ",", "Second\[CapitalSigma]Eq", ",", "ThirdEq"}], 
     "}"}], ",", 
    RowBox[{"Labels", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7273408406275425`*^9, 3.7273408577566376`*^9}, {
   3.7273409184137306`*^9, 3.7273409514388003`*^9}, 3.7273412961683397`*^9, {
   3.727341365964566*^9, 3.7273413794956937`*^9}, {3.72734369196481*^9, 
   3.727343717094249*^9}, {3.728551736001363*^9, 3.728551738485718*^9}},
 CellLabel->
  "In[481]:=",ExpressionUUID->"642607af-3fbd-4ae4-8a71-5411b09aa2af"],

Cell[BoxData["\<\"\\\\begin{align}\\n\\\\Sigma_{ab} \
\\\\Sigma_{cd}={}&\\\\tfrac{1}{24} T_{abcd}\\n -  \\\\tfrac{1}{24} \
T_{abdc}\\n -  \\\\tfrac{1}{24} T_{acbd}\\n + \\\\tfrac{1}{24} T_{acdb}\\n + \
\\\\tfrac{1}{24} T_{adbc}\\n -  \\\\tfrac{1}{24} T_{adcb}\\n + \
\\\\tfrac{1}{24} T_{cabd}\\\\nonumber\\\\\\\\\\n& -  \\\\tfrac{1}{24} \
T_{cadb}\\n -  \\\\tfrac{1}{24} T_{cbad}\\n + \\\\tfrac{1}{24} T_{cbda}\\n + \
\\\\tfrac{1}{24} T_{cdab}\\n -  \\\\tfrac{1}{24} T_{cdba}\\n -  \
\\\\tfrac{1}{24} T_{dabc}\\\\nonumber\\\\\\\\\\n& + \\\\tfrac{1}{24} T_{dacb}\
\\n + \\\\tfrac{1}{24} T_{dbac}\\n -  \\\\tfrac{1}{24} T_{dbca}\\n -  \
\\\\tfrac{1}{24} T_{dcab}\\n + \\\\tfrac{1}{24} \
T_{dcba}\\\\nonumber\\\\\\\\\\n& -  \\\\tfrac{1}{24} T_{b}{}^{e}{}_{cd} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e}\\n + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{dc} \
\\\\Sigma_{af} \\\\Sigma^{f}{}_{e}\\n + \\\\tfrac{1}{24} T_{b}{}^{e}{}_{ad} \
\\\\Sigma_{cf} \\\\Sigma^{f}{}_{e}\\\\nonumber\\\\\\\\\\n& -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{da} \\\\Sigma_{cf} \\\\Sigma^{f}{}_{e}\\n -  \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ac} \\\\Sigma_{df} \\\\Sigma^{f}{}_{e}\\n + \
\\\\tfrac{1}{24} T_{b}{}^{e}{}_{ca} \\\\Sigma_{df} \\\\Sigma^{f}{}_{e} \
\\\\label{eq:FirstEq},\\\\\\\\\\n\\\\Sigma_{ab}={}&0 \
\\\\label{eq:SecondCapitalSigmaEq},\\\\\\\\\\nT_{abdc}={}&T_{adbc}\\n -  \
T_{badc} \\\\label{eq:ThirdEq}.\\n\\\\end{align}\"\>"], "Output",
 CellLabel->
  "Out[481]=",ExpressionUUID->"d7dc49ad-1065-4a0f-8ca8-aaabee0dc055"]
}, Open  ]],

Cell["\<\
Observe that $TexViewInternal=True; only works on some versions of \
Mathematica. How well this works can also depend on your OS and latex \
version. Adding  \[OpenCurlyDoubleQuote]\\\\pdfminorversion=3\
\[CloseCurlyDoubleQuote] to the list $TexInitLatexExtraCode can help in some \
cases. The default $TexViewInternal=False; should work on most machines \
though.\
\>", "Text",
 CellChangeTimes->{{3.7285598558097725`*^9, 3.7285600314788203`*^9}, 
   3.7288045924096265`*^9, {3.728808040251742*^9, 
   3.7288080405307484`*^9}},ExpressionUUID->"c46eb656-4bcb-4dcc-8f68-\
b10882cd05ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TexViewInternal", "=", "False"}], ";"}]], "Input",
 CellChangeTimes->{
  3.7285517743711853`*^9, {3.7288045982779617`*^9, 3.7288045997890487`*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"fe764cd0-1244-4ef7-a787-a40f165d80af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TexView", "[", "texcode", "]"}]], "Input",
 CellChangeTimes->{{3.728551755501939*^9, 3.7285517584176416`*^9}},
 CellLabel->
  "In[483]:=",ExpressionUUID->"a1336673-3b81-4592-b353-6c23f540347e"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Typesetting OK.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[483]:=",ExpressionUUID->"9b875001-be1d-4f3a-ad57-bed2e4eec720"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Opening file: \"\>", "\[InvisibleSpace]", "\<\"TexActView\"\>",
    "\[InvisibleSpace]", "\<\".pdf\"\>"}],
  SequenceForm["Opening file: ", "TexActView", ".pdf"],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[483]:=",ExpressionUUID->"81dd275b-94de-4ad5-8f13-430e7afb64de"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefTensor", "/@", "$Tensors"}]], "Input",
 CellLabel->
  "In[484]:=",ExpressionUUID->"1dcdbf46-b62e-4943-9012-18778ad9a8dd"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "T4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`T4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[484]:=",ExpressionUUID->"edd16c64-7441-4125-b1dd-aa8f0b23349c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefTensor", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"tensor\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "\[CapitalSigma]2"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefTensor, ": Undefined ", "tensor", 
   " ", $CellContext`\[CapitalSigma]2],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[484]:=",ExpressionUUID->"12014c95-3074-4d29-9c9a-67b3c9114b0f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output",
 CellLabel->
  "Out[484]=",ExpressionUUID->"474814f4-6a04-4aa6-82a0-10510c56f18e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UndefManifold", "[", "M4", "]"}]], "Input",
 CellLabel->
  "In[485]:=",ExpressionUUID->"36c4714e-d3a2-44b8-95c5-20a4e81b66cf"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefVBundle", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"vbundle\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", 
   InterpretationBox[
    StyleBox["\[DoubleStruckCapitalT]M4",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`TangentM4,
    Editable->False]}],
  SequenceForm[
  "** ", xAct`xTensor`UndefVBundle, ": Undefined ", "vbundle", 
   " ", $CellContext`TangentM4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[485]:=",ExpressionUUID->"9b1f8d2e-cb14-4594-8426-e56a1a675868"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "UndefManifold", 
   "\[InvisibleSpace]", "\<\": Undefined \"\>", 
   "\[InvisibleSpace]", "\<\"manifold\"\>", "\[InvisibleSpace]", "\<\" \"\>", 
   "\[InvisibleSpace]", "M4"}],
  SequenceForm[
  "** ", xAct`xTensor`UndefManifold, ": Undefined ", "manifold", 
   " ", $CellContext`M4],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[485]:=",ExpressionUUID->"b4524b1c-38b6-47dc-ba03-3efb9c55855f"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1112, 1281},
WindowMargins->{{139, Automatic}, {Automatic, 9}},
ShowSelection->True,
Magnification:>1.25 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info1373731308330-6022697"->{
  Cell[59826, 1567, 275, 5, 70, "Print",ExpressionUUID->"086ed89c-1f49-4d7d-8984-e187b43afcb3",
   CellTags->"Info1373731308330-6022697"]},
 "Info1383731308330-6022697"->{
  Cell[60284, 1582, 287, 5, 70, "Print",ExpressionUUID->"f027219c-571d-4c0c-84b2-b0a11121ac66",
   CellTags->"Info1383731308330-6022697"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info1373731308330-6022697", 495309, 13576},
 {"Info1383731308330-6022697", 495481, 13579}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 112, 2, 121, "Title",ExpressionUUID->"e0881279-da07-4a4a-91d8-4d2999f73966"],
Cell[694, 26, 202, 7, 66, "Subtitle",ExpressionUUID->"0b8d0559-8138-4d1b-8b4c-9cdfdda986b9"],
Cell[899, 35, 619, 12, 174, "Subsubtitle",ExpressionUUID->"46f9f6ce-e596-4c28-8549-1d90f80a366a"],
Cell[1521, 49, 911, 24, 182, "Text",ExpressionUUID->"2e87b620-7419-4a9d-aab1-ee836d2456bb"],
Cell[CellGroupData[{
Cell[2457, 77, 130, 2, 83, "Section",ExpressionUUID->"e9eccd9b-f825-49d6-a634-9f0abf3e9ee2"],
Cell[CellGroupData[{
Cell[2612, 83, 164, 3, 35, "Input",ExpressionUUID->"cd96d29b-6f86-4aab-a8d0-9e2c278d5c17"],
Cell[2779, 88, 200, 4, 40, "Output",ExpressionUUID->"27e4bef9-7f38-4f0d-a0f0-922269ce4126"]
}, Open  ]],
Cell[2994, 95, 550, 15, 80, "Input",ExpressionUUID->"e3e58c99-fae0-43de-9df5-19758902ebd8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3569, 114, 91, 0, 67, "Subsection",ExpressionUUID->"41c144d8-fd2c-4aa9-85e6-12503a2beb33"],
Cell[3663, 116, 159, 3, 90, "Text",ExpressionUUID->"24fb36e6-bfca-4b1b-ae7f-8c46fd106ecd"]
}, Closed]],
Cell[CellGroupData[{
Cell[3859, 124, 85, 0, 46, "Subsection",ExpressionUUID->"38f7abb1-b4fd-4d1d-a999-f56042da9d2f"],
Cell[3947, 126, 3527, 74, 27129, "Input",ExpressionUUID->"8130e9a2-ffb1-4f73-8459-58f61d561f54",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[7511, 205, 94, 0, 46, "Subsection",ExpressionUUID->"4393db84-b034-4142-974c-e10ab6afb6bb"],
Cell[7608, 207, 819, 35, 30845, "Input",ExpressionUUID->"cd3ddec4-24fe-473c-9d4e-c462fa26328f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8464, 247, 94, 0, 46, "Subsection",ExpressionUUID->"eb7c220d-7898-4a5b-a23a-e83788e84208"],
Cell[8561, 249, 102, 0, 43, "Text",ExpressionUUID->"460d065f-dbc0-4d06-9fec-bee0384939f2"],
Cell[8666, 251, 419, 11, 80, "Input",ExpressionUUID->"9954ddef-8280-4a96-92a0-6a9836c765e4",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[9110, 266, 136, 1, 35, "Input",ExpressionUUID->"6ae8e6b3-afc0-4767-a9bf-85a2b0294a5a"],
Cell[9249, 269, 126, 1, 40, "Output",ExpressionUUID->"4d846526-b883-43cd-99f9-3cc275b98460"]
}, Open  ]],
Cell[9390, 273, 273, 11, 43, "Text",ExpressionUUID->"b5b9d2aa-0d4a-4d23-9b11-84a7a9fd9b2d"],
Cell[CellGroupData[{
Cell[9688, 288, 339, 8, 55, "Input",ExpressionUUID->"9c2ee48c-f31b-4511-abf9-709c9b2e57ac",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[10052, 300, 201, 4, 28, "Print",ExpressionUUID->"4164c930-add3-4575-8af5-8ba0c59a65dd"],
Cell[10256, 306, 473, 12, 28, "Print",ExpressionUUID->"65e41f75-a54d-426e-b007-bf1fde48c748"],
Cell[10732, 320, 222, 4, 28, "Print",ExpressionUUID->"01584cd7-7e97-4bfa-b12d-408bbc812c9d"],
Cell[10957, 326, 181, 3, 28, "Print",ExpressionUUID->"48f69ae6-0936-45aa-a382-bc97c392827a"],
Cell[11141, 331, 162, 3, 28, "Print",ExpressionUUID->"6851c8d3-f658-4775-9621-15f8298e2919"],
Cell[11306, 336, 201, 4, 28, "Print",ExpressionUUID->"ce133340-f13e-4598-a33e-cf572bb7b9a7"],
Cell[11510, 342, 477, 12, 28, "Print",ExpressionUUID->"afdf858e-b563-4998-adc5-54b52b064761"],
Cell[11990, 356, 222, 4, 28, "Print",ExpressionUUID->"60df2230-54bb-4615-a452-bd1d75c87d86"]
}, Open  ]],
Cell[12227, 363, 126, 1, 40, "Output",ExpressionUUID->"2cdd022e-6449-4164-90f9-e65cf005ac92"]
}, Open  ]],
Cell[12368, 367, 179, 5, 43, "Text",ExpressionUUID->"270a4b92-8294-4842-a48a-d795a42e496e"],
Cell[12550, 374, 666, 18, 80, "Input",ExpressionUUID->"8b7a7e8f-21e0-44f4-b33e-d87debd1156a",
 InitializationCell->True],
Cell[13219, 394, 79, 0, 43, "Text",ExpressionUUID->"2cdcf8f9-dad3-484e-9c18-ce3b9c87bc00"],
Cell[CellGroupData[{
Cell[13323, 398, 804, 18, 152, "Input",ExpressionUUID->"3794754e-8740-4d2d-a65f-2c74d151e490",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[14152, 420, 201, 4, 28, "Print",ExpressionUUID->"0723065e-662e-4df8-b2bd-62eb410e663e"],
Cell[14356, 426, 472, 11, 28, "Print",ExpressionUUID->"1838a942-24d6-4a7d-801d-7ba54147a28d"],
Cell[14831, 439, 271, 5, 28, "Print",ExpressionUUID->"6ad85494-12a2-457b-9882-fd3d8a42a492"]
}, Open  ]]
}, Open  ]],
Cell[15129, 448, 238, 4, 110, "Text",ExpressionUUID->"eda21b64-e275-42fc-b2c4-786afb37e5ef"],
Cell[15370, 454, 1735, 28, 800, "Input",ExpressionUUID->"e93e99a1-fcc8-43ec-a409-89f406e422b6",
 InitializationCell->True],
Cell[17108, 484, 143, 2, 43, "Text",ExpressionUUID->"a3830b80-712b-4639-ad55-94630fcffd26"],
Cell[CellGroupData[{
Cell[17276, 490, 861, 19, 224, "Input",ExpressionUUID->"9268fe77-46cf-4d3d-b674-b2732878bb63",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[18162, 513, 201, 4, 28, "Print",ExpressionUUID->"08aaac9c-7ec6-4138-9ac2-fb5d7c92124f"],
Cell[18366, 519, 356, 6, 52, "Print",ExpressionUUID->"ab2bbced-e2a5-421b-88df-3cdb17a7bb56"],
Cell[18725, 527, 201, 4, 28, "Print",ExpressionUUID->"75ee802f-5ad6-475a-b58b-8ad2a355acdd"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[18987, 538, 96, 0, 46, "Subsection",ExpressionUUID->"1b0304e1-a9be-4b57-a339-23b1fe955c4e"],
Cell[19086, 540, 14419, 324, 6117, "Input",ExpressionUUID->"f680fbcd-75c0-48e6-905e-0393974f1e4c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[33542, 869, 103, 0, 46, "Subsection",ExpressionUUID->"bc355029-52ca-4a2d-9c7a-3472eb7c75bc"],
Cell[CellGroupData[{
Cell[33670, 873, 180, 3, 137, "Input",ExpressionUUID->"dcf3a5f4-7473-4a52-a72d-21a3b8feeea7",
 InitializationCell->True],
Cell[33853, 878, 134, 1, 70, "Output",ExpressionUUID->"60306de0-4cec-4743-a343-0bb85fbcab45"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34048, 886, 122, 2, 83, "Section",ExpressionUUID->"d1b9726f-1155-4170-b8a2-2848a514dd15"],
Cell[CellGroupData[{
Cell[34195, 892, 108, 0, 67, "Subsection",ExpressionUUID->"8109d6e6-8186-421a-8b5c-0b98eb41363f"],
Cell[34306, 894, 108, 0, 90, "Text",ExpressionUUID->"ac1a6da4-daab-4756-9df3-106b447760b8"],
Cell[34417, 896, 398, 8, 151, "Text",ExpressionUUID->"4073dc58-daa0-45bd-a344-8f8635d187fe"],
Cell[34818, 906, 1623, 28, 278, "Text",ExpressionUUID->"aae7169c-fe09-49f9-98f9-40b86c14ce9b"],
Cell[36444, 936, 419, 7, 137, "Input",ExpressionUUID->"ca8bd73f-cc8f-4d97-980d-0d4dfd2327db",
 InitializationCell->True],
Cell[36866, 945, 743, 17, 257, "Input",ExpressionUUID->"10654146-f54c-4397-8e79-be1f416e6530",
 InitializationCell->True],
Cell[37612, 964, 647, 17, 198, "Input",ExpressionUUID->"f91669ac-0b40-4345-98dc-481b5e94164a",
 InitializationCell->True],
Cell[38262, 983, 1608, 39, 375, "Input",ExpressionUUID->"9349a50a-4a21-4485-b8b5-fe77066874cf",
 InitializationCell->True],
Cell[39873, 1024, 2662, 79, 1078, "Input",ExpressionUUID->"0f9115a4-615a-475f-8fb1-a2232303bcb8",
 InitializationCell->True],
Cell[42538, 1105, 623, 19, 198, "Input",ExpressionUUID->"dbf513dd-d1c0-423e-bf16-4fe42b26e16a",
 InitializationCell->True],
Cell[43164, 1126, 469, 13, 257, "Input",ExpressionUUID->"83c5c553-48b6-4c7e-9f7a-c4efe900a3e1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[43670, 1144, 95, 0, 46, "Subsection",ExpressionUUID->"cc430464-7283-4200-b40c-a9f452aeb9ac"],
Cell[43768, 1146, 531, 7, 214, "Text",ExpressionUUID->"03a37158-9e9a-449a-97a7-c7d078428b2a"],
Cell[44302, 1155, 1920, 48, 609, "Input",ExpressionUUID->"e1ae01c9-57d9-4ec0-8e54-869d79f58526",
 InitializationCell->True],
Cell[46225, 1205, 6734, 147, 1956, "Input",ExpressionUUID->"577b9972-74c7-4e0b-88ff-d46640381077",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[52996, 1357, 108, 0, 46, "Subsection",ExpressionUUID->"9c261caa-46c6-46df-898a-808577c96786"],
Cell[53107, 1359, 191, 3, 1971, "Text",ExpressionUUID->"28d1afb5-6250-43d5-b0d9-9226c34ca9ab"],
Cell[53301, 1364, 4999, 150, 32659, "Input",ExpressionUUID->"2de6adbe-1710-477c-995a-b6e5b738f7cd"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58349, 1520, 126, 2, 83, "Section",ExpressionUUID->"c134f083-93e5-4e8e-bd7c-f0a1dd86faff"],
Cell[CellGroupData[{
Cell[58500, 1526, 98, 0, 67, "Subsection",ExpressionUUID->"a9e39fd1-11a6-4f6b-a5aa-2180390641cd"],
Cell[58601, 1528, 384, 8, 3309, "Text",ExpressionUUID->"e54eb1b8-5fcb-4e0b-b056-f06fcbb085e6"],
Cell[58988, 1538, 333, 10, 3546, "Input",ExpressionUUID->"2c125385-57f0-4ad1-84f3-850e67d67f67",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[59358, 1553, 91, 0, 46, "Subsection",ExpressionUUID->"be55406d-d073-4f39-a3eb-673c7361d305"],
Cell[59452, 1555, 208, 3, 746, "Text",ExpressionUUID->"8dd21851-7809-4a50-a2e6-a109002300aa"],
Cell[CellGroupData[{
Cell[59685, 1562, 138, 3, 598, "Input",ExpressionUUID->"d8ec4062-9fd4-4b24-b7d4-ede3fcd0a8ee"],
Cell[59826, 1567, 275, 5, 70, "Print",ExpressionUUID->"086ed89c-1f49-4d7d-8984-e187b43afcb3",
 CellTags->"Info1373731308330-6022697"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60138, 1577, 143, 3, 598, "Input",ExpressionUUID->"c6b8fdb1-a4ab-4f18-a2a7-b0febaa451c4"],
Cell[60284, 1582, 287, 5, 70, "Print",ExpressionUUID->"f027219c-571d-4c0c-84b2-b0a11121ac66",
 CellTags->"Info1383731308330-6022697"]
}, Open  ]],
Cell[60586, 1590, 477, 12, 1868, "Input",ExpressionUUID->"90fe1d75-9328-4542-a18f-5995304e5979",
 InitializationCell->True],
Cell[61066, 1604, 229, 3, 746, "Text",ExpressionUUID->"b14f01b9-9ae6-4bf5-b872-a2324d23ac80"],
Cell[61298, 1609, 1091, 24, 1439, "Input",ExpressionUUID->"bceae0a3-9cd6-4710-9a5e-170877d2c684",
 InitializationCell->True],
Cell[62392, 1635, 348, 7, 746, "Text",ExpressionUUID->"5e07f0c3-6e28-458d-a07a-90708d3c1e27"],
Cell[62743, 1644, 2682, 65, 3721, "Code",ExpressionUUID->"063e1fcf-68ef-49a1-85fa-16168535af69"],
Cell[65428, 1711, 256, 3, 746, "Text",ExpressionUUID->"bad3f35d-a647-401a-b349-cd82e6b6dc6d"],
Cell[65687, 1716, 878, 22, 2317, "Input",ExpressionUUID->"1c6acd26-42de-49b6-8eaa-3a2465fde7da",
 InitializationCell->True],
Cell[66568, 1740, 110, 0, 746, "Text",ExpressionUUID->"2d56a606-6efe-4121-ae16-4a7d3f52a19a"],
Cell[66681, 1742, 551, 16, 1439, "Input",ExpressionUUID->"816ff93a-13b5-4911-9341-b78e1a052a09",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67269, 1763, 89, 0, 46, "Subsection",ExpressionUUID->"a2920021-0310-4437-9b6a-142aa3cf10ba"],
Cell[67361, 1765, 1999, 58, 5071, "Input",ExpressionUUID->"9308bb6a-8391-47bc-b875-381b6d380fcc",
 InitializationCell->True],
Cell[69363, 1825, 129, 0, 932, "Text",ExpressionUUID->"47758250-fa33-4c77-bb98-ae790243b978"],
Cell[69495, 1827, 481, 16, 2335, "Input",ExpressionUUID->"e2ec4615-70ff-4c9e-9a47-0159b263ec88",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[70013, 1848, 223, 4, 46, "Subsection",ExpressionUUID->"3f0da5d7-71f3-4a00-b1dc-f8069beb6b98"],
Cell[70239, 1854, 275, 5, 90, "Text",ExpressionUUID->"bb0be36a-1d66-4c2e-ae13-03ff34e8fa8a"],
Cell[70517, 1861, 337, 9, 137, "Input",ExpressionUUID->"19da7b3c-4ea6-4f5a-927e-22c44c11c61a",
 InitializationCell->True],
Cell[70857, 1872, 190, 2, 90, "Text",ExpressionUUID->"4872346d-81ae-4839-b3e6-9791daac60e6"],
Cell[71050, 1876, 836, 23, 315, "Input",ExpressionUUID->"7fa99e04-ebcc-4741-8537-4521ace5ff22",
 InitializationCell->True],
Cell[71889, 1901, 215, 3, 90, "Text",ExpressionUUID->"ee027e4e-71fe-4b63-bcf3-3d3b28b11d33"],
Cell[72107, 1906, 256, 7, 137, "Input",ExpressionUUID->"3920d4df-70f3-4a43-aa4b-83a68984fe33",
 InitializationCell->True],
Cell[72366, 1915, 339, 4, 90, "Text",ExpressionUUID->"e5c39014-20a8-45eb-9339-9cf37c5a65e3"],
Cell[72708, 1921, 1168, 30, 375, "Input",ExpressionUUID->"37281370-f6d0-4919-923b-e2074d3ecf73",
 InitializationCell->True],
Cell[73879, 1953, 281, 5, 90, "Text",ExpressionUUID->"bc8dcf51-1713-4e2d-a5cc-a92b59193b5c"],
Cell[74163, 1960, 1363, 35, 198, "Input",ExpressionUUID->"95f06ef9-1d12-4d95-afca-ccc80b94ecea",
 InitializationCell->True],
Cell[75529, 1997, 1865, 55, 315, "Input",ExpressionUUID->"be90a0a1-80f5-4a9b-a2b4-c6f10cf83de9",
 InitializationCell->True],
Cell[77397, 2054, 8466, 237, 1546, "Input",ExpressionUUID->"fb1ca26a-671c-4a24-ac84-32c26089defc",
 InitializationCell->True],
Cell[85866, 2293, 220, 3, 90, "Text",ExpressionUUID->"cb1934dd-ec1b-4b40-a6fb-6e4468814c9d"],
Cell[86089, 2298, 223, 6, 93, "Text",ExpressionUUID->"712f79ee-8910-4512-9718-00cbdcdeb0a8"],
Cell[86315, 2306, 1711, 41, 325, "Input",ExpressionUUID->"1ce20ad8-c3e2-4225-9eb4-f11b9a7616dd",
 Evaluatable->False],
Cell[88029, 2349, 213, 3, 90, "Text",ExpressionUUID->"ddbd035a-0318-47a9-a668-1fe83b49a02a"],
Cell[88245, 2354, 335, 9, 89, "Input",ExpressionUUID->"1ff53f55-7f9d-415f-9e91-e2892c322671",
 Evaluatable->False],
Cell[88583, 2365, 819, 14, 151, "Text",ExpressionUUID->"e77d8003-fef3-45c3-b432-5314961a6afe"],
Cell[89405, 2381, 984, 26, 150, "Input",ExpressionUUID->"a80991d2-e070-4404-be14-004873b8d95b",
 Evaluatable->False],
Cell[90392, 2409, 6031, 153, 1089, "Input",ExpressionUUID->"035ba010-f12a-4a43-a39d-f18f53a76841",
 Evaluatable->False]
}, Closed]],
Cell[CellGroupData[{
Cell[96460, 2567, 91, 0, 46, "Subsection",ExpressionUUID->"3973b9e0-9e95-4479-aa8b-59ddf59fdc2b"],
Cell[96554, 2569, 1642, 49, 6703, "Input",ExpressionUUID->"d249f157-8a0c-4e92-badf-9d2b35a24e1c",
 InitializationCell->True],
Cell[98199, 2620, 306, 7, 932, "Text",ExpressionUUID->"f170c925-019e-4261-b861-ccf141c13e68",
 InitializationCell->True],
Cell[98508, 2629, 2061, 55, 2335, "Input",ExpressionUUID->"7904d897-0b18-44e9-a72a-40c54c31187e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[100606, 2689, 89, 0, 46, "Subsection",ExpressionUUID->"9c1d7be7-c3bf-46e3-bf3d-a32b43d500b7"],
Cell[100698, 2691, 114, 0, 384, "Text",ExpressionUUID->"761dcef7-0a70-455f-980d-fc39468cbb6a"],
Cell[100815, 2693, 669, 18, 737, "Input",ExpressionUUID->"f3368a15-310a-4444-976c-a49524be9895",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[101521, 2716, 89, 0, 46, "Subsection",ExpressionUUID->"3bff6572-8474-47a4-b96d-89d32186e9c1"],
Cell[101613, 2718, 404, 8, 932, "Text",ExpressionUUID->"a50bd4a9-5f2c-4b33-bc1b-c54097ca9d3f"],
Cell[102020, 2728, 461, 12, 1221, "Input",ExpressionUUID->"84c63f21-15b6-4b70-bb16-c87432bac1f9",
 InitializationCell->True],
Cell[102484, 2742, 291, 6, 932, "Text",ExpressionUUID->"28956fc1-a9ea-4504-8e8c-848ba651b96e"],
Cell[102778, 2750, 317, 8, 1221, "Input",ExpressionUUID->"358830e1-96da-4f41-968a-2a11a00e7961",
 InitializationCell->True],
Cell[103098, 2760, 534, 13, 1798, "Input",ExpressionUUID->"b6f45586-45ae-4f42-bb55-c59c29c1eefb",
 InitializationCell->True],
Cell[103635, 2775, 121, 0, 932, "Text",ExpressionUUID->"1e03b6a7-4c6c-467e-a04c-cca5519c8d5d"],
Cell[103759, 2777, 2592, 71, 5698, "Input",ExpressionUUID->"ac005b47-5e56-489f-8b7e-575073df3674",
 Evaluatable->False],
Cell[106354, 2850, 125, 0, 932, "Text",ExpressionUUID->"cda374a8-213f-4b2e-9579-54e82fb27947"],
Cell[106482, 2852, 4650, 126, 9976, "Input",ExpressionUUID->"04014627-75dd-4ec4-a518-e79327f5b716",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[111169, 2983, 91, 0, 46, "Subsection",ExpressionUUID->"fdc34e0e-f9ac-412e-a125-6079b5b3dbda"],
Cell[111263, 2985, 719, 14, 276, "Text",ExpressionUUID->"b6c92e07-86b4-4b8b-b025-aba50a20af36"],
Cell[111985, 3001, 1453, 39, 432, "Input",ExpressionUUID->"9df04169-d295-4134-ad05-f9f379038385",
 InitializationCell->True],
Cell[113441, 3042, 791, 21, 198, "Input",ExpressionUUID->"6e483e84-69b2-41e7-9c26-00f7fe80a549",
 InitializationCell->True],
Cell[114235, 3065, 1223, 34, 317, "Input",ExpressionUUID->"b83ae2b4-a767-4e0c-b41d-c19c68309c39",
 InitializationCell->True],
Cell[115461, 3101, 1882, 52, 551, "Input",ExpressionUUID->"d614bfcf-f099-4b1e-9f15-9c9c55ce8cc2",
 InitializationCell->True],
Cell[117346, 3155, 201, 5, 137, "Input",ExpressionUUID->"55bab7b3-5847-4ff0-8036-3193d11482d5",
 InitializationCell->True],
Cell[117550, 3162, 1018, 28, 432, "Input",ExpressionUUID->"983c113a-a894-49d0-a5b9-dc113fbd4f40",
 InitializationCell->True],
Cell[118571, 3192, 855, 24, 259, "Input",ExpressionUUID->"758940b9-9bb9-49f9-904c-3fd1936ef121",
 InitializationCell->True],
Cell[119429, 3218, 1025, 29, 257, "Input",ExpressionUUID->"3a9bda42-7901-4199-9527-1e92b308df08",
 InitializationCell->True],
Cell[120457, 3249, 144, 2, 90, "Text",ExpressionUUID->"08843d05-9bd7-476d-aafa-0a59d29ed0e4"],
Cell[120604, 3253, 645, 20, 257, "Input",ExpressionUUID->"9ae5b557-ef7a-4552-8071-466ae4fa0ddb",
 InitializationCell->True],
Cell[121252, 3275, 2400, 64, 726, "Input",ExpressionUUID->"d67e162d-f7c0-457d-9595-9254dac16c97",
 InitializationCell->True],
Cell[123655, 3341, 3467, 97, 668, "Input",ExpressionUUID->"1b079d80-166f-4246-97b6-8b8beb7a56c3",
 InitializationCell->True],
Cell[127125, 3440, 1151, 31, 257, "Input",ExpressionUUID->"5f693c2e-c053-42cb-af53-4b15394dafe8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[128313, 3476, 142, 3, 46, "Subsection",ExpressionUUID->"ccb50393-d7fb-428d-a398-10db3c74e6d5"],
Cell[128458, 3481, 175, 4, 2020, "Input",ExpressionUUID->"1e7ced2b-fce5-4896-87f4-08cf5e16e5ca",
 InitializationCell->True],
Cell[128636, 3487, 269, 6, 1971, "Text",ExpressionUUID->"acd0da8d-4b7c-4b39-8f8e-6faf901c33fa"],
Cell[128908, 3495, 430, 11, 2020, "Input",ExpressionUUID->"a7d97eab-9e04-45f0-bf7f-ae5821ad29c8",
 InitializationCell->True],
Cell[129341, 3508, 483, 12, 2020, "Input",ExpressionUUID->"087ad6f0-0a0d-4df4-a6b2-4c71241d439a",
 InitializationCell->True],
Cell[129827, 3522, 1835, 55, 7704, "Input",ExpressionUUID->"ac8f0fc4-1b24-499a-8a81-902ffd2465ec",
 InitializationCell->True],
Cell[131665, 3579, 1155, 34, 4931, "Input",ExpressionUUID->"086ccb24-c9e6-4f59-a692-d2cec58d9712",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[132857, 3618, 138, 3, 46, "Subsection",ExpressionUUID->"b9c1bd29-032d-433e-9323-b16b38a4db32"],
Cell[132998, 3623, 115, 0, 90, "Text",ExpressionUUID->"7ab4b7c3-4e82-44e1-90d8-1ce1d84d5269"],
Cell[CellGroupData[{
Cell[133138, 3627, 844, 23, 207, "Input",ExpressionUUID->"c0cdd6aa-0113-42f9-9692-0d21a597e2ca",
 Evaluatable->False],
Cell[133985, 3652, 430, 10, 67, "Print",ExpressionUUID->"a0ca6f70-552d-418e-a550-0b6a2ef103fd"]
}, Open  ]],
Cell[134430, 3665, 134, 0, 90, "Text",ExpressionUUID->"fdd7276f-7982-401c-ad70-c2769580659f"],
Cell[134567, 3667, 699, 18, 198, "Input",ExpressionUUID->"693a37ae-7363-45e3-8bc8-4a91a74798b0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[135303, 3690, 174, 3, 46, "Subsection",ExpressionUUID->"db4503e9-5519-442d-b601-6f012da8ea7e"],
Cell[135480, 3695, 2402, 65, 13262, "Input",ExpressionUUID->"1448c191-c1f1-4dff-bd34-d38579d904a3",
 InitializationCell->True],
Cell[137885, 3762, 2211, 57, 9085, "Input",ExpressionUUID->"864e8efd-8eee-411b-8e17-4d270306936d",
 InitializationCell->True],
Cell[140099, 3821, 1176, 33, 6273, "Input",ExpressionUUID->"06199b68-0459-47a0-89a0-d09fda83c9fc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[141312, 3859, 141, 3, 46, "Subsection",ExpressionUUID->"a1dc0b28-d5eb-46cf-aad2-71a49a8a2f53"],
Cell[141456, 3864, 650, 18, 3546, "Input",ExpressionUUID->"93ee7daf-57f5-404d-9090-1842282b7ecb"]
}, Closed]],
Cell[CellGroupData[{
Cell[142143, 3887, 148, 3, 46, "Subsection",ExpressionUUID->"e8d5844b-cb51-4d9f-a413-8e5497b77f1f"],
Cell[142294, 3892, 934, 25, 9085, "Input",ExpressionUUID->"d95c42cb-715e-41dd-8763-5b8adf2eb385",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[143265, 3922, 151, 3, 46, "Subsection",ExpressionUUID->"608a8787-fec7-49bf-9558-db6e01a084c3"],
Cell[143419, 3927, 2766, 72, 13262, "Input",ExpressionUUID->"af38f09b-6f3b-4c1c-aa48-059e1bb554b6",
 InitializationCell->True],
Cell[146188, 4001, 978, 27, 6273, "Input",ExpressionUUID->"e5b05be7-c00e-4f9a-a0e7-023628513ff2"]
}, Closed]],
Cell[CellGroupData[{
Cell[147203, 4033, 212, 4, 46, "Subsection",ExpressionUUID->"e4652de8-278d-4d22-81f6-1fc50c10b296"],
Cell[147418, 4039, 653, 17, 3546, "Input",ExpressionUUID->"bda37ad5-b0c0-4deb-bfac-8d39b54cc112",
 InitializationCell->True],
Cell[148074, 4058, 718, 18, 3546, "Input",ExpressionUUID->"32aa9a74-bc5c-42f2-9b89-e3bec221d2c1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[148829, 4081, 152, 3, 46, "Subsection",ExpressionUUID->"7f6b9329-1025-4dca-9e01-95b276471b25"],
Cell[148984, 4086, 2508, 69, 16018, "Input",ExpressionUUID->"6d9c445a-b1e5-4641-83fe-ede0c88499bb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[151529, 4160, 265, 5, 46, "Subsection",ExpressionUUID->"e302008e-6ac4-4e41-9709-84f682f298a5"],
Cell[151797, 4167, 856, 22, 4931, "Input",ExpressionUUID->"62d27083-30cc-43bc-bea9-70f27b2911a8",
 InitializationCell->True],
Cell[152656, 4191, 796, 22, 4931, "Input",ExpressionUUID->"ef0aeec3-a116-4956-8855-2f14318ac1f7",
 InitializationCell->True],
Cell[153455, 4215, 874, 22, 4931, "Input",ExpressionUUID->"b10ae447-219e-445c-894c-43bb5691445b",
 InitializationCell->True],
Cell[154332, 4239, 852, 22, 4931, "Input",ExpressionUUID->"1081df14-4808-46f5-abb8-4ffeb2a5d0a9",
 InitializationCell->True],
Cell[155187, 4263, 931, 23, 4931, "Input",ExpressionUUID->"c98a1307-09f9-4431-9c1c-88390a39e499",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[156155, 4291, 108, 1, 46, "Subsection",ExpressionUUID->"e2b7e8ac-5584-426a-80b5-4a9dab921c4f"],
Cell[156266, 4294, 212, 6, 137, "Input",ExpressionUUID->"1d830e06-524f-4287-b6a0-4696ceb9db6b",
 InitializationCell->True],
Cell[156481, 4302, 1761, 36, 315, "Input",ExpressionUUID->"7aa86cf1-727d-4a96-9e49-8a568d5abea1",
 InitializationCell->True],
Cell[158245, 4340, 569, 16, 198, "Input",ExpressionUUID->"a8ed8c09-28cb-4c6f-9561-c81be43c5ff7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[158851, 4361, 187, 3, 46, "Subsection",ExpressionUUID->"09942665-d371-47be-bfd7-761cc84c136e"],
Cell[159041, 4366, 1990, 49, 392, "Input",ExpressionUUID->"851ad325-571f-413e-91be-b287fc062478",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[161068, 4420, 160, 3, 46, "Subsection",ExpressionUUID->"188cac56-ec18-434b-a469-b04c4d614c83"],
Cell[161231, 4425, 465, 8, 3309, "Text",ExpressionUUID->"01451bb6-586e-4343-a90b-b12d1a6a825a"],
Cell[161699, 4435, 514, 13, 2020, "Input",ExpressionUUID->"e1bd6282-181f-48f3-a974-a2c5566e6f3e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[162250, 4453, 219, 4, 46, "Subsection",ExpressionUUID->"a989b3bd-be46-4d84-bb90-9d7f95f83612"],
Cell[162472, 4459, 214, 4, 1971, "Text",ExpressionUUID->"f890ad87-18d8-4b13-bd48-7e877b18bf52"],
Cell[162689, 4465, 1018, 26, 3362, "Input",ExpressionUUID->"907983a4-fde5-48f9-9a57-f97e0ba5ccce"],
Cell[163710, 4493, 1030, 26, 3362, "Input",ExpressionUUID->"de26f310-2738-477b-90fe-38aa27661665"],
Cell[164743, 4521, 209, 4, 1971, "Text",ExpressionUUID->"b65befdb-6ea0-4107-8334-2172b837acbb"],
Cell[164955, 4527, 2088, 51, 5815, "Input",ExpressionUUID->"55209a21-8d86-4930-83b2-b998c6fc6556",
 InitializationCell->True],
Cell[167046, 4580, 2193, 54, 5815, "Input",ExpressionUUID->"ba16ed4f-1e42-405e-bceb-6a2150713db4",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[169288, 4640, 195, 3, 83, "Section",ExpressionUUID->"0ecfef3e-3925-45d6-b79f-a1c01de56073"],
Cell[CellGroupData[{
Cell[169508, 4647, 105, 0, 67, "Subsection",ExpressionUUID->"3b36fc65-7f7c-41ac-904d-dc84f36233b1"],
Cell[169616, 4649, 735, 18, 3546, "Input",ExpressionUUID->"2ff84bf6-cf61-4ed1-b67a-075cfd980fca",
 InitializationCell->True],
Cell[170354, 4669, 796, 19, 3546, "Input",ExpressionUUID->"369ff1f9-3994-4c65-aaa1-e32fb49cb95f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[171187, 4693, 89, 0, 46, "Subsection",ExpressionUUID->"0864d58f-4ccf-46fb-b738-810bdec0e64d"],
Cell[171279, 4695, 790, 13, 214, "Text",ExpressionUUID->"dc562e28-2586-4a41-b105-cbf14acec1d5"],
Cell[172072, 4710, 1339, 32, 432, "Input",ExpressionUUID->"eb6a1b8e-5dd6-4399-a5a6-95bd2db2659d",
 InitializationCell->True],
Cell[173414, 4744, 15689, 375, 2307, "Input",ExpressionUUID->"831f57a0-c756-44f2-b2f0-a61359382151",
 InitializationCell->True],
Cell[189106, 5121, 5965, 146, 1195, "Input",ExpressionUUID->"c84bfc37-09f4-4daa-aeca-4a0c6b02f540",
 InitializationCell->True],
Cell[195074, 5269, 2647, 65, 667, "Input",ExpressionUUID->"a79f595c-d32d-44f9-b2fd-a51140fe9593",
 InitializationCell->True],
Cell[197724, 5336, 2780, 54, 784, "Input",ExpressionUUID->"35ff1138-6882-4b2c-85c0-1f4c56e86d93",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[200553, 5396, 260, 4, 83, "Section",ExpressionUUID->"9a8428fe-356a-40a2-97ae-550cc6b3c1d9"],
Cell[CellGroupData[{
Cell[200838, 5404, 215, 4, 67, "Subsection",ExpressionUUID->"380127a2-c8c1-49c3-b899-71410cee71f0"],
Cell[201056, 5410, 859, 23, 4931, "Input",ExpressionUUID->"ac9c839f-5380-48b8-a1e5-fb9ca9b4ba83",
 InitializationCell->True],
Cell[201918, 5435, 2665, 64, 13262, "Input",ExpressionUUID->"fe9f0035-6650-48bd-895b-2acf5cf2aa28",
 InitializationCell->True],
Cell[204586, 5501, 716, 20, 4931, "Input",ExpressionUUID->"a6825211-ee25-46fe-b3dc-a7c4694d3ece",
 InitializationCell->True],
Cell[205305, 5523, 7002, 176, 28460, "Input",ExpressionUUID->"29de0b5e-79a1-4688-bf37-6a03e23194a0",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[212356, 5705, 185, 3, 83, "Section",ExpressionUUID->"f9e1ffe1-b04a-4846-bc74-a884a6711de2"],
Cell[CellGroupData[{
Cell[212566, 5712, 146, 3, 67, "Subsection",ExpressionUUID->"b17aac68-8a64-4a5b-8a0f-1d350d75b43e"],
Cell[212715, 5717, 267, 5, 43, "Text",ExpressionUUID->"fcd66f28-69e4-4b14-a530-7c2a438a50b8"],
Cell[212985, 5724, 1147, 34, 128, "Input",ExpressionUUID->"01a699ef-d89d-4698-80d7-5652a8b555ad",
 InitializationCell->True],
Cell[214135, 5760, 121, 1, 43, "Text",ExpressionUUID->"b5e18e40-23d4-4255-8ec2-202f208781a7"],
Cell[214259, 5763, 892, 24, 109, "Input",ExpressionUUID->"8b74c26b-5efb-4a25-898a-b815dffb2866",
 Evaluatable->False],
Cell[215154, 5789, 214, 3, 43, "Text",ExpressionUUID->"5e8dd041-e4ed-4a52-a90f-a1366d3d94fb"],
Cell[215371, 5794, 759, 19, 81, "Input",ExpressionUUID->"913da0af-5240-46db-b40b-92e6080ccc25",
 InitializationCell->True],
Cell[216133, 5815, 11743, 284, 1210, "Input",ExpressionUUID->"d47f80bc-04b1-4f80-9770-b13526e2c306",
 InitializationCell->True],
Cell[227879, 6101, 13090, 293, 1880, "Input",ExpressionUUID->"3740ff6f-cc36-415f-a05f-bc96c7e9937a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[241006, 6399, 190, 3, 46, "Subsection",ExpressionUUID->"45c97c55-4664-4e85-a0d8-6e850f0de568"],
Cell[241199, 6404, 614, 11, 579, "Text",ExpressionUUID->"55d3c8e1-2164-4245-b475-dc7cb4fe0832"],
Cell[241816, 6417, 266, 6, 321, "Input",ExpressionUUID->"58c837f0-a0e1-4542-a14b-0f7e01875738",
 InitializationCell->True],
Cell[242085, 6425, 489, 11, 473, "Input",ExpressionUUID->"f6cf244a-5510-4475-8ce0-6bc765a061c7",
 InitializationCell->True],
Cell[242577, 6438, 1613, 42, 1043, "Input",ExpressionUUID->"98e9d480-e40e-4b75-9011-98416395b963",
 InitializationCell->True],
Cell[244193, 6482, 539, 15, 473, "Input",ExpressionUUID->"6adfeaf7-650d-4cf4-9d44-562b09e2e070",
 InitializationCell->True],
Cell[244735, 6499, 427, 11, 321, "Input",ExpressionUUID->"0c03530b-eb8a-468c-9981-de34a13cfdfb",
 InitializationCell->True],
Cell[245165, 6512, 285, 7, 321, "Input",ExpressionUUID->"4b02e3b5-ac61-4f81-b922-ee3aebfcd944",
 InitializationCell->True],
Cell[245453, 6521, 940, 22, 473, "Input",ExpressionUUID->"2a3f0903-70fd-4b2f-977b-5520b7ece475",
 InitializationCell->True],
Cell[246396, 6545, 3110, 70, 2332, "Input",ExpressionUUID->"f25e918e-27af-4d1c-a3b1-8ad2608da85d",
 InitializationCell->True],
Cell[249509, 6617, 1276, 35, 473, "Input",ExpressionUUID->"cad804dc-1c05-4f23-b227-27c04690fc77",
 InitializationCell->True],
Cell[250788, 6654, 4273, 102, 3050, "Input",ExpressionUUID->"831d8051-a733-4652-864c-bb8024710593",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[255098, 6761, 234, 4, 46, "Subsection",ExpressionUUID->"24183a8c-ad83-4120-aa8a-d70bf89d9e26"],
Cell[255335, 6767, 496, 9, 90, "Text",ExpressionUUID->"a283ceba-2dc7-416d-b3e1-d9d5183a30fa"],
Cell[255834, 6778, 300, 7, 137, "Input",ExpressionUUID->"a454ed16-81b7-4a28-848a-967a9420c5c3",
 InitializationCell->True],
Cell[256137, 6787, 995, 25, 198, "Input",ExpressionUUID->"3fb90955-d9a0-4d4d-9e02-005de5df5566",
 InitializationCell->True],
Cell[257135, 6814, 293, 7, 137, "Input",ExpressionUUID->"c1f0ab1b-879a-4526-a6b3-80dbac744417",
 InitializationCell->True],
Cell[257431, 6823, 295, 7, 137, "Input",ExpressionUUID->"ea597879-63fe-4d41-a8b7-454216a6691e",
 InitializationCell->True],
Cell[257729, 6832, 270, 6, 137, "Input",ExpressionUUID->"6df28451-7490-4c72-9600-83884d04b49a",
 InitializationCell->True],
Cell[258002, 6840, 265, 6, 137, "Input",ExpressionUUID->"0f3336f6-a0a8-4f13-812a-6827d68d656c",
 InitializationCell->True],
Cell[258270, 6848, 511, 13, 198, "Input",ExpressionUUID->"bc434725-184f-4283-8393-406d3c6f392a",
 InitializationCell->True],
Cell[258784, 6863, 979, 23, 137, "Input",ExpressionUUID->"630e0550-8ab1-4abc-83aa-25b2794471b7",
 InitializationCell->True],
Cell[259766, 6888, 8191, 195, 1429, "Input",ExpressionUUID->"efd33116-231f-4517-86d5-3e578a3238cf",
 InitializationCell->True],
Cell[267960, 7085, 1944, 46, 375, "Input",ExpressionUUID->"e0fa29d1-8496-4198-b947-d25ba142b1d4",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[269953, 7137, 286, 5, 83, "Section",ExpressionUUID->"211a0c3e-6043-415b-9795-81a106a8c667"],
Cell[CellGroupData[{
Cell[270264, 7146, 239, 4, 67, "Subsection",ExpressionUUID->"78944756-5d81-434f-996b-b18d162abb2c"],
Cell[270506, 7152, 266, 6, 257, "Input",ExpressionUUID->"b233e755-e197-4d30-bb48-a9199877c4db",
 InitializationCell->True],
Cell[270775, 7160, 3909, 84, 1407, "Input",ExpressionUUID->"207d5836-2b69-4498-b7a0-ab50a8bacb73",
 InitializationCell->True],
Cell[274687, 7246, 2008, 43, 1065, "Input",ExpressionUUID->"470e9cb7-d2a1-4ed0-a120-a1422819a844",
 InitializationCell->True],
Cell[276698, 7291, 272, 5, 198, "Text",ExpressionUUID->"bb55281a-ba18-449a-8a9b-2dad59a77e4d"],
Cell[276973, 7298, 366, 8, 257, "Input",ExpressionUUID->"8d6ad377-bffd-466d-8846-6c76c6bc2c95",
 InitializationCell->True],
Cell[277342, 7308, 6460, 145, 3696, "Input",ExpressionUUID->"7fe7dddf-03ee-480c-aa20-6553d33ff139",
 InitializationCell->True],
Cell[283805, 7455, 1735, 44, 609, "Input",ExpressionUUID->"17dd8740-381a-4d90-8503-e6b6edc4df5c",
 InitializationCell->True],
Cell[285543, 7501, 404, 10, 257, "Input",ExpressionUUID->"35a177e7-b492-4b07-99e2-deda31264352",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[285996, 7517, 344, 6, 83, "Section",ExpressionUUID->"c83f706e-9f0e-49b0-aa24-ab6d1cb6b55e"],
Cell[CellGroupData[{
Cell[286365, 7527, 321, 5, 67, "Subsection",ExpressionUUID->"5007de29-5958-4638-848c-c37120e2bec3"],
Cell[286689, 7534, 3591, 82, 4325, "Input",ExpressionUUID->"4d278347-1d42-4be5-9493-ba483c1b313c",
 InitializationCell->True],
Cell[290283, 7618, 1465, 31, 2895, "Input",ExpressionUUID->"0a4b9d9f-470d-4dd3-922c-85114e88ca12",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[291797, 7655, 235, 4, 83, "Section",ExpressionUUID->"f02c611a-d82e-4ed9-9f6f-aa6c0dce7f33"],
Cell[CellGroupData[{
Cell[292057, 7663, 161, 4, 137, "Input",ExpressionUUID->"956c3d57-f836-45f7-a2ce-e62890309034",
 InitializationCell->True],
Cell[292221, 7669, 138, 2, 70, "Output",ExpressionUUID->"f4493b03-0240-4d39-ac5e-f359bbccf3d4"]
}, Open  ]],
Cell[292374, 7674, 168, 4, 137, "Input",ExpressionUUID->"f8aa1644-62a2-47dc-88fc-e03f6c1b3121",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[292579, 7683, 265, 5, 64, "Section",ExpressionUUID->"90b4b878-6f88-437a-ae3f-a22f6f598e1a"],
Cell[CellGroupData[{
Cell[292869, 7692, 206, 4, 35, "Input",ExpressionUUID->"c78137c7-ea58-4f47-9149-1d5b42229e0a"],
Cell[CellGroupData[{
Cell[293100, 7700, 202, 4, 28, "Print",ExpressionUUID->"00370647-83db-4a92-8762-8567c1931a52"],
Cell[293305, 7706, 474, 12, 28, "Print",ExpressionUUID->"4a4f1bd1-ac6c-4d34-823e-f5a3bd6dacea"],
Cell[293782, 7720, 241, 4, 28, "Print",ExpressionUUID->"da9df5e8-b01b-49f4-89c7-48520f89dab2"],
Cell[294026, 7726, 202, 4, 28, "Print",ExpressionUUID->"d9342429-8d67-4cda-9a65-69bfe861b124"],
Cell[294231, 7732, 357, 6, 52, "Print",ExpressionUUID->"245c063d-2977-447d-9c2c-d2325f40208b"],
Cell[294591, 7740, 202, 4, 28, "Print",ExpressionUUID->"1d1e3a7f-2fe3-4857-9fd3-525f9d139c5a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[294842, 7750, 285, 7, 35, "Input",ExpressionUUID->"c7dc0213-a85d-438d-9425-2b9e8e705088"],
Cell[CellGroupData[{
Cell[295152, 7761, 536, 12, 28, "Print",ExpressionUUID->"9a5ce17f-3158-440a-a507-da9a6a77a741"],
Cell[295691, 7775, 546, 12, 28, "Print",ExpressionUUID->"6d134aa9-7784-4c6c-8657-7bfcb3c7effa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[296286, 7793, 287, 7, 35, "Input",ExpressionUUID->"96088e1c-a166-4560-88bb-a2afb78ed650"],
Cell[296576, 7802, 635, 13, 28, "Print",ExpressionUUID->"2a411396-af24-4272-bdc0-5bb59d2f5184"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297248, 7820, 530, 16, 35, "Input",ExpressionUUID->"2e6dbc83-b7e0-418a-9d37-64e5e2d14dde"],
Cell[297781, 7838, 3238, 91, 44, "Output",ExpressionUUID->"8e56446d-153d-48c8-935f-e53d389b945a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301056, 7934, 187, 4, 35, "Input",ExpressionUUID->"609c8ba4-39a5-46fd-8c20-ff398264d12c"],
Cell[301246, 7940, 193, 3, 40, "Output",ExpressionUUID->"2290906e-292d-4762-967b-1fed998f1bec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301476, 7948, 190, 4, 35, "Input",ExpressionUUID->"4dbd6ef9-b536-470c-832d-852de568924b"],
Cell[301669, 7954, 189, 3, 40, "Output",ExpressionUUID->"083364eb-133b-4590-8b18-7463f9055267"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301895, 7962, 386, 7, 35, "Input",ExpressionUUID->"4788f72c-1008-427a-a7c3-423661efdafa"],
Cell[302284, 7971, 238, 4, 113, "Output",ExpressionUUID->"53895ad9-97dc-40a9-9e98-f8c06af4ddfe"]
}, Open  ]],
Cell[302537, 7978, 462, 14, 84, "Input",ExpressionUUID->"3770b8ba-e8f9-4cb0-b4da-1e8713cbf2de"],
Cell[CellGroupData[{
Cell[303024, 7996, 297, 9, 35, "Input",ExpressionUUID->"04113740-a633-42e4-94fc-f180a550d3a4"],
Cell[303324, 8007, 140, 2, 40, "Output",ExpressionUUID->"9519c08c-e0d4-43dc-8372-63230456fb8d"]
}, Open  ]],
Cell[303479, 8012, 174, 4, 35, "Input",ExpressionUUID->"082f6c60-0f64-4ff5-a5d5-54ed5baf9f2d"],
Cell[CellGroupData[{
Cell[303678, 8020, 297, 9, 35, "Input",ExpressionUUID->"2efbcf0c-18fc-4c45-ab60-20d8c6e80320"],
Cell[303978, 8031, 142, 2, 40, "Output",ExpressionUUID->"50dd8b7c-09c8-4d39-a4e4-564c541fdefb"]
}, Open  ]],
Cell[304135, 8036, 173, 4, 35, "Input",ExpressionUUID->"bd2e272b-9a30-4fdb-b805-9fad1f6b3587"],
Cell[CellGroupData[{
Cell[304333, 8044, 321, 7, 35, "Input",ExpressionUUID->"f08065bc-0b43-43ab-80d3-108971481e1c"],
Cell[CellGroupData[{
Cell[304679, 8055, 522, 12, 28, "Print",ExpressionUUID->"066766a3-969e-4940-a781-bbb05511860d"],
Cell[305204, 8069, 620, 14, 28, "Print",ExpressionUUID->"1a72b60f-1c65-4951-9d26-777ffb88516c"],
Cell[305827, 8085, 722, 17, 28, "Print",ExpressionUUID->"f939ef18-7d06-4199-9cdd-8cac995a0b77"],
Cell[306552, 8104, 772, 19, 28, "Print",ExpressionUUID->"2f30aa3a-9108-420c-99b8-2791ec1f4652"],
Cell[307327, 8125, 792, 19, 28, "Print",ExpressionUUID->"2ac9db65-81c4-464b-b38e-4b1a126965a7"],
Cell[308122, 8146, 708, 17, 28, "Print",ExpressionUUID->"96736346-37c9-47eb-a0db-6bca376ad530"],
Cell[308833, 8165, 718, 16, 28, "Print",ExpressionUUID->"08512c46-c71d-4b3d-b793-94719ae28e51"],
Cell[309554, 8183, 810, 20, 28, "Print",ExpressionUUID->"5352bc35-aff2-4c24-81a5-69f1d1c92c3e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[310413, 8209, 470, 13, 35, "Input",ExpressionUUID->"2d6b85a5-2de1-44d4-8dbb-c43dec7d6679"],
Cell[310886, 8224, 1282, 37, 44, "Output",ExpressionUUID->"36a217d6-0085-4f62-9207-5c45ffae943f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[312205, 8266, 281, 5, 35, "Input",ExpressionUUID->"e36b0683-774c-4ad2-8c5b-bc6af7fb9704"],
Cell[312489, 8273, 153, 2, 40, "Output",ExpressionUUID->"54078719-b799-4677-a6ab-8b43a434f02d"]
}, Open  ]],
Cell[312657, 8278, 544, 13, 35, "Input",ExpressionUUID->"8c26d6c0-faeb-4044-9a22-99c157e19c0d"],
Cell[CellGroupData[{
Cell[313226, 8295, 341, 6, 35, "Input",ExpressionUUID->"1c18372a-47bd-439e-bba4-48f22cc8cafe"],
Cell[313570, 8303, 148, 2, 40, "Output",ExpressionUUID->"9e2b6d6a-11b2-452a-b2ac-be96b6f35118"]
}, Open  ]],
Cell[313733, 8308, 388, 10, 35, "Input",ExpressionUUID->"fdeafb00-3204-40a6-9167-e4cae12e5603"],
Cell[314124, 8320, 351, 8, 35, "Input",ExpressionUUID->"7d7d95db-9a2f-4053-a033-6fd18a572b20"],
Cell[CellGroupData[{
Cell[314500, 8332, 354, 9, 35, "Input",ExpressionUUID->"0b91854a-b241-40a1-8c7d-0f2c99fbd8fd"],
Cell[314857, 8343, 1115, 32, 44, "Output",ExpressionUUID->"3fc3a44f-4e49-43a4-9822-a0b7ac9c7dae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316009, 8380, 204, 4, 35, "Input",ExpressionUUID->"d4351566-4e7b-4315-9aa2-0773741d08cd"],
Cell[316216, 8386, 135, 2, 40, "Output",ExpressionUUID->"4d3b7acf-ce2c-4626-b162-b617a4d627df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316388, 8393, 405, 10, 35, "Input",ExpressionUUID->"0d84594f-765f-4d65-a457-3f0bcec21513"],
Cell[316796, 8405, 1115, 32, 44, "Output",ExpressionUUID->"1fadb33a-6078-485e-b231-3f466b5c5415"]
}, Open  ]],
Cell[CellGroupData[{
Cell[317948, 8442, 204, 4, 35, "Input",ExpressionUUID->"de2d002d-1aca-4480-9915-698938e44599"],
Cell[318155, 8448, 124, 2, 40, "Output",ExpressionUUID->"56e6fc16-8e1c-4c2c-8441-c16a19ecb333"]
}, Open  ]],
Cell[CellGroupData[{
Cell[318316, 8455, 271, 6, 35, "Input",ExpressionUUID->"6724f6b6-547b-45be-9f28-bf3a72dfe44b"],
Cell[318590, 8463, 565, 12, 28, "Print",ExpressionUUID->"d49a3c93-ea0a-44bd-a0f8-a6b4883d0544"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319192, 8480, 304, 10, 35, "Input",ExpressionUUID->"617d821a-b093-45ab-8284-e023079fb3db"],
Cell[319499, 8492, 1133, 32, 68, "Output",ExpressionUUID->"fc7f1fad-6d8d-41f8-ab38-3e0112d1c4d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320669, 8529, 207, 4, 35, "Input",ExpressionUUID->"65aa5c4a-9d51-4aac-a9b7-c166eb381bcf"],
Cell[320879, 8535, 156, 2, 40, "Output",ExpressionUUID->"a7c21220-a69e-4df5-b393-b821822d7289"]
}, Open  ]],
Cell[CellGroupData[{
Cell[321072, 8542, 217, 6, 35, "Input",ExpressionUUID->"ced8519e-c6aa-4245-b24e-1553ae26ed91"],
Cell[321292, 8550, 317, 11, 64, "Output",ExpressionUUID->"fb6205e0-0c74-4b62-93ae-7a58fa2bc7fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[321646, 8566, 358, 10, 35, "Input",ExpressionUUID->"97ee2517-3cfa-4dcc-a7f7-89e7418d950f"],
Cell[322007, 8578, 477, 17, 57, "Output",ExpressionUUID->"bf6b7e11-9849-46e1-b43e-437fda08e0ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322521, 8600, 139, 3, 35, "Input",ExpressionUUID->"70cde074-7478-40f1-82cb-252982955b79"],
Cell[322663, 8605, 158, 2, 40, "Output",ExpressionUUID->"45474ad5-bfb4-427f-a176-44f399dbb378"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322858, 8612, 275, 7, 35, "Input",ExpressionUUID->"96d06764-6c54-46d8-a435-5632ea98909e"],
Cell[323136, 8621, 156, 2, 40, "Output",ExpressionUUID->"a9fa8e98-582f-42aa-b0c9-0bbe813e3787"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323329, 8628, 859, 23, 35, "Input",ExpressionUUID->"bacfa753-c77f-4a20-a9f4-1ce880b89132"],
Cell[324191, 8653, 1233, 43, 67, "Output",ExpressionUUID->"0c10711f-8587-40da-b5c2-14e535319935"]
}, Open  ]],
Cell[CellGroupData[{
Cell[325461, 8701, 190, 4, 35, "Input",ExpressionUUID->"5d90c74a-5cc3-451d-be3b-4c3ec35dd83c"],
Cell[325654, 8707, 213, 3, 40, "Output",ExpressionUUID->"0b046e32-ff40-4ef7-9eba-f985cec53c39"]
}, Open  ]],
Cell[CellGroupData[{
Cell[325904, 8715, 370, 9, 35, "Input",ExpressionUUID->"11ab5431-f903-4920-9bda-4f565105fe7c"],
Cell[326277, 8726, 213, 3, 40, "Output",ExpressionUUID->"ad6204bc-169e-4fdb-b1a4-e9548b2c0fcd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326527, 8734, 381, 9, 35, "Input",ExpressionUUID->"7bf38c93-d315-442b-8905-d6893a24cfae"],
Cell[326911, 8745, 214, 3, 40, "Output",ExpressionUUID->"c706a608-1572-4d08-8779-f61144e41446"]
}, Open  ]],
Cell[CellGroupData[{
Cell[327162, 8753, 284, 8, 35, "Input",ExpressionUUID->"3037f38c-99ee-4786-81b4-16f0b519a3ed"],
Cell[327449, 8763, 311, 11, 63, "Output",ExpressionUUID->"7e3d8bed-e0df-4ef0-9add-822551b1c2bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[327797, 8779, 139, 3, 35, "Input",ExpressionUUID->"65a4252c-ec4f-46ce-be7f-4db6838b8407"],
Cell[327939, 8784, 156, 2, 40, "Output",ExpressionUUID->"33a1045c-1c26-4ff4-adc8-850b3e7a07e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328132, 8791, 432, 10, 35, "Input",ExpressionUUID->"94967384-f559-4a0b-91a3-a1b15d50bebd"],
Cell[328567, 8803, 342, 12, 65, "Output",ExpressionUUID->"facc8445-90ff-4ab6-aeb4-edd641f81194"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328946, 8820, 139, 3, 35, "Input",ExpressionUUID->"e7fdb2a4-953c-43cd-92b7-673965dc1231"],
Cell[329088, 8825, 155, 2, 40, "Output",ExpressionUUID->"e5368d08-b6fb-483c-ba7c-b01e4d60479f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[329280, 8832, 275, 7, 35, "Input",ExpressionUUID->"8de0f30e-bf4f-4302-b045-d577cfd94958"],
Cell[329558, 8841, 165, 3, 40, "Output",ExpressionUUID->"5265b32e-981e-4636-9dc6-97dc1c793a3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[329760, 8849, 231, 6, 35, "Input",ExpressionUUID->"ad1f19b8-270c-489b-bf11-b9aa728aa3bd"],
Cell[329994, 8857, 304, 10, 58, "Output",ExpressionUUID->"f82d804a-56a1-49c6-8557-50a7fb05195c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330335, 8872, 139, 3, 35, "Input",ExpressionUUID->"9ada53dd-6e81-4803-ae49-525518d85913"],
Cell[330477, 8877, 143, 2, 40, "Output",ExpressionUUID->"c94847fc-c312-4265-8b13-c35a280d755f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330657, 8884, 338, 9, 35, "Input",ExpressionUUID->"34617b48-81a8-49ee-a907-86394b072f33"],
Cell[330998, 8895, 327, 11, 63, "Output",ExpressionUUID->"6291e5bd-c13e-4ab1-962d-78774b1bffcd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[331362, 8911, 139, 3, 35, "Input",ExpressionUUID->"f7582ecb-44d3-4a21-8363-98c190925f47"],
Cell[331504, 8916, 155, 2, 40, "Output",ExpressionUUID->"1810b987-9eb8-4354-a6f7-53f6fcf7fbf7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[331696, 8923, 254, 6, 35, "Input",ExpressionUUID->"80b37900-1aea-4146-aab3-b4bba4fec08a"],
Cell[331953, 8931, 167, 5, 63, "Output",ExpressionUUID->"b2b25128-b28d-48de-9975-5ba5f8579ca4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332157, 8941, 139, 3, 35, "Input",ExpressionUUID->"2a9b5f60-529c-4d1c-8cee-ef0d72e0bc1a"],
Cell[332299, 8946, 145, 2, 40, "Output",ExpressionUUID->"b7b44a61-4d1e-4b96-b2c2-83c78be7e11c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332481, 8953, 333, 9, 35, "Input",ExpressionUUID->"7b3675ef-a93a-4d07-9618-d5f29c190b8d"],
Cell[332817, 8964, 354, 12, 57, "Output",ExpressionUUID->"835ad646-6c61-4c4f-8c9d-0aaae83c660e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[333208, 8981, 205, 4, 35, "Input",ExpressionUUID->"96637fc0-5078-4619-b647-c973b2b5b817"],
Cell[333416, 8987, 162, 2, 40, "Output",ExpressionUUID->"bcb27f05-f3d5-4354-9a7c-9385a8492b15"]
}, Open  ]],
Cell[CellGroupData[{
Cell[333615, 8994, 275, 7, 35, "Input",ExpressionUUID->"93f0e119-a363-4b7f-abc2-cef7b7da4258"],
Cell[333893, 9003, 158, 2, 40, "Output",ExpressionUUID->"2039ad15-f221-447b-bbf6-1493efbd239c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[334088, 9010, 487, 15, 35, "Input",ExpressionUUID->"e4779d76-3fea-4352-aa11-c9657fed34a5"],
Cell[334578, 9027, 1368, 41, 69, "Output",ExpressionUUID->"f6c0a721-6201-4135-a022-6093ddc95512"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335983, 9073, 209, 4, 35, "Input",ExpressionUUID->"db18d7c8-0751-48a8-85e1-83a670e53379"],
Cell[336195, 9079, 173, 3, 40, "Output",ExpressionUUID->"655034f2-c405-4655-912d-97a4cdc892b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336405, 9087, 275, 7, 35, "Input",ExpressionUUID->"ffd81ff1-6fb8-4dff-a6aa-d9db4cc34235"],
Cell[336683, 9096, 180, 3, 40, "Output",ExpressionUUID->"e70571eb-281e-406a-a568-3d48812f2388"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336900, 9104, 879, 25, 35, "Input",ExpressionUUID->"58add8ee-189d-4b5b-aea3-615d6ad42101"],
Cell[337782, 9131, 945, 35, 63, "Output",ExpressionUUID->"abaabd99-53b3-4756-ac13-3535d3137f34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[338764, 9171, 204, 4, 35, "Input",ExpressionUUID->"a585b4da-2bc0-48bc-bffa-9de197589f85"],
Cell[338971, 9177, 258, 4, 65, "Output",ExpressionUUID->"716eb34a-f877-473e-ab61-a09a1ae99f9b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339266, 9186, 373, 7, 35, "Input",ExpressionUUID->"6f45fcdc-d1ff-404b-a2b4-e73184990b2c"],
Cell[339642, 9195, 344, 5, 113, "Output",ExpressionUUID->"8ecf93a4-2b7e-45c8-8f22-5ec569f4e28d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340023, 9205, 358, 7, 35, "Input",ExpressionUUID->"45da9f5b-a2f2-4ae4-8105-6fda9c8ee828"],
Cell[340384, 9214, 372, 5, 137, "Output",ExpressionUUID->"f93a61ba-d3a7-4a7d-9948-0c93b3ff6745"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340793, 9224, 473, 14, 35, "Input",ExpressionUUID->"48a65cea-c1be-45ea-9383-fba51f500ea0"],
Cell[341269, 9240, 2755, 73, 44, "Output",ExpressionUUID->"21c8d49a-4b00-4640-b173-188d1df8d6c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344061, 9318, 207, 4, 35, "Input",ExpressionUUID->"933f705b-0917-43be-8aa0-6a2f0c3b63f4"],
Cell[344271, 9324, 149, 2, 40, "Output",ExpressionUUID->"31e1f088-8f5e-42cd-a81d-0beda421be96"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344457, 9331, 472, 13, 35, "Input",ExpressionUUID->"e1829cf4-b836-48ef-b063-28957e141cce"],
Cell[344932, 9346, 2686, 74, 44, "Output",ExpressionUUID->"0e849713-5721-426e-8c78-2c9cf0a91182"]
}, Open  ]],
Cell[CellGroupData[{
Cell[347655, 9425, 207, 4, 35, "Input",ExpressionUUID->"1fad9ad4-a3ae-4362-9eae-d4ca8afa3c6e"],
Cell[347865, 9431, 147, 2, 40, "Output",ExpressionUUID->"03887ca3-be65-421f-8c80-881de88f47d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[348049, 9438, 287, 6, 35, "Input",ExpressionUUID->"5666f535-c1f4-4a97-af98-acd8ef34a1d2"],
Cell[348339, 9446, 562, 12, 28, "Print",ExpressionUUID->"e7644290-7a56-461a-810c-b8c6c52b9706"]
}, Open  ]],
Cell[348916, 9461, 187, 3, 43, "Text",ExpressionUUID->"5e7efc3e-fd0e-4c29-8555-5a316a9c04da"],
Cell[CellGroupData[{
Cell[349128, 9468, 817, 20, 35, "Input",ExpressionUUID->"8324d686-471d-4df7-90be-55c5772158a6"],
Cell[349948, 9490, 1956, 77, 40, "Output",ExpressionUUID->"f7940af7-8347-4a2f-b813-aa1aae943eb4"]
}, Open  ]],
Cell[351919, 9570, 165, 3, 43, "Text",ExpressionUUID->"f8536740-6359-450c-9e08-7f44bc0db7a2"],
Cell[CellGroupData[{
Cell[352109, 9577, 205, 4, 35, "Input",ExpressionUUID->"5a2a83bd-2a9a-4485-a143-6c010d3c4903"],
Cell[352317, 9583, 210, 3, 40, "Output",ExpressionUUID->"cee51bb3-5177-4733-849d-47c3fe8b4ac7"]
}, Open  ]],
Cell[352542, 9589, 186, 3, 43, "Text",ExpressionUUID->"5497f1f6-3bf4-43b4-8ab9-279d7af834a7"],
Cell[CellGroupData[{
Cell[352753, 9596, 188, 4, 35, "Input",ExpressionUUID->"a77dc2fa-8db7-4083-8d9b-56a3838ff1a1"],
Cell[352944, 9602, 309, 5, 65, "Output",ExpressionUUID->"950fe10b-4ee8-4004-81ce-148d28f9e2f6"]
}, Open  ]],
Cell[353268, 9610, 174, 2, 43, "Text",ExpressionUUID->"58a4190f-c674-4cf8-9bb3-1d5b8c1765aa"],
Cell[CellGroupData[{
Cell[353467, 9616, 147, 3, 35, "Input",ExpressionUUID->"8e9f5254-b6a9-4d0d-b486-814cdcb2c75d"],
Cell[353617, 9621, 256, 4, 40, "Output",ExpressionUUID->"dd959040-327c-4243-a300-fed073a5b22b"]
}, Open  ]],
Cell[353888, 9628, 326, 7, 43, "Text",ExpressionUUID->"fe71540a-feb3-445f-8f2b-8004518ff38d"],
Cell[354217, 9637, 923, 25, 108, "Input",ExpressionUUID->"614f73da-cc38-4f61-ba73-541508e33524"],
Cell[CellGroupData[{
Cell[355165, 9666, 147, 3, 35, "Input",ExpressionUUID->"5be57966-a086-46d1-8206-44b5d1003e96"],
Cell[355315, 9671, 270, 4, 40, "Output",ExpressionUUID->"79d768fc-d670-4959-8c39-84b72d9f0cac"]
}, Open  ]],
Cell[355600, 9678, 258, 4, 43, "Text",ExpressionUUID->"fd8422bf-8c1f-41a1-b641-380a16e2406b"],
Cell[355861, 9684, 721, 22, 108, "Input",ExpressionUUID->"8d28192e-8a61-48c0-aa04-b2c1fb455db4"],
Cell[CellGroupData[{
Cell[356607, 9710, 217, 4, 35, "Input",ExpressionUUID->"92971777-e85b-4977-8097-6fbf3fa26d42"],
Cell[CellGroupData[{
Cell[356849, 9718, 574, 13, 28, "Print",ExpressionUUID->"b22a1b99-7b78-4589-af13-c47506b15445"],
Cell[357426, 9733, 519, 12, 28, "Print",ExpressionUUID->"35ed242f-e8ac-4061-bf7b-b7da0033cc9a"],
Cell[357948, 9747, 527, 12, 28, "Print",ExpressionUUID->"d4261e8a-5213-4544-91ac-e9169618cbbb"],
Cell[358478, 9761, 527, 12, 28, "Print",ExpressionUUID->"4bcadea1-871a-47a2-a5c3-9c41c60b528b"],
Cell[359008, 9775, 519, 12, 28, "Print",ExpressionUUID->"684ee292-90e1-439c-b955-97abc5d21a21"],
Cell[359530, 9789, 539, 12, 28, "Print",ExpressionUUID->"df150ac4-edde-47c8-9dab-22ddeed974eb"],
Cell[360072, 9803, 543, 12, 28, "Print",ExpressionUUID->"33668fa9-dff5-4123-b15a-f7184a35bf90"],
Cell[360618, 9817, 483, 11, 28, "Print",ExpressionUUID->"1b80cb58-b638-42d6-bc4d-0a3f8be593d4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[361150, 9834, 150, 3, 35, "Input",ExpressionUUID->"e8a948e3-dd67-44b0-b2f7-d7f9f6137486"],
Cell[CellGroupData[{
Cell[361325, 9841, 491, 12, 28, "Print",ExpressionUUID->"be77eb57-2061-4046-8772-7104c3cc0185"],
Cell[361819, 9855, 507, 12, 28, "Print",ExpressionUUID->"435c4bba-94c3-47b3-969c-a65c339f5373"]
}, Open  ]],
Cell[362341, 9870, 162, 4, 40, "Output",ExpressionUUID->"b384d42c-3a61-422b-9364-b974ad2d3a45"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362540, 9879, 217, 4, 35, "Input",ExpressionUUID->"5923ae44-e29f-4388-8888-8e1646cb68ef"],
Cell[CellGroupData[{
Cell[362782, 9887, 202, 4, 28, "Print",ExpressionUUID->"2682b1c9-f773-4088-ab9e-404e73c3fb18"],
Cell[362987, 9893, 494, 12, 28, "Print",ExpressionUUID->"28bce61f-0363-4a24-bf35-5c1a2d8e2ecf"],
Cell[363484, 9907, 229, 4, 28, "Print",ExpressionUUID->"dda4438c-1be9-4f6c-a201-45f0f7e655dd"],
Cell[363716, 9913, 202, 4, 28, "Print",ExpressionUUID->"ed081665-7ff5-4692-a026-7f72e8c62fdb"],
Cell[363921, 9919, 357, 6, 52, "Print",ExpressionUUID->"83f4d74f-f836-4191-93a4-b1e8e20dcc11"],
Cell[364281, 9927, 202, 4, 28, "Print",ExpressionUUID->"c0b63ccb-aff7-4992-a890-b51888c395bd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[364532, 9937, 503, 13, 35, "Input",ExpressionUUID->"b6ee0839-2597-462a-930b-16cd3fb3e58b"],
Cell[365038, 9952, 753, 18, 28, "Print",ExpressionUUID->"6f0163df-ba85-4b2a-881f-7eaf3e45cfc7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[365828, 9975, 571, 13, 35, "Input",ExpressionUUID->"e8580a22-4b4d-46ca-a0c1-7f1491e02261"],
Cell[366402, 9990, 686, 16, 28, "Print",ExpressionUUID->"5c2f2d1f-9b7a-4b03-ba4f-b89a412f70bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[367125, 10011, 840, 26, 60, "Input",ExpressionUUID->"98c16c9c-0d34-4925-8867-6d739390065f"],
Cell[367968, 10039, 1547, 41, 49, "Output",ExpressionUUID->"566fec15-7269-4747-83a8-825378cf80ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[369552, 10085, 139, 3, 35, "Input",ExpressionUUID->"833a35bd-159a-4f2b-b298-fe257bf0abfc"],
Cell[369694, 10090, 154, 2, 40, "Output",ExpressionUUID->"a15f7f18-910c-47f9-b109-ef33e4b96945"]
}, Open  ]],
Cell[CellGroupData[{
Cell[369885, 10097, 594, 18, 35, "Input",ExpressionUUID->"56070e95-de71-4aac-8ad0-a5fa0e469b7d"],
Cell[370482, 10117, 26489, 747, 141, "Output",ExpressionUUID->"a1e65272-57fe-4cf4-ac4d-466375cb299f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397008, 10869, 797, 22, 35, "Input",ExpressionUUID->"7c455e37-60c4-46ae-b69b-98640dbf1e4e"],
Cell[397808, 10893, 38777, 1083, 141, "Output",ExpressionUUID->"6b6cbbbc-8e22-4de1-9501-8d591ae1eee5"]
}, Open  ]],
Cell[436600, 11979, 246, 5, 35, "Input",ExpressionUUID->"67cd4b78-fd4f-479b-addd-4edae3611155"],
Cell[CellGroupData[{
Cell[436871, 11988, 239, 5, 35, "Input",ExpressionUUID->"18bf4a10-de5a-4424-bc1c-3624d08751fb"],
Cell[437113, 11995, 1095, 15, 233, "Output",ExpressionUUID->"018cbe14-68bf-49e1-8f83-268765e5825d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[438245, 12015, 361, 8, 35, "Input",ExpressionUUID->"3b4c853b-86db-4e37-85f1-60f6f8b12a42"],
Cell[438609, 12025, 1297, 18, 377, "Output",ExpressionUUID->"2e11eb6f-0c69-4d41-a14f-b417fe5830ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439943, 12048, 538, 15, 35, "Input",ExpressionUUID->"f192b880-0574-43c1-8bef-180897e9cde4"],
Cell[440484, 12065, 41916, 1141, 169, "Output",ExpressionUUID->"275057ad-6fca-44a5-9bca-b4b72f1cd388"]
}, Open  ]],
Cell[CellGroupData[{
Cell[482437, 13211, 567, 12, 35, "Input",ExpressionUUID->"ec4bc28f-c577-4940-9b26-c351272a9613"],
Cell[483007, 13225, 1127, 31, 44, "Output",ExpressionUUID->"546eb3ab-f9a6-4257-9da2-6b1a3c4216cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[484171, 13261, 796, 25, 35, "Input",ExpressionUUID->"f62b2cf9-6b5c-4f09-8fb7-ffeb5afed077"],
Cell[484970, 13288, 3264, 91, 44, "Output",ExpressionUUID->"079d7f00-084c-4a7b-9bfd-5406f03ea17c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[488271, 13384, 648, 13, 35, "Input",ExpressionUUID->"642607af-3fbd-4ae4-8a71-5411b09aa2af"],
Cell[488922, 13399, 1487, 21, 713, "Output",ExpressionUUID->"d7dc49ad-1065-4a0f-8ca8-aaabee0dc055"]
}, Open  ]],
Cell[490424, 13423, 595, 11, 99, "Text",ExpressionUUID->"c46eb656-4bcb-4dcc-8f68-b10882cd05ff"],
Cell[491022, 13436, 266, 6, 35, "Input",ExpressionUUID->"fe764cd0-1244-4ef7-a787-a40f165d80af"],
Cell[CellGroupData[{
Cell[491313, 13446, 217, 4, 35, "Input",ExpressionUUID->"a1336673-3b81-4592-b353-6c23f540347e"],
Cell[CellGroupData[{
Cell[491555, 13454, 155, 3, 28, "Print",ExpressionUUID->"9b875001-be1d-4f3a-ad57-bed2e4eec720"],
Cell[491713, 13459, 347, 8, 28, "Print",ExpressionUUID->"81dd275b-94de-4ad5-8f13-430e7afb64de"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[492109, 13473, 150, 3, 35, "Input",ExpressionUUID->"1dcdbf46-b62e-4943-9012-18778ad9a8dd"],
Cell[CellGroupData[{
Cell[492284, 13480, 493, 12, 28, "Print",ExpressionUUID->"edd16c64-7441-4125-b1dd-aa8f0b23349c"],
Cell[492780, 13494, 521, 12, 28, "Print",ExpressionUUID->"12014c95-3074-4d29-9c9a-67b3c9114b0f"]
}, Open  ]],
Cell[493316, 13509, 162, 4, 40, "Output",ExpressionUUID->"474814f4-6a04-4aa6-82a0-10510c56f18e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493515, 13518, 150, 3, 35, "Input",ExpressionUUID->"36c4714e-d3a2-44b8-95c5-20a4e81b66cf"],
Cell[CellGroupData[{
Cell[493690, 13525, 667, 18, 28, "Print",ExpressionUUID->"9b1f8d2e-cb14-4594-8426-e56a1a675868"],
Cell[494360, 13545, 501, 12, 28, "Print",ExpressionUUID->"b4524b1c-38b6-47dc-ba03-3efb9c55855f"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

